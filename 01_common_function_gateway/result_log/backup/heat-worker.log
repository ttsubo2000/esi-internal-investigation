2018-04-09 04:40:43,228 [1;37mINFO[0m heat_worker - Registered gohan 2-step delete flag: marked_for_deletion (resources.py - 62)
2018-04-09 04:40:43,229 [1;37mINFO[0m heat_worker - Gohan config path: /config (resources.py - 274)
2018-04-09 04:40:43,230 [1;37mINFO[0m heat_worker - Gohan state path: /state (resources.py - 298)
2018-04-09 04:40:43,318 [1;33mWARNING[0m heat_worker - Could not reach gohan. Retrying in 1s. (gohan.py - 28)
2018-04-09 04:40:44,323 [1;33mWARNING[0m heat_worker - Could not reach gohan. Retrying in 2s. (gohan.py - 28)
2018-04-09 04:40:46,328 [1;33mWARNING[0m heat_worker - Could not reach gohan. Retrying in 4s. (gohan.py - 28)
2018-04-09 04:40:50,332 [1;33mWARNING[0m heat_worker - Could not reach gohan. Retrying in 8s. (gohan.py - 28)
2018-04-09 04:40:58,343 [1;33mWARNING[0m heat_worker - Could not reach gohan. Retrying in 16s. (gohan.py - 28)
================================================
2018-04-09 04:41:14,579 [1;34mDEBUG[0m heat_worker - Starting worker. (etcd_worker.py - 231)
2018-04-09 04:41:14,580 [1;37mINFO[0m heat_worker - Worker started. (etcd_worker.py - 234)
2018-04-09 04:41:14,580 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:41:14,581 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:41:20,077 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854:1:1gsws using id: 7c4e2e24-b2f1-4fce-ab38-74bd3fd09a6f (job_queue.py - 245)
2018-04-09 04:41:20,080 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:41:20,081 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:41:20,109 [1;34mDEBUG[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Starting work on new ready job create:heat_worker:ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854:1:1gsws (etcd_worker.py - 108)
2018-04-09 04:41:20,110 [1;34mDEBUG[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Checking job status for ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 (heat_stacks_worker.py - 44)
2018-04-09 04:41:21,175 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:41:21,275 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Template id ese_device_existing resolved from mapping: ACese_device_&Pexisting (resources.py - 835)
2018-04-09 04:41:21,283 [1;34mDEBUG[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  ESE Device (existing) template

parameters:
  name:
    type: string
    label: Physical Router Name
    description: Name of the physical router that will be created.
  hostname:
    type: string
    label: Hostname
    description: Name of host (vrouter) to create router on
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Device
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_router:
    type: OS::Contrail::ExistingResource
    properties:
      fq_name:
        - "default-global-system-config"
        - { get_param: hostname }
      resource_type: "physical_router"

  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: ese_devices
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: switch
      properties:
        device_ip: { get_param: device_ip }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: switch
    depends_on: physical_router

outputs:
  id:
    description: A unique id for the physical router.
    value: { get_resource: physical_router }
  name:
    description: The name of the physical router.
    value: { get_attr: [physical_router, name] }
  fq_name:
    description: The FQ name of the physical router.
    value: { get_attr: [physical_router, fq_name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link] }
 with parameters:
{"device_ip": "10.161.0.34", "name": "QFX-NW02", "tenant_id": "c583ce78843344adbe5fd20f13620274", "hostname": "QFX-NW02", "version": 1, "gohan_id": "cc214b6a-2f09-4094-b7cd-a9590f64b854"}, 
 and heat timeout = 6, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:41:21,284 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Creating a stack ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854 with parameters: {u'device_ip': u'10.161.0.34', u'name': u'QFX-NW02', u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'hostname': u'QFX-NW02', u'version': 1, u'gohan_id': u'cc214b6a-2f09-4094-b7cd-a9590f64b854'}, timeout_mins: 6, and template: 
heat_template_version: 2013-05-23

description: >
  ESE Device (existing) template

parameters:
  name:
    type: string
    label: Physical Router Name
    description: Name of the physical router that will be created.
  hostname:
    type: string
    label: Hostname
    description: Name of host (vrouter) to create router on
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Device
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_router:
    type: OS::Contrail::ExistingResource
    properties:
      fq_name:
        - "default-global-system-config"
        - { get_param: hostname }
      resource_type: "physical_router"

  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: ese_devices
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: switch
      properties:
        device_ip: { get_param: device_ip }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: switch
    depends_on: physical_router

outputs:
  id:
    description: A unique id for the physical router.
    value: { get_resource: physical_router }
  name:
    description: The name of the physical router.
    value: { get_attr: [physical_router, name] }
  fq_name:
    description: The FQ name of the physical router.
    value: { get_attr: [physical_router, fq_name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link] } (heat.py - 162)
2018-04-09 04:41:21,828 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Stack "ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:41:22,970 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Stack "ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:41:24,171 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Stack "ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:41:25,587 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Stack "ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:41:25,588 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - CREATED ese_device_cc214b6a-2f09-4094-b7cd-a9590f64b854 (heat.py - 280)
2018-04-09 04:41:26,126 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Job create finished with results {'heat_outputs': [{u'output_value': u'2762cfcb-575c-45cc-a07b-ca19f5b007cd', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': [u'default-global-system-config', u'NWSDP-JNPR-02'], u'description': u'The FQ name of the physical router.', u'output_key': u'fq_name'}, {u'output_value': u'7e5c78fa-71c0-427e-947f-586b1fc3c470', u'description': u'A unique id for the physical router.', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/2762cfcb-575c-45cc-a07b-ca19f5b007cd', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}, {u'output_value': u'NWSDP-JNPR-02', u'description': u'The name of the physical router.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:41:26,167 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Job create:heat_worker:ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854:1:1gsws finished. (job_queue.py - 266)
2018-04-09 04:41:26,168 [1;37mINFO[0m heat_worker - ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 - Trying to delete internal process state for resource ese_device:cc214b6a-2f09-4094-b7cd-a9590f64b854 (resources.py - 701)
2018-04-09 04:41:50,116 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:41:50,116 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:41:50,117 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:42:20,130 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:42:20,131 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:42:20,131 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:42:28,616 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c:1:711dk using id: 3218485b-577a-47fb-a6c3-579131ab54cd (job_queue.py - 245)
2018-04-09 04:42:28,618 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:42:28,618 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:42:28,634 [1;34mDEBUG[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Starting work on new ready job create:heat_worker:ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c:1:711dk (etcd_worker.py - 108)
2018-04-09 04:42:28,634 [1;34mDEBUG[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Checking job status for ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c (heat_stacks_worker.py - 44)
2018-04-09 04:42:28,941 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:42:29,033 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Template id ese_physical_port_new resolved from mapping: ACese_physical_port_&Pexisting (resources.py - 835)
2018-04-09 04:42:29,038 [1;34mDEBUG[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  physical_device:
    type: string
    label: Physical Device Id
    description: Id of the physical device on which physical port will be created.
  physical_port_name:
    type: string
    label: Physical Interface Name
    description: Name of the physical port.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_interface:
    type: OS::Contrail::PhysicalInterface
    properties:
      name: { get_param: physical_port_name }
      physical_router: { get_param: physical_device }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: ese_physical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: physical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: port
    depends_on: physical_interface

outputs:
  id:
    description: A unique id for the physical interface
    value: { get_resource: physical_interface }
  name:
    description: The name of the physical interface.
    value: { get_attr: [physical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] }
 with parameters:
{"physical_port_name": "xe-0/0/3", "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.161.0.34", "physical_device": "7e5c78fa-71c0-427e-947f-586b1fc3c470", "version": 1, "gohan_id": "9451c9ca-289d-42ba-846d-359c448e910c"}, 
 and heat timeout = 6, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:42:29,039 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Creating a stack ese_physical_port_9451c9ca-289d-42ba-846d-359c448e910c with parameters: {u'physical_port_name': u'xe-0/0/3', u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.161.0.34', u'physical_device': u'7e5c78fa-71c0-427e-947f-586b1fc3c470', u'version': 1, u'gohan_id': u'9451c9ca-289d-42ba-846d-359c448e910c'}, timeout_mins: 6, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  physical_device:
    type: string
    label: Physical Device Id
    description: Id of the physical device on which physical port will be created.
  physical_port_name:
    type: string
    label: Physical Interface Name
    description: Name of the physical port.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_interface:
    type: OS::Contrail::PhysicalInterface
    properties:
      name: { get_param: physical_port_name }
      physical_router: { get_param: physical_device }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: ese_physical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: physical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: port
    depends_on: physical_interface

outputs:
  id:
    description: A unique id for the physical interface
    value: { get_resource: physical_interface }
  name:
    description: The name of the physical interface.
    value: { get_attr: [physical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] } (heat.py - 162)
2018-04-09 04:42:29,530 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Stack "ese_physical_port_9451c9ca-289d-42ba-846d-359c448e910c" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:42:30,757 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Stack "ese_physical_port_9451c9ca-289d-42ba-846d-359c448e910c" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:42:32,053 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Stack "ese_physical_port_9451c9ca-289d-42ba-846d-359c448e910c" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:42:32,054 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - CREATED ese_physical_port_9451c9ca-289d-42ba-846d-359c448e910c (heat.py - 280)
2018-04-09 04:42:32,542 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Job create finished with results {'heat_outputs': [{u'output_value': u'78d717f0-66d9-4f82-afe6-833c5e8f38f5', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'06bfe521-07f0-4931-9f8c-318c3ad8114e', u'description': u'A unique id for the physical interface', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/78d717f0-66d9-4f82-afe6-833c5e8f38f5', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}, {u'output_value': u'xe-0/0/38', u'description': u'The name of the physical interface.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:42:32,592 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Job create:heat_worker:ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c:1:711dk finished. (job_queue.py - 266)
2018-04-09 04:42:32,593 [1;37mINFO[0m heat_worker - ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c - Trying to delete internal process state for resource ese_physical_port:9451c9ca-289d-42ba-846d-359c448e910c (resources.py - 701)
2018-04-09 04:42:58,629 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:42:58,630 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:42:58,630 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:43:28,641 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:43:28,641 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:43:28,642 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:43:34,183 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465:1:pymqx using id: a83a5431-40e7-4b78-85b6-9f3fc30715d3 (job_queue.py - 245)
2018-04-09 04:43:34,186 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:43:34,187 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:43:34,197 [1;34mDEBUG[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Starting work on new ready job create:heat_worker:ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465:1:pymqx (etcd_worker.py - 108)
2018-04-09 04:43:34,197 [1;34mDEBUG[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Checking job status for ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 (heat_stacks_worker.py - 44)
2018-04-09 04:43:34,488 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:43:34,582 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Template id ese_physical_port_new resolved from mapping: ACese_physical_port_&Pexisting (resources.py - 835)
2018-04-09 04:43:34,587 [1;34mDEBUG[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  physical_device:
    type: string
    label: Physical Device Id
    description: Id of the physical device on which physical port will be created.
  physical_port_name:
    type: string
    label: Physical Interface Name
    description: Name of the physical port.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_interface:
    type: OS::Contrail::PhysicalInterface
    properties:
      name: { get_param: physical_port_name }
      physical_router: { get_param: physical_device }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: ese_physical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: physical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: port
    depends_on: physical_interface

outputs:
  id:
    description: A unique id for the physical interface
    value: { get_resource: physical_interface }
  name:
    description: The name of the physical interface.
    value: { get_attr: [physical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] }
 with parameters:
{"physical_port_name": "xe-0/0/4", "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.161.0.34", "physical_device": "7e5c78fa-71c0-427e-947f-586b1fc3c470", "version": 1, "gohan_id": "f4c3a1bf-3b61-48ba-a548-422036849465"}, 
 and heat timeout = 6, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:43:34,587 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Creating a stack ese_physical_port_f4c3a1bf-3b61-48ba-a548-422036849465 with parameters: {u'physical_port_name': u'xe-0/0/4', u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.161.0.34', u'physical_device': u'7e5c78fa-71c0-427e-947f-586b1fc3c470', u'version': 1, u'gohan_id': u'f4c3a1bf-3b61-48ba-a548-422036849465'}, timeout_mins: 6, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  physical_device:
    type: string
    label: Physical Device Id
    description: Id of the physical device on which physical port will be created.
  physical_port_name:
    type: string
    label: Physical Interface Name
    description: Name of the physical port.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  physical_interface:
    type: OS::Contrail::PhysicalInterface
    properties:
      name: { get_param: physical_port_name }
      physical_router: { get_param: physical_device }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: ese_physical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: physical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: port
    depends_on: physical_interface

outputs:
  id:
    description: A unique id for the physical interface
    value: { get_resource: physical_interface }
  name:
    description: The name of the physical interface.
    value: { get_attr: [physical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] } (heat.py - 162)
2018-04-09 04:43:35,040 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Stack "ese_physical_port_f4c3a1bf-3b61-48ba-a548-422036849465" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:43:36,223 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Stack "ese_physical_port_f4c3a1bf-3b61-48ba-a548-422036849465" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:43:37,573 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Stack "ese_physical_port_f4c3a1bf-3b61-48ba-a548-422036849465" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:43:37,573 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - CREATED ese_physical_port_f4c3a1bf-3b61-48ba-a548-422036849465 (heat.py - 280)
2018-04-09 04:43:38,093 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Job create finished with results {'heat_outputs': [{u'output_value': u'9da949d8-3a71-4bc7-a044-04d1b3f62d7a', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'06bfe521-07f0-4931-9f8c-318c3ad8114e', u'description': u'A unique id for the physical interface', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/9da949d8-3a71-4bc7-a044-04d1b3f62d7a', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}, {u'output_value': u'xe-0/0/38', u'description': u'The name of the physical interface.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:43:38,139 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Job create:heat_worker:ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465:1:pymqx finished. (job_queue.py - 266)
2018-04-09 04:43:38,139 [1;37mINFO[0m heat_worker - ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 - Trying to delete internal process state for resource ese_physical_port:f4c3a1bf-3b61-48ba-a548-422036849465 (resources.py - 701)
2018-04-09 04:44:04,202 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:44:04,202 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:44:04,203 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:44:34,217 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:44:34,217 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:44:34,218 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:44:34,416 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03:1:iprr1 using id: 0b05be28-115a-49b4-929e-055a8ab6f1b6 (job_queue.py - 245)
2018-04-09 04:44:34,418 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:44:34,418 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:44:34,433 [1;34mDEBUG[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Starting work on new ready job create:heat_worker:edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03:1:iprr1 (etcd_worker.py - 108)
2018-04-09 04:44:34,434 [1;34mDEBUG[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Checking job status for edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 (heat_stacks_worker.py - 44)
2018-04-09 04:44:34,873 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:44:34,978 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Template id edge_router resolved from mapping: Cedge_router (resources.py - 835)
2018-04-09 04:44:34,982 [1;34mDEBUG[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Edge Router
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: edge_routers
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: router
      properties:
        device_ip: { get_param: device_ip }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: router

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link]}
 with parameters:
{"gohan_id": "f4f54175-93fe-406b-ae66-dbca4df99e03", "device_ip": "10.79.5.185", "version": 1, "tenant_id": "c583ce78843344adbe5fd20f13620274"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:44:34,982 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Creating a stack edge_router_f4f54175-93fe-406b-ae66-dbca4df99e03 with parameters: {u'gohan_id': u'f4f54175-93fe-406b-ae66-dbca4df99e03', u'device_ip': u'10.79.5.185', u'version': 1, u'tenant_id': u'c583ce78843344adbe5fd20f13620274'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Edge Router
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: edge_routers
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: router
      properties:
        device_ip: { get_param: device_ip }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: router

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link]} (heat.py - 162)
2018-04-09 04:44:35,456 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Stack "edge_router_f4f54175-93fe-406b-ae66-dbca4df99e03" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:44:36,658 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Stack "edge_router_f4f54175-93fe-406b-ae66-dbca4df99e03" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:44:36,659 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - CREATED edge_router_f4f54175-93fe-406b-ae66-dbca4df99e03 (heat.py - 280)
2018-04-09 04:44:36,956 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Job create finished with results {'heat_outputs': [{u'output_value': u'b88cbb53-f850-44f2-9960-95ade457e46c', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/b88cbb53-f850-44f2-9960-95ade457e46c', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:44:37,009 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Job create:heat_worker:edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03:1:iprr1 finished. (job_queue.py - 266)
2018-04-09 04:44:37,010 [1;37mINFO[0m heat_worker - edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 - Trying to delete internal process state for resource edge_router:f4f54175-93fe-406b-ae66-dbca4df99e03 (resources.py - 701)
2018-04-09 04:45:04,422 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:45:04,423 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:45:04,424 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:45:34,437 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:45:34,438 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:45:34,438 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:45:38,687 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a:1:yj6cc using id: 8bb8d1c5-6ba6-4b04-8393-8a57b49a917a (job_queue.py - 245)
2018-04-09 04:45:38,688 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:45:38,689 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:45:38,699 [1;34mDEBUG[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Starting work on new ready job create:heat_worker:edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a:1:yj6cc (etcd_worker.py - 108)
2018-04-09 04:45:38,699 [1;34mDEBUG[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Checking job status for edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a (heat_stacks_worker.py - 44)
2018-04-09 04:45:39,050 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:45:39,138 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Template id edge_router resolved from mapping: Cedge_router (resources.py - 835)
2018-04-09 04:45:39,140 [1;34mDEBUG[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Edge Router
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: edge_routers
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: router
      properties:
        device_ip: { get_param: device_ip }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: router

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link]}
 with parameters:
{"gohan_id": "2d056865-47a9-45cf-a890-ed10e3b5912a", "device_ip": "10.79.5.184", "version": 1, "tenant_id": "c583ce78843344adbe5fd20f13620274"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:45:39,140 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Creating a stack edge_router_2d056865-47a9-45cf-a890-ed10e3b5912a with parameters: {u'gohan_id': u'2d056865-47a9-45cf-a890-ed10e3b5912a', u'device_ip': u'10.79.5.184', u'version': 1, u'tenant_id': u'c583ce78843344adbe5fd20f13620274'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Edge Router
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  device_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_device
      resource_type: edge_routers
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: router
      properties:
        device_ip: { get_param: device_ip }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: router

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: device_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [device_monitor, link]} (heat.py - 162)
2018-04-09 04:45:39,597 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Stack "edge_router_2d056865-47a9-45cf-a890-ed10e3b5912a" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:45:40,870 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Stack "edge_router_2d056865-47a9-45cf-a890-ed10e3b5912a" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:45:40,871 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - CREATED edge_router_2d056865-47a9-45cf-a890-ed10e3b5912a (heat.py - 280)
2018-04-09 04:45:41,161 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Job create finished with results {'heat_outputs': [{u'output_value': u'ad464fbb-0810-447e-b10d-31715221cb95', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/ad464fbb-0810-447e-b10d-31715221cb95', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:45:41,215 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Job create:heat_worker:edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a:1:yj6cc finished. (job_queue.py - 266)
2018-04-09 04:45:41,216 [1;37mINFO[0m heat_worker - edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a - Trying to delete internal process state for resource edge_router:2d056865-47a9-45cf-a890-ed10e3b5912a (resources.py - 701)
2018-04-09 04:46:08,700 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:46:08,700 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:46:08,701 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:46:38,713 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:46:38,713 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:46:38,713 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:46:44,913 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0:1:i19ds using id: f16eb69a-8c30-46bb-a6f7-35161f5f3435 (job_queue.py - 245)
2018-04-09 04:46:44,915 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:46:44,915 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:46:44,925 [1;34mDEBUG[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Starting work on new ready job create:heat_worker:er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0:1:i19ds (etcd_worker.py - 108)
2018-04-09 04:46:44,926 [1;34mDEBUG[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Checking job status for er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 (heat_stacks_worker.py - 44)
2018-04-09 04:46:45,220 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:46:45,307 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Template id er_physical_interface resolved from mapping: Cer_physical_interface (resources.py - 835)
2018-04-09 04:46:45,311 [1;34mDEBUG[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  if_name:
    type: string
    label: Interface Name
    description: Name of the ER Physical Interface
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ER Physical Interface
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: er_physical_interfaces
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: interface
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: if_name }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: interface

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link]}
 with parameters:
{"tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.79.5.185", "if_name": "ae0", "version": 1, "gohan_id": "c2576120-00b0-461e-a2ae-f7bbff9465d0"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:46:45,311 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Creating a stack er_physical_interface_c2576120-00b0-461e-a2ae-f7bbff9465d0 with parameters: {u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.79.5.185', u'if_name': u'ae0', u'version': 1, u'gohan_id': u'c2576120-00b0-461e-a2ae-f7bbff9465d0'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  if_name:
    type: string
    label: Interface Name
    description: Name of the ER Physical Interface
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ER Physical Interface
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: er_physical_interfaces
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: interface
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: if_name }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: interface

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link]} (heat.py - 162)
2018-04-09 04:46:45,777 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Stack "er_physical_interface_c2576120-00b0-461e-a2ae-f7bbff9465d0" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:46:46,933 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Stack "er_physical_interface_c2576120-00b0-461e-a2ae-f7bbff9465d0" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:46:46,933 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - CREATED er_physical_interface_c2576120-00b0-461e-a2ae-f7bbff9465d0 (heat.py - 280)
2018-04-09 04:46:47,249 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Job create finished with results {'heat_outputs': [{u'output_value': u'23d9d390-e1e3-41c7-b926-479d6909aeeb', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/23d9d390-e1e3-41c7-b926-479d6909aeeb', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:46:47,298 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Job create:heat_worker:er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0:1:i19ds finished. (job_queue.py - 266)
2018-04-09 04:46:47,299 [1;37mINFO[0m heat_worker - er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 - Trying to delete internal process state for resource er_physical_interface:c2576120-00b0-461e-a2ae-f7bbff9465d0 (resources.py - 701)
2018-04-09 04:47:14,921 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:47:14,921 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:47:14,922 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:47:44,933 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:47:44,933 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:47:44,934 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:47:49,278 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10:1:qsftf using id: 90458cf6-a9a4-4566-b42b-247890c8f9b4 (job_queue.py - 245)
2018-04-09 04:47:49,281 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:47:49,281 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:47:49,289 [1;34mDEBUG[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Starting work on new ready job create:heat_worker:er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10:1:qsftf (etcd_worker.py - 108)
2018-04-09 04:47:49,289 [1;34mDEBUG[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Checking job status for er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 (heat_stacks_worker.py - 44)
2018-04-09 04:47:49,599 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:47:49,688 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Template id er_physical_interface resolved from mapping: Cer_physical_interface (resources.py - 835)
2018-04-09 04:47:49,690 [1;34mDEBUG[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  if_name:
    type: string
    label: Interface Name
    description: Name of the ER Physical Interface
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ER Physical Interface
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: er_physical_interfaces
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: interface
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: if_name }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: interface

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link]}
 with parameters:
{"tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.79.5.184", "if_name": "ae0", "version": 1, "gohan_id": "b9c7c1f4-1b90-4a7a-8161-34276bb2ed10"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:47:49,691 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Creating a stack er_physical_interface_b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 with parameters: {u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.79.5.184', u'if_name': u'ae0', u'version': 1, u'gohan_id': u'b9c7c1f4-1b90-4a7a-8161-34276bb2ed10'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Physical port template

parameters:
  if_name:
    type: string
    label: Interface Name
    description: Name of the ER Physical Interface
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ER Physical Interface
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports_status
      resource_type: er_physical_interfaces
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: interface
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: if_name }
        community_name: EDGE_ROUTER_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: interface

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link]} (heat.py - 162)
2018-04-09 04:47:50,146 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Stack "er_physical_interface_b9c7c1f4-1b90-4a7a-8161-34276bb2ed10" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:47:51,296 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Stack "er_physical_interface_b9c7c1f4-1b90-4a7a-8161-34276bb2ed10" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:47:51,297 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - CREATED er_physical_interface_b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 (heat.py - 280)
2018-04-09 04:47:51,635 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Job create finished with results {'heat_outputs': [{u'output_value': u'17d442df-0ac4-4c5e-bbef-34fc7e4c4b06', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/17d442df-0ac4-4c5e-bbef-34fc7e4c4b06', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:47:51,690 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Job create:heat_worker:er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10:1:qsftf finished. (job_queue.py - 266)
2018-04-09 04:47:51,691 [1;37mINFO[0m heat_worker - er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 - Trying to delete internal process state for resource er_physical_interface:b9c7c1f4-1b90-4a7a-8161-34276bb2ed10 (resources.py - 701)
2018-04-09 04:48:19,287 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:48:19,288 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:48:19,288 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:48:49,301 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:48:49,301 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:48:49,301 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:19,313 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:49:19,314 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:19,314 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:49,326 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:49:49,326 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:49,327 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:51,855 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:network:fc8814a7-eb1e-4f59-8422-7de500e72782:1:oodvi using id: 479e6717-3083-41b6-bff9-cff121166b16 (job_queue.py - 245)
2018-04-09 04:49:51,857 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:51,857 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:51,872 [1;34mDEBUG[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Starting work on new ready job create:heat_worker:network:fc8814a7-eb1e-4f59-8422-7de500e72782:1:oodvi (etcd_worker.py - 108)
2018-04-09 04:49:51,876 [1;34mDEBUG[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Checking job status for network:fc8814a7-eb1e-4f59-8422-7de500e72782 (heat_stacks_worker.py - 44)
2018-04-09 04:49:52,255 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:49:52,357 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Template id network resolved from mapping: Cnetwork (resources.py - 835)
2018-04-09 04:49:52,361 [1;34mDEBUG[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Network template

parameters:
  uuid:
    type: string
    label: Virtual Network UUID
    description: UUID of the virtual network that will be created.
    default: ""
  name:
    type: string
    label: Virtual Network Name
    description: Name of the virtual network that will be created.
  forwarding_mode:
    type: string
    label: Forwarding Mode
    description: Forwarding Mode.
    default: 'l2_l3'
  route_targets:
    type: comma_delimited_list
    label: Route Targets list
    default: []
  shared:
    type: boolean
    label: Shared Network
    default: false
  external:
    type: boolean
    label: External Network
    default: true
  allow_transit:
    type: boolean
    label: Allow Transit
    default: false
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true

resources:
  network:
    type: OS::Contrail::VirtualNetwork
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      forwarding_mode: { get_param: forwarding_mode }
      route_targets: { get_param: route_targets }
      shared: { get_param: shared }
      admin_state_up: { get_param: admin_state_up }

outputs:
  id:
    description: A unique id for the virtual network.
    value: { get_resource: network }
  name:
    description: The name of the virtual network.
    value: { get_attr: [network, name] }
  fq_name:
    description: The FQ name of the virtual network.
    value: { get_attr: [network, fq_name] }
  route_targets:
    description: The name of the virtual network.
    value: { get_attr: [network, route_targets] }
 with parameters:
{"admin_state_up": true, "uuid": "fc8814a7-eb1e-4f59-8422-7de500e72782", "name": "fc8814a7-eb1e-4f59-8422-7de500e72782"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:49:52,361 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Creating a stack network_fc8814a7-eb1e-4f59-8422-7de500e72782 with parameters: {u'admin_state_up': True, u'uuid': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'name': u'fc8814a7-eb1e-4f59-8422-7de500e72782'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Network template

parameters:
  uuid:
    type: string
    label: Virtual Network UUID
    description: UUID of the virtual network that will be created.
    default: ""
  name:
    type: string
    label: Virtual Network Name
    description: Name of the virtual network that will be created.
  forwarding_mode:
    type: string
    label: Forwarding Mode
    description: Forwarding Mode.
    default: 'l2_l3'
  route_targets:
    type: comma_delimited_list
    label: Route Targets list
    default: []
  shared:
    type: boolean
    label: Shared Network
    default: false
  external:
    type: boolean
    label: External Network
    default: true
  allow_transit:
    type: boolean
    label: Allow Transit
    default: false
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true

resources:
  network:
    type: OS::Contrail::VirtualNetwork
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      forwarding_mode: { get_param: forwarding_mode }
      route_targets: { get_param: route_targets }
      shared: { get_param: shared }
      admin_state_up: { get_param: admin_state_up }

outputs:
  id:
    description: A unique id for the virtual network.
    value: { get_resource: network }
  name:
    description: The name of the virtual network.
    value: { get_attr: [network, name] }
  fq_name:
    description: The FQ name of the virtual network.
    value: { get_attr: [network, fq_name] }
  route_targets:
    description: The name of the virtual network.
    value: { get_attr: [network, route_targets] } (heat.py - 162)
2018-04-09 04:49:52,821 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Stack "network_fc8814a7-eb1e-4f59-8422-7de500e72782" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:49:54,179 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Stack "network_fc8814a7-eb1e-4f59-8422-7de500e72782" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:49:54,180 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - CREATED network_fc8814a7-eb1e-4f59-8422-7de500e72782 (heat.py - 280)
2018-04-09 04:49:54,602 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Job create finished with results {'heat_outputs': [{u'output_value': [], u'description': u'The name of the virtual network.', u'output_key': u'route_targets'}, {u'output_value': u'default-domain:usertenant:fc8814a7-eb1e-4f59-8422-7de500e72782', u'description': u'The FQ name of the virtual network.', u'output_key': u'fq_name'}, {u'output_value': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'description': u'A unique id for the virtual network.', u'output_key': u'id'}, {u'output_value': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'description': u'The name of the virtual network.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:49:54,654 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Job create:heat_worker:network:fc8814a7-eb1e-4f59-8422-7de500e72782:1:oodvi finished. (job_queue.py - 266)
2018-04-09 04:49:54,654 [1;37mINFO[0m heat_worker - network:fc8814a7-eb1e-4f59-8422-7de500e72782 - Trying to delete internal process state for resource network:fc8814a7-eb1e-4f59-8422-7de500e72782 (resources.py - 701)
2018-04-09 04:49:54,696 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d:1:7kdu4 using id: d5476dbe-d6b6-4331-81e2-22b301fbd1c8 (job_queue.py - 245)
2018-04-09 04:49:54,697 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:54,698 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:54,708 [1;34mDEBUG[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Starting work on new ready job create:heat_worker:subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d:1:7kdu4 (etcd_worker.py - 108)
2018-04-09 04:49:54,709 [1;34mDEBUG[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Checking job status for subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d (heat_stacks_worker.py - 44)
2018-04-09 04:49:55,007 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:49:55,114 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Template id subnet resolved from mapping: Csubnet (resources.py - 835)
2018-04-09 04:49:55,119 [1;34mDEBUG[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Subnet template

parameters:
  name:
    type: string
    label: Local Subnet Name
    description: Name of the local subnet that will be created.
  network_id:
    type: string
    label: Network ID
    description: ID of the network for which subnet will be created.
  cidr:
    type: string
    label: Local Subnet IP prefix
    description: IP prefix of the local subnet that will be created.
  gateway_ip:
    default: "0.0.0.0"
    type: string
    label: Default Gateway
    description: Default gateway for the local subnet that will be created.
  ipam:
    type: string
    label: IP Address Management
    description: IPAM for the local subnet that will be created.
    default: ''
  enable_dhcp:
    type: boolean
    label: Enable DHCP
    description: Enable DHCP
    default: true
  dhcp_server_address:
    type: string
    label: DHCP Server address
    description: DHCP Server address
    default: "0.0.0.0"
  allocation_pools:
    type: string
    label: Allocation Pools
    description: Allocation Pools
    default: []
  dns_nameservers:
    type: comma_delimited_list
    label: DNS Nameservers List
    description: DNS Nameservers List
    default: []
  ntp_servers:
    type: comma_delimited_list
    label: NTP Nameservers List
    description: NTP Nameservers List
    default: []
  host_routes:
    type: json
    label: Host Routes
    description: Host Routes
    default: []

resources:
  subnet:
    type: OS::Contrail::VnSubnet
    properties:
      name: { get_param: name }
      network_id: { get_param: network_id }
      ip_prefix: { get_param: cidr }
      default_gateway: { get_param: gateway_ip }
      ipam: { get_param: ipam }
      enable_dhcp: { get_param: enable_dhcp }
      dns_server_address: { get_param: dhcp_server_address }
      dns_nameservers: { get_param: dns_nameservers }
      ntp_servers: { get_param: ntp_servers }
      host_routes: { get_param: host_routes }
      allocation_pools: { get_param: allocation_pools }
      gateway_is_vrouter: false

outputs:
  id:
    description: A unique id for the local subnet.
    value: { get_resource: subnet }
  name:
    description: The name of the local subnet.
    value: { get_attr: [subnet, name] }
  network_id:
    description: A unique id for the network.
    value: { get_attr: [subnet, network_id] }
  ip_prefix:
    description: IP prefix of local subnet.
    value: { get_attr: [subnet, ip_prefix] }
  default_gateway:
    description: Default gateway of local subnet.
    value: { get_attr: [subnet, default_gateway] }
  ipam:
    description: IPAM this local subnet uses.
    value: { get_attr: [subnet, ipam] }
 with parameters:
{"name": "cf9356ae-b4e1-4a91-8193-089fdc12173d", "enable_dhcp": true, "network_id": "fc8814a7-eb1e-4f59-8422-7de500e72782", "ipam": "default-domain:default-project:default-network-ipam", "dns_nameservers": [], "allocation_pools": [{"start": "169.254.0.2", "end": "169.254.127.254"}], "dhcp_server_address": "169.254.0.2", "ntp_servers": [], "gateway_ip": null, "host_routes": [], "cidr": "169.254.0.0/17"}, 
 and heat timeout = 3, rollback = False, 
using this jinja parameters: 
{} (heat.py - 145)
2018-04-09 04:49:55,120 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Creating a stack subnet_cf9356ae-b4e1-4a91-8193-089fdc12173d with parameters: {u'name': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'enable_dhcp': True, u'network_id': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'ipam': u'default-domain:default-project:default-network-ipam', u'dns_nameservers': [], u'allocation_pools': [{u'start': u'169.254.0.2', u'end': u'169.254.127.254'}], u'dhcp_server_address': u'169.254.0.2', u'ntp_servers': [], u'gateway_ip': None, u'host_routes': [], u'cidr': u'169.254.0.0/17'}, timeout_mins: 3, and template: 
heat_template_version: 2013-05-23

description: >
  Subnet template

parameters:
  name:
    type: string
    label: Local Subnet Name
    description: Name of the local subnet that will be created.
  network_id:
    type: string
    label: Network ID
    description: ID of the network for which subnet will be created.
  cidr:
    type: string
    label: Local Subnet IP prefix
    description: IP prefix of the local subnet that will be created.
  gateway_ip:
    default: "0.0.0.0"
    type: string
    label: Default Gateway
    description: Default gateway for the local subnet that will be created.
  ipam:
    type: string
    label: IP Address Management
    description: IPAM for the local subnet that will be created.
    default: ''
  enable_dhcp:
    type: boolean
    label: Enable DHCP
    description: Enable DHCP
    default: true
  dhcp_server_address:
    type: string
    label: DHCP Server address
    description: DHCP Server address
    default: "0.0.0.0"
  allocation_pools:
    type: string
    label: Allocation Pools
    description: Allocation Pools
    default: []
  dns_nameservers:
    type: comma_delimited_list
    label: DNS Nameservers List
    description: DNS Nameservers List
    default: []
  ntp_servers:
    type: comma_delimited_list
    label: NTP Nameservers List
    description: NTP Nameservers List
    default: []
  host_routes:
    type: json
    label: Host Routes
    description: Host Routes
    default: []

resources:
  subnet:
    type: OS::Contrail::VnSubnet
    properties:
      name: { get_param: name }
      network_id: { get_param: network_id }
      ip_prefix: { get_param: cidr }
      default_gateway: { get_param: gateway_ip }
      ipam: { get_param: ipam }
      enable_dhcp: { get_param: enable_dhcp }
      dns_server_address: { get_param: dhcp_server_address }
      dns_nameservers: { get_param: dns_nameservers }
      ntp_servers: { get_param: ntp_servers }
      host_routes: { get_param: host_routes }
      allocation_pools: { get_param: allocation_pools }
      gateway_is_vrouter: false

outputs:
  id:
    description: A unique id for the local subnet.
    value: { get_resource: subnet }
  name:
    description: The name of the local subnet.
    value: { get_attr: [subnet, name] }
  network_id:
    description: A unique id for the network.
    value: { get_attr: [subnet, network_id] }
  ip_prefix:
    description: IP prefix of local subnet.
    value: { get_attr: [subnet, ip_prefix] }
  default_gateway:
    description: Default gateway of local subnet.
    value: { get_attr: [subnet, default_gateway] }
  ipam:
    description: IPAM this local subnet uses.
    value: { get_attr: [subnet, ipam] } (heat.py - 162)
2018-04-09 04:49:55,602 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Stack "subnet_cf9356ae-b4e1-4a91-8193-089fdc12173d" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:49:56,780 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Stack "subnet_cf9356ae-b4e1-4a91-8193-089fdc12173d" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:49:58,108 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Stack "subnet_cf9356ae-b4e1-4a91-8193-089fdc12173d" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:49:58,109 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - CREATED subnet_cf9356ae-b4e1-4a91-8193-089fdc12173d (heat.py - 280)
2018-04-09 04:49:58,597 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Job create finished with results {'heat_outputs': [{u'output_value': u'169.254.0.0/17', u'description': u'IP prefix of local subnet.', u'output_key': u'ip_prefix'}, {u'output_value': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'description': u'The name of the local subnet.', u'output_key': u'name'}, {u'output_value': u'0.0.0.0', u'description': u'Default gateway of local subnet.', u'output_key': u'default_gateway'}, {u'output_value': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'description': u'A unique id for the network.', u'output_key': u'network_id'}, {u'output_value': u'5a79909b-2bf3-4e26-8a9c-0bf6bb175457', u'description': u'IPAM this local subnet uses.', u'output_key': u'ipam'}, {u'output_value': u'8f52422a-7115-4304-99cf-fc021562c352', u'description': u'A unique id for the local subnet.', u'output_key': u'id'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:49:58,637 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Job create:heat_worker:subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d:1:7kdu4 finished. (job_queue.py - 266)
2018-04-09 04:49:58,638 [1;37mINFO[0m heat_worker - subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d - Trying to delete internal process state for resource subnet:cf9356ae-b4e1-4a91-8193-089fdc12173d (resources.py - 701)
2018-04-09 04:49:58,679 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:1:tsmd8 using id: 48fcd568-cc57-4d7b-b0e0-7fcea9dadc75 (job_queue.py - 245)
2018-04-09 04:49:58,681 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:58,681 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:58,687 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Starting work on new ready job create:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:1:tsmd8 (etcd_worker.py - 108)
2018-04-09 04:49:58,687 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Checking job status for port:343b0257-512e-40e3-b063-8cc13a4b61f4 (heat_stacks_worker.py - 44)
2018-04-09 04:49:58,715 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:1:3xe01 using id: fe1b5345-f293-400d-8aaf-604553e5d93f (job_queue.py - 245)
2018-04-09 04:49:58,718 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:58,718 [1;34mDEBUG[0m heat_worker - 6 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:58,735 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Starting work on new ready job create:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:1:3xe01 (etcd_worker.py - 108)
2018-04-09 04:49:58,735 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Checking job status for port:f84496b5-dc56-4727-87b1-aa06e2471737 (heat_stacks_worker.py - 44)
2018-04-09 04:49:58,740 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e:1:2n65z using id: 587c9be5-a66f-41e2-9318-19196e5970d7 (job_queue.py - 245)
2018-04-09 04:49:58,747 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:49:58,748 [1;34mDEBUG[0m heat_worker - 5 job slots available (etcd_worker.py - 213)
2018-04-09 04:49:58,765 [1;34mDEBUG[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Starting work on new ready job create:heat_worker:common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e:1:2n65z (etcd_worker.py - 108)
2018-04-09 04:49:58,767 [1;34mDEBUG[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Checking job status for common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e (heat_stacks_worker.py - 44)
2018-04-09 04:49:59,108 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:49:59,228 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Template id port resolved from mapping: {u'else_mapping': {u'constant': u'port'}, u'if_mapping': {u'regexp': [{u'field': u'device_owner'}, {u'constant': u'network:dhcp|network:empty'}]}, u'then_mapping': {u'constant': None}} (resources.py - 835)
2018-04-09 04:49:59,242 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.4
      ip_address: 169.254.0.4
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]




outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

 with parameters:
{"virtual_machine": "f649736d-1920-41eb-96af-d4e4fe192d0e", "name": "343b0257-512e-40e3-b063-8cc13a4b61f4", "admin_state_up": true, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_owner": "network:common_function_gateway", "virtual_machine_interface_allowed_address_pairs": [], "virtual_machine_interface_mac_address": "fa:16:3e:38:35:6a", "version": 1, "virtual_network": "fc8814a7-eb1e-4f59-8422-7de500e72782", "security_groups": [], "uuid": "343b0257-512e-40e3-b063-8cc13a4b61f4"}, 
 and heat timeout = 13, rollback = False, 
using this jinja parameters: 
{u'jinja_attached': False, u'jinja_force_dependency_gw_interface': None, u'jinja_fixed_ips': [{u'subnet_id': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'ip_address': u'169.254.0.4'}], u'jinja_force_dependency_cfg': u'', u'jinja_device_owner': u'network:common_function_gateway', u'jinja_subnets': [u'8f52422a-7115-4304-99cf-fc021562c352']} (heat.py - 145)
2018-04-09 04:49:59,243 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Creating a stack port_343b0257-512e-40e3-b063-8cc13a4b61f4 with parameters: {u'virtual_machine': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'name': u'343b0257-512e-40e3-b063-8cc13a4b61f4', u'admin_state_up': True, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_owner': u'network:common_function_gateway', u'virtual_machine_interface_allowed_address_pairs': [], u'virtual_machine_interface_mac_address': u'fa:16:3e:38:35:6a', u'version': 1, u'virtual_network': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'security_groups': [], u'uuid': u'343b0257-512e-40e3-b063-8cc13a4b61f4'}, timeout_mins: 13, and template: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.4
      ip_address: 169.254.0.4
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]




outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }
 (heat.py - 162)
2018-04-09 04:49:59,271 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:49:59,282 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:49:59,418 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Template id common_function_gateway resolved from mapping: Ccommon_function_gateway (resources.py - 835)
2018-04-09 04:49:59,455 [1;34mDEBUG[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Common Function Gateway

parameters:
  primary_device_ip:
    description: Ip address that will be used to establish ssh connection to the Primary Device.
    label: Ip address of the device.
    type: string
  primary_device_port:
    description: Port that will be used to establish ssh connection to the Primary Device.
    label: Port of the ssh connection.
    type: number
  primary_device_username:
    description: Name of the user which will be used to log onto the Primary Device.
    label: User name to log on to device.
    type: string
  primary_device_password:
    description: Password of the user which will be used to log onto the Primary Device.
    label: Users password.
    type: string
    hidden: true
  primary_device_logical_downlink_interface:
    description: Name of the created logical downlink interface on the Primary device
    label: Logical Interface name
    type: string
  primary_device_physical_downlink_interface:
    description: Physical port on the Primary device on which the logical downlink port will be configured
    label: Underlying physical interface
    type: string
  secondary_device_ip:
    description: Ip address that will be used to establish ssh connection to the Secondary Device.
    label: Ip address of the device.
    type: string
  secondary_device_port:
    description: Port that will be used to establish ssh connection to the Secondary Device.
    label: Port of the ssh connection.
    type: number
  secondary_device_username:
    description: Name of the user which will be used to log onto the Secondary Device.
    label: User name to log on to device.
    type: string
  secondary_device_password:
    description: Password of the user which will be used to log onto the Secondary Device.
    label: Users password.
    type: string
    hidden: true
  secondary_device_logical_downlink_interface:
    description: Name of the created logical downlink interface on the Secondary device
    label: Logical Interface name
    type: string
  secondary_device_physical_downlink_interface:
    description: Physical port on the Secondary device on which the logical downlink port will be configured
    label: Underlying physical interface
    type: string
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Common Function Gateway
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:

  netconf_configure_primary:
    properties:
      lock_timeout: 3000
      configs:
      - config: |
          nat-rules vrf_gw_sample-ha-router-downlink_1025-SNAPT;
          nat-rules vrf_gw_sample-ha-router-downlink_1025-DNAT;
          interface-service service-interface ms-0/2/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: named_tag
            xml_type: named_tag
            tag: service-set
            name: vrf_gw_sample-ha-router-downlink_1025
      - config: |
          apply-groups SNAPT-POOL;
          address 100.64.0.10/32;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL
      - config: |
          apply-groups SNAPT-RULE;
          term source then translated source-pool vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT
      
      - config: |
          apply-groups DNAT-POOL-1;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1
      
      - config: |
          apply-groups DNAT-POOL-2;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2
      
      - config: |
          apply-groups DNAT-RULE;
          
          term 1 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1;
          
          term 2 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2;
          
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT
      - config: |
          peer-unit 11025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          peer-unit 1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 11025
      - config: |
          family inet;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: ms-0/2/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          apply-groups IF-USER-VRRP-ACT;
          description vrf_gw_sample-ha-router-downlink_1025;
          vlan-id 1025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: { get_param: primary_device_physical_downlink_interface }
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: ""
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: named_tag
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0.11025
      - config:
          next-hop lt-0/0/0.11025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: tag
            xml_type: tag
            tag: routing-options
          - config_type: tag
            xml_type: tag
            tag: static
          - config_type: named_tag
            xml_type: named_tag
            tag: route
            name: 100.64.0.10/32
      - config:
          str_replace:
            params:
              $DOWNLINK_INTERFACE:
                get_param: primary_device_logical_downlink_interface
            template: |
              instance-type virtual-router;
              interface lt-0/0/0.1025;
              interface ms-0/2/0.1025;
              interface $DOWNLINK_INTERFACE;
              routing-options static route 0.0.0.0/0 next-hop lt-0/0/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: vrf_gw_sample-ha-router-downlink_1025
      device_ip:
        get_param: primary_device_ip
      password:
        get_param: primary_device_password
      port:
        get_param: primary_device_port
      username:
        get_param: primary_device_username
    
    type: OS::Contrail::NetconfNamedConfigs

  netconf_configure_secondary:
    properties:
      lock_timeout: 3000
      configs:
      - config: |
          nat-rules vrf_gw_sample-ha-router-downlink_1025-SNAPT;
          nat-rules vrf_gw_sample-ha-router-downlink_1025-DNAT;
          interface-service service-interface ms-0/2/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: named_tag
            xml_type: named_tag
            tag: service-set
            name: vrf_gw_sample-ha-router-downlink_1025
      - config: |
          apply-groups SNAPT-POOL;
          address 100.64.0.10/32;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL
      - config: |
          apply-groups SNAPT-RULE;
          term source then translated source-pool vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT
      
      - config: |
          apply-groups DNAT-POOL-1;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1
      
      - config: |
          apply-groups DNAT-POOL-2;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2
      
      - config: |
          apply-groups DNAT-RULE;
          
          term 1 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1;
          
          term 2 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2;
          
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT
      - config: |
          peer-unit 11025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          peer-unit 1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 11025
      - config: |
          family inet;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: ms-0/2/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          apply-groups IF-USER-VRRP-ACT;
          description vrf_gw_sample-ha-router-downlink_1025;
          vlan-id 1025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: { get_param: secondary_device_physical_downlink_interface }
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: ""
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: named_tag
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0.11025
      - config:
          next-hop lt-0/0/0.11025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: tag
            xml_type: tag
            tag: routing-options
          - config_type: tag
            xml_type: tag
            tag: static
          - config_type: named_tag
            xml_type: named_tag
            tag: route
            name: 100.64.0.10/32
      - config:
          str_replace:
            params:
              $DOWNLINK_INTERFACE:
                get_param: secondary_device_logical_downlink_interface
            template: |
              instance-type virtual-router;
              interface lt-0/0/0.1025;
              interface ms-0/2/0.1025;
              interface $DOWNLINK_INTERFACE;
              routing-options static route 0.0.0.0/0 next-hop lt-0/0/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: vrf_gw_sample-ha-router-downlink_1025
      device_ip:
        get_param: secondary_device_ip
      password:
        get_param: secondary_device_password
      port:
        get_param: secondary_device_port
      username:
        get_param: secondary_device_username
    depends_on: netconf_configure_primary
    type: OS::Contrail::NetconfNamedConfigs


  vrrp_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: vrrp_pool
      resource_type: common_function_gateways
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: status
      properties:
        vrid:
        
          - 41
        
          - 42
        
        primary:
          host: { get_param: primary_device_ip }
          port: { get_param: primary_device_port }
          login: { get_param: primary_device_username }
          password: { get_param: primary_device_password }
          interface: { get_param: primary_device_logical_downlink_interface }
        secondary:
          host: { get_param: secondary_device_ip }
          port: { get_param: secondary_device_port }
          login: { get_param: secondary_device_username }
          password: { get_param: secondary_device_password }
          interface: { get_param: secondary_device_logical_downlink_interface }
      syncer_properties:
        etcd:
          status:
            key: status
          hold_options:
            positive_status:
              primary_vrid1: MASTER
              secondary_vrid1: BACKUP
              primary_vrid2: MASTER
              secondary_vrid2: BACKUP
            time_seconds: 360
    depends_on: netconf_configure_secondary

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vrrp_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vrrp_monitor, link]}
 with parameters:
{"primary_device_logical_downlink_interface": "ae0.1025", "primary_device_password": "***", "gohan_id": "f649736d-1920-41eb-96af-d4e4fe192d0e", "primary_device_ip": "10.79.5.185", "version": 1, "secondary_device_physical_downlink_interface": "ae0", "secondary_device_username": "esi", "secondary_device_logical_downlink_interface": "ae0.1025", "tenant_id": "c583ce78843344adbe5fd20f13620274", "secondary_device_port": 830, "secondary_device_password": "***", "primary_device_username": "esi", "primary_device_physical_downlink_interface": "ae0", "primary_device_port": 830, "secondary_device_ip": "10.79.5.184"}, 
 and heat timeout = 60, rollback = False, 
using this jinja parameters: 
{u'jinja_dnat_pool_group_name': u'DNAT-POOL', u'jinja_logical_tunnel_interface_name': u'lt-0/0/0', u'jinja_snapt_pool_group_name': u'SNAPT-POOL', u'jinja_vrids': [41, 42], u'jinja_dnat_group_name': u'DNAT-RULE', u'jinja_dummy_dependency': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'jinja_logical_tunnel_unit_user': u'1025', u'jinja_common_service_numbers': [1, 2], u'jinja_vlan_id': u'1025', u'jinja_service_interface_name': u'ms-0/2/0', u'jinja_vrf_name': u'vrf_gw_sample-ha-router-downlink_1025', u'jinja_nat_ip': u'100.64.0.10', u'jinja_logical_tunnel_unit_service': u'11025', u'jinja_vrrp_group_name': u'IF-USER-VRRP-ACT', u'jinja_service_vrf_name': u'SHARED-RESOURCE', u'jinja_snapt_group_name': u'SNAPT-RULE'} (heat.py - 145)
2018-04-09 04:49:59,457 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Creating a stack common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e with parameters: {u'primary_device_logical_downlink_interface': u'ae0.1025', u'primary_device_password': u'***', u'gohan_id': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'primary_device_ip': u'10.79.5.185', u'version': 1, u'secondary_device_physical_downlink_interface': u'ae0', u'secondary_device_username': u'esi', u'secondary_device_logical_downlink_interface': u'ae0.1025', u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'secondary_device_port': 830, u'secondary_device_password': u'***', u'primary_device_username': u'esi', u'primary_device_physical_downlink_interface': u'ae0', u'primary_device_port': 830, u'secondary_device_ip': u'10.79.5.184'}, timeout_mins: 60, and template: 
heat_template_version: 2013-05-23

description: >
  Common Function Gateway

parameters:
  primary_device_ip:
    description: Ip address that will be used to establish ssh connection to the Primary Device.
    label: Ip address of the device.
    type: string
  primary_device_port:
    description: Port that will be used to establish ssh connection to the Primary Device.
    label: Port of the ssh connection.
    type: number
  primary_device_username:
    description: Name of the user which will be used to log onto the Primary Device.
    label: User name to log on to device.
    type: string
  primary_device_password:
    description: Password of the user which will be used to log onto the Primary Device.
    label: Users password.
    type: string
    hidden: true
  primary_device_logical_downlink_interface:
    description: Name of the created logical downlink interface on the Primary device
    label: Logical Interface name
    type: string
  primary_device_physical_downlink_interface:
    description: Physical port on the Primary device on which the logical downlink port will be configured
    label: Underlying physical interface
    type: string
  secondary_device_ip:
    description: Ip address that will be used to establish ssh connection to the Secondary Device.
    label: Ip address of the device.
    type: string
  secondary_device_port:
    description: Port that will be used to establish ssh connection to the Secondary Device.
    label: Port of the ssh connection.
    type: number
  secondary_device_username:
    description: Name of the user which will be used to log onto the Secondary Device.
    label: User name to log on to device.
    type: string
  secondary_device_password:
    description: Password of the user which will be used to log onto the Secondary Device.
    label: Users password.
    type: string
    hidden: true
  secondary_device_logical_downlink_interface:
    description: Name of the created logical downlink interface on the Secondary device
    label: Logical Interface name
    type: string
  secondary_device_physical_downlink_interface:
    description: Physical port on the Secondary device on which the logical downlink port will be configured
    label: Underlying physical interface
    type: string
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the Common Function Gateway
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:

  netconf_configure_primary:
    properties:
      lock_timeout: 3000
      configs:
      - config: |
          nat-rules vrf_gw_sample-ha-router-downlink_1025-SNAPT;
          nat-rules vrf_gw_sample-ha-router-downlink_1025-DNAT;
          interface-service service-interface ms-0/2/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: named_tag
            xml_type: named_tag
            tag: service-set
            name: vrf_gw_sample-ha-router-downlink_1025
      - config: |
          apply-groups SNAPT-POOL;
          address 100.64.0.10/32;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL
      - config: |
          apply-groups SNAPT-RULE;
          term source then translated source-pool vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT
      
      - config: |
          apply-groups DNAT-POOL-1;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1
      
      - config: |
          apply-groups DNAT-POOL-2;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2
      
      - config: |
          apply-groups DNAT-RULE;
          
          term 1 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1;
          
          term 2 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2;
          
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT
      - config: |
          peer-unit 11025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          peer-unit 1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 11025
      - config: |
          family inet;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: ms-0/2/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          apply-groups IF-USER-VRRP-ACT;
          description vrf_gw_sample-ha-router-downlink_1025;
          vlan-id 1025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: { get_param: primary_device_physical_downlink_interface }
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: ""
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: named_tag
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0.11025
      - config:
          next-hop lt-0/0/0.11025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: tag
            xml_type: tag
            tag: routing-options
          - config_type: tag
            xml_type: tag
            tag: static
          - config_type: named_tag
            xml_type: named_tag
            tag: route
            name: 100.64.0.10/32
      - config:
          str_replace:
            params:
              $DOWNLINK_INTERFACE:
                get_param: primary_device_logical_downlink_interface
            template: |
              instance-type virtual-router;
              interface lt-0/0/0.1025;
              interface ms-0/2/0.1025;
              interface $DOWNLINK_INTERFACE;
              routing-options static route 0.0.0.0/0 next-hop lt-0/0/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: vrf_gw_sample-ha-router-downlink_1025
      device_ip:
        get_param: primary_device_ip
      password:
        get_param: primary_device_password
      port:
        get_param: primary_device_port
      username:
        get_param: primary_device_username
    
    type: OS::Contrail::NetconfNamedConfigs

  netconf_configure_secondary:
    properties:
      lock_timeout: 3000
      configs:
      - config: |
          nat-rules vrf_gw_sample-ha-router-downlink_1025-SNAPT;
          nat-rules vrf_gw_sample-ha-router-downlink_1025-DNAT;
          interface-service service-interface ms-0/2/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: named_tag
            xml_type: named_tag
            tag: service-set
            name: vrf_gw_sample-ha-router-downlink_1025
      - config: |
          apply-groups SNAPT-POOL;
          address 100.64.0.10/32;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL
      - config: |
          apply-groups SNAPT-RULE;
          term source then translated source-pool vrf_gw_sample-ha-router-downlink_1025-SNAPT-POOL;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-SNAPT
      
      - config: |
          apply-groups DNAT-POOL-1;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1
      
      - config: |
          apply-groups DNAT-POOL-2;
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: pool
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2
      
      - config: |
          apply-groups DNAT-RULE;
          
          term 1 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-1;
          
          term 2 then translated destination-pool vrf_gw_sample-ha-router-downlink_1025-DNAT-POOL-2;
          
        path:
          - config_type: tag
            xml_type: tag
            tag: services
          - config_type: tag
            xml_type: tag
            tag: nat
          - config_type: named_tag
            xml_type: named_tag
            tag: rule
            name: vrf_gw_sample-ha-router-downlink_1025-DNAT
      - config: |
          peer-unit 11025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          peer-unit 1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 11025
      - config: |
          family inet;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: ms-0/2/0
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: |
          apply-groups IF-USER-VRRP-ACT;
          description vrf_gw_sample-ha-router-downlink_1025;
          vlan-id 1025;
          family inet service input service-set vrf_gw_sample-ha-router-downlink_1025;
          family inet service output service-set vrf_gw_sample-ha-router-downlink_1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: interfaces
          - config_type: name
            xml_type: named_tag
            tag: interface
            name: { get_param: secondary_device_physical_downlink_interface }
          - config_type: named_tag
            xml_type: named_tag
            tag: unit
            name: 1025
      - config: ""
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: named_tag
            xml_type: named_tag
            tag: interface
            name: lt-0/0/0.11025
      - config:
          next-hop lt-0/0/0.11025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: SHARED-RESOURCE
          - config_type: tag
            xml_type: tag
            tag: routing-options
          - config_type: tag
            xml_type: tag
            tag: static
          - config_type: named_tag
            xml_type: named_tag
            tag: route
            name: 100.64.0.10/32
      - config:
          str_replace:
            params:
              $DOWNLINK_INTERFACE:
                get_param: secondary_device_logical_downlink_interface
            template: |
              instance-type virtual-router;
              interface lt-0/0/0.1025;
              interface ms-0/2/0.1025;
              interface $DOWNLINK_INTERFACE;
              routing-options static route 0.0.0.0/0 next-hop lt-0/0/0.1025;
        path:
          - config_type: tag
            xml_type: tag
            tag: routing-instances
          - config_type: name
            xml_type: named_tag
            tag: instance
            name: vrf_gw_sample-ha-router-downlink_1025
      device_ip:
        get_param: secondary_device_ip
      password:
        get_param: secondary_device_password
      port:
        get_param: secondary_device_port
      username:
        get_param: secondary_device_username
    depends_on: netconf_configure_primary
    type: OS::Contrail::NetconfNamedConfigs


  vrrp_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: vrrp_pool
      resource_type: common_function_gateways
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: status
      properties:
        vrid:
        
          - 41
        
          - 42
        
        primary:
          host: { get_param: primary_device_ip }
          port: { get_param: primary_device_port }
          login: { get_param: primary_device_username }
          password: { get_param: primary_device_password }
          interface: { get_param: primary_device_logical_downlink_interface }
        secondary:
          host: { get_param: secondary_device_ip }
          port: { get_param: secondary_device_port }
          login: { get_param: secondary_device_username }
          password: { get_param: secondary_device_password }
          interface: { get_param: secondary_device_logical_downlink_interface }
      syncer_properties:
        etcd:
          status:
            key: status
          hold_options:
            positive_status:
              primary_vrid1: MASTER
              secondary_vrid1: BACKUP
              primary_vrid2: MASTER
              secondary_vrid2: BACKUP
            time_seconds: 360
    depends_on: netconf_configure_secondary

outputs:
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vrrp_monitor}
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vrrp_monitor, link]} (heat.py - 162)
2018-04-09 04:49:59,460 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Template id port resolved from mapping: {u'else_mapping': {u'constant': u'port'}, u'if_mapping': {u'regexp': [{u'field': u'device_owner'}, {u'constant': u'network:dhcp|network:empty'}]}, u'then_mapping': {u'constant': None}} (resources.py - 835)
2018-04-09 04:49:59,470 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.3
      ip_address: 169.254.0.3
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]




outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

 with parameters:
{"virtual_machine": "f649736d-1920-41eb-96af-d4e4fe192d0e", "name": "f84496b5-dc56-4727-87b1-aa06e2471737", "admin_state_up": true, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_owner": "network:common_function_gateway", "virtual_machine_interface_allowed_address_pairs": [], "virtual_machine_interface_mac_address": "fa:16:3e:82:e7:8b", "version": 1, "virtual_network": "fc8814a7-eb1e-4f59-8422-7de500e72782", "security_groups": [], "uuid": "f84496b5-dc56-4727-87b1-aa06e2471737"}, 
 and heat timeout = 13, rollback = False, 
using this jinja parameters: 
{u'jinja_attached': False, u'jinja_force_dependency_gw_interface': None, u'jinja_fixed_ips': [{u'subnet_id': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'ip_address': u'169.254.0.3'}], u'jinja_force_dependency_cfg': u'', u'jinja_device_owner': u'network:common_function_gateway', u'jinja_subnets': [u'8f52422a-7115-4304-99cf-fc021562c352']} (heat.py - 145)
2018-04-09 04:49:59,471 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Creating a stack port_f84496b5-dc56-4727-87b1-aa06e2471737 with parameters: {u'virtual_machine': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'name': u'f84496b5-dc56-4727-87b1-aa06e2471737', u'admin_state_up': True, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_owner': u'network:common_function_gateway', u'virtual_machine_interface_allowed_address_pairs': [], u'virtual_machine_interface_mac_address': u'fa:16:3e:82:e7:8b', u'version': 1, u'virtual_network': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'security_groups': [], u'uuid': u'f84496b5-dc56-4727-87b1-aa06e2471737'}, timeout_mins: 13, and template: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.3
      ip_address: 169.254.0.3
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]




outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }
 (heat.py - 162)
2018-04-09 04:50:00,332 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:00,964 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:00,987 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:01,485 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:02,254 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:02,351 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:02,641 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:03,511 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:03,897 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:03,897 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - CREATED port_f84496b5-dc56-4727-87b1-aa06e2471737 (heat.py - 280)
2018-04-09 04:50:04,208 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:04,208 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - CREATED port_343b0257-512e-40e3-b063-8cc13a4b61f4 (heat.py - 280)
2018-04-09 04:50:04,972 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Job create finished with results {'heat_outputs': [{u'output_value': [[u'default-domain', u'admin', u'b62eefe0-0872-478d-adfe-1a606320f0e7']], u'description': u'Virtual network.', u'output_key': u'virtual_network'}, {u'output_value': u'default-domain:admin:f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'Fully Qualified Name of the VMI', u'output_key': u'fq_name'}, {u'output_value': u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'A unique id for the virtual machine interface.', u'output_key': u'id'}, {u'output_value': {u'allowed_address_pair': []}, u'description': u'Virtual machine allowed address pairs.', u'output_key': u'allowed_address_pairs'}, {u'output_value': [u'fa:16:3e:f7:60:7f'], u'description': u'Virtual machine interface mac address.', u'output_key': u'mac_address'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:05,012 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Job create:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:1:3xe01 finished. (job_queue.py - 266)
2018-04-09 04:50:05,013 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Trying to delete internal process state for resource port:f84496b5-dc56-4727-87b1-aa06e2471737 (resources.py - 701)
2018-04-09 04:50:05,066 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824:1:2u7dw using id: 47182a6d-122d-439e-a832-452322cc3ff3 (job_queue.py - 245)
2018-04-09 04:50:05,068 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:50:05,068 [1;34mDEBUG[0m heat_worker - 5 job slots available (etcd_worker.py - 213)
2018-04-09 04:50:05,084 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:05,088 [1;34mDEBUG[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Starting work on new ready job create:heat_worker:ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824:1:2u7dw (etcd_worker.py - 108)
2018-04-09 04:50:05,092 [1;34mDEBUG[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Checking job status for ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 (heat_stacks_worker.py - 44)
2018-04-09 04:50:05,162 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Job create finished with results {'heat_outputs': [{u'output_value': [[u'default-domain', u'admin', u'b62eefe0-0872-478d-adfe-1a606320f0e7']], u'description': u'Virtual network.', u'output_key': u'virtual_network'}, {u'output_value': u'default-domain:admin:f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'Fully Qualified Name of the VMI', u'output_key': u'fq_name'}, {u'output_value': u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'A unique id for the virtual machine interface.', u'output_key': u'id'}, {u'output_value': {u'allowed_address_pair': []}, u'description': u'Virtual machine allowed address pairs.', u'output_key': u'allowed_address_pairs'}, {u'output_value': [u'fa:16:3e:f7:60:7f'], u'description': u'Virtual machine interface mac address.', u'output_key': u'mac_address'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:05,207 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Job create:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:1:tsmd8 finished. (job_queue.py - 266)
2018-04-09 04:50:05,208 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Trying to delete internal process state for resource port:343b0257-512e-40e3-b063-8cc13a4b61f4 (resources.py - 701)
2018-04-09 04:50:05,246 [1;37mINFO[0m heat_worker - Reserved job: create:heat_worker:ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1:1:euyfe using id: 70159335-06c7-47b5-b736-ac7599bad5a7 (job_queue.py - 245)
2018-04-09 04:50:05,248 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:50:05,248 [1;34mDEBUG[0m heat_worker - 5 job slots available (etcd_worker.py - 213)
2018-04-09 04:50:05,254 [1;34mDEBUG[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Starting work on new ready job create:heat_worker:ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1:1:euyfe (etcd_worker.py - 108)
2018-04-09 04:50:05,254 [1;34mDEBUG[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Checking job status for ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 (heat_stacks_worker.py - 44)
2018-04-09 04:50:05,630 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:50:05,638 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - CREATE STARTED (heat_messenger.py - 92)
2018-04-09 04:50:05,725 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Template id ese_logical_port resolved from mapping: Cese_logical_port (resources.py - 835)
2018-04-09 04:50:05,734 [1;34mDEBUG[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Logical port template

parameters:
  physical_port_id:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  logical_port_name:
    type: string
    label: Logical Port Name
    description: Name of the logical port.
  logical_port_type:
    type: string
    label: Logical Port Type
    description: Type of the logical port.
  logical_port_vlan_id:
    type: number
    label: VLAN id for Logical Port
    description: VLAN id to use for logical port creation.
    default: 0
  virtual_machine_interface_ids:
    type: comma_delimited_list
    label: Virtual Machine Interface ID
    description: Virtual Machine Interface ID.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  logical_interface:
    type: OS::Contrail::LogicalInterface
    properties:
      name: { get_param: logical_port_name }
      physical_interface: { get_param: physical_port_id }
      virtual_machine_interfaces: { get_param: virtual_machine_interface_ids }
      type: { get_param: logical_port_type }
      vlan: { get_param: logical_port_vlan_id }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports
      resource_type: ese_logical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: logical_port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: logical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: logical_port
        tsdb:
          traffic.in:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: f84496b5-dc56-4727-87b1-aa06e2471737
                 direction: in
              
          traffic.out:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: f84496b5-dc56-4727-87b1-aa06e2471737
                 direction: out
              
    depends_on: logical_interface

outputs:
  id:
    description: A unique id for the logical interface
    value: { get_resource: logical_interface }
  name:
    description: The name of the logical interface.
    value: { get_attr: [logical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] }
 with parameters:
{"logical_port_type": "L2", "logical_port_vlan_id": 1025, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.161.0.34", "version": 1, "virtual_machine_interface_ids": ["f68d0924-ef20-4c1b-ac45-0e6b879af5e7"], "logical_port_name": "xe-0/0/3.1025", "gohan_id": "be66c7e0-b222-4e76-bf81-af75e8cf1824", "physical_port_id": "06bfe521-07f0-4931-9f8c-318c3ad8114e"}, 
 and heat timeout = 6, rollback = False, 
using this jinja parameters: 
{u'jinja_port_ids': [u'f84496b5-dc56-4727-87b1-aa06e2471737']} (heat.py - 145)
2018-04-09 04:50:05,734 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Creating a stack ese_logical_port_be66c7e0-b222-4e76-bf81-af75e8cf1824 with parameters: {u'logical_port_type': u'L2', u'logical_port_vlan_id': 1025, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.161.0.34', u'version': 1, u'virtual_machine_interface_ids': [u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7'], u'logical_port_name': u'xe-0/0/3.1025', u'gohan_id': u'be66c7e0-b222-4e76-bf81-af75e8cf1824', u'physical_port_id': u'06bfe521-07f0-4931-9f8c-318c3ad8114e'}, timeout_mins: 6, and template: 
heat_template_version: 2013-05-23

description: >
  Logical port template

parameters:
  physical_port_id:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  logical_port_name:
    type: string
    label: Logical Port Name
    description: Name of the logical port.
  logical_port_type:
    type: string
    label: Logical Port Type
    description: Type of the logical port.
  logical_port_vlan_id:
    type: number
    label: VLAN id for Logical Port
    description: VLAN id to use for logical port creation.
    default: 0
  virtual_machine_interface_ids:
    type: comma_delimited_list
    label: Virtual Machine Interface ID
    description: Virtual Machine Interface ID.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  logical_interface:
    type: OS::Contrail::LogicalInterface
    properties:
      name: { get_param: logical_port_name }
      physical_interface: { get_param: physical_port_id }
      virtual_machine_interfaces: { get_param: virtual_machine_interface_ids }
      type: { get_param: logical_port_type }
      vlan: { get_param: logical_port_vlan_id }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports
      resource_type: ese_logical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: logical_port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: logical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: logical_port
        tsdb:
          traffic.in:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: f84496b5-dc56-4727-87b1-aa06e2471737
                 direction: in
              
          traffic.out:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: f84496b5-dc56-4727-87b1-aa06e2471737
                 direction: out
              
    depends_on: logical_interface

outputs:
  id:
    description: A unique id for the logical interface
    value: { get_resource: logical_interface }
  name:
    description: The name of the logical interface.
    value: { get_attr: [logical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] } (heat.py - 162)
2018-04-09 04:50:05,737 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Template id ese_logical_port resolved from mapping: Cese_logical_port (resources.py - 835)
2018-04-09 04:50:05,744 [1;34mDEBUG[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Logical port template

parameters:
  physical_port_id:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  logical_port_name:
    type: string
    label: Logical Port Name
    description: Name of the logical port.
  logical_port_type:
    type: string
    label: Logical Port Type
    description: Type of the logical port.
  logical_port_vlan_id:
    type: number
    label: VLAN id for Logical Port
    description: VLAN id to use for logical port creation.
    default: 0
  virtual_machine_interface_ids:
    type: comma_delimited_list
    label: Virtual Machine Interface ID
    description: Virtual Machine Interface ID.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  logical_interface:
    type: OS::Contrail::LogicalInterface
    properties:
      name: { get_param: logical_port_name }
      physical_interface: { get_param: physical_port_id }
      virtual_machine_interfaces: { get_param: virtual_machine_interface_ids }
      type: { get_param: logical_port_type }
      vlan: { get_param: logical_port_vlan_id }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports
      resource_type: ese_logical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: logical_port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: logical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: logical_port
        tsdb:
          traffic.in:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: 343b0257-512e-40e3-b063-8cc13a4b61f4
                 direction: in
              
          traffic.out:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: 343b0257-512e-40e3-b063-8cc13a4b61f4
                 direction: out
              
    depends_on: logical_interface

outputs:
  id:
    description: A unique id for the logical interface
    value: { get_resource: logical_interface }
  name:
    description: The name of the logical interface.
    value: { get_attr: [logical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] }
 with parameters:
{"logical_port_type": "L2", "logical_port_vlan_id": 1025, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_ip": "10.161.0.34", "version": 1, "virtual_machine_interface_ids": ["f68d0924-ef20-4c1b-ac45-0e6b879af5e7"], "logical_port_name": "xe-0/0/4.1025", "gohan_id": "e8555ee6-529c-42d9-8bb1-bfbe217133b1", "physical_port_id": "06bfe521-07f0-4931-9f8c-318c3ad8114e"}, 
 and heat timeout = 6, rollback = False, 
using this jinja parameters: 
{u'jinja_port_ids': [u'343b0257-512e-40e3-b063-8cc13a4b61f4']} (heat.py - 145)
2018-04-09 04:50:05,745 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Creating a stack ese_logical_port_e8555ee6-529c-42d9-8bb1-bfbe217133b1 with parameters: {u'logical_port_type': u'L2', u'logical_port_vlan_id': 1025, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_ip': u'10.161.0.34', u'version': 1, u'virtual_machine_interface_ids': [u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7'], u'logical_port_name': u'xe-0/0/4.1025', u'gohan_id': u'e8555ee6-529c-42d9-8bb1-bfbe217133b1', u'physical_port_id': u'06bfe521-07f0-4931-9f8c-318c3ad8114e'}, timeout_mins: 6, and template: 
heat_template_version: 2013-05-23

description: >
  Logical port template

parameters:
  physical_port_id:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  logical_port_name:
    type: string
    label: Logical Port Name
    description: Name of the logical port.
  logical_port_type:
    type: string
    label: Logical Port Type
    description: Type of the logical port.
  logical_port_vlan_id:
    type: number
    label: VLAN id for Logical Port
    description: VLAN id to use for logical port creation.
    default: 0
  virtual_machine_interface_ids:
    type: comma_delimited_list
    label: Virtual Machine Interface ID
    description: Virtual Machine Interface ID.
  gohan_id:
    type: string
    label: Gohan resource ID
    description: UUID of the ESE Physical Port
  device_ip:
    type: string
    label: Device IP Address
    description: Device IP Address.
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  logical_interface:
    type: OS::Contrail::LogicalInterface
    properties:
      name: { get_param: logical_port_name }
      physical_interface: { get_param: physical_port_id }
      virtual_machine_interfaces: { get_param: virtual_machine_interface_ids }
      type: { get_param: logical_port_type }
      vlan: { get_param: logical_port_vlan_id }

  interface_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: snmp_ports
      resource_type: ese_logical_ports
      resource_id: { get_param: gohan_id }
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      field_name: logical_port
      properties:
        device_ip: { get_param: device_ip }
        if_name: { get_param: logical_port_name }
        community_name: ESE_NODE_COMMUNITY
      syncer_properties:
        etcd:
          status:
            key: logical_port
        tsdb:
          traffic.in:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: 343b0257-512e-40e3-b063-8cc13a4b61f4
                 direction: in
              
          traffic.out:
            metric: traffic.bytes
            tags:
              
              -  resource_id: { get_param: gohan_id }
                 port_id: 343b0257-512e-40e3-b063-8cc13a4b61f4
                 direction: out
              
    depends_on: logical_interface

outputs:
  id:
    description: A unique id for the logical interface
    value: { get_resource: logical_interface }
  name:
    description: The name of the logical interface.
    value: { get_attr: [logical_interface, name] }
  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: interface_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [interface_monitor, link] } (heat.py - 162)
2018-04-09 04:50:06,510 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:06,563 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Stack "ese_logical_port_be66c7e0-b222-4e76-bf81-af75e8cf1824" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:06,568 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Stack "ese_logical_port_e8555ee6-529c-42d9-8bb1-bfbe217133b1" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:07,875 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:07,918 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Stack "ese_logical_port_e8555ee6-529c-42d9-8bb1-bfbe217133b1" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:07,932 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Stack "ese_logical_port_be66c7e0-b222-4e76-bf81-af75e8cf1824" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:09,223 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:09,321 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Stack "ese_logical_port_be66c7e0-b222-4e76-bf81-af75e8cf1824" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:09,321 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - CREATED ese_logical_port_be66c7e0-b222-4e76-bf81-af75e8cf1824 (heat.py - 280)
2018-04-09 04:50:09,460 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Stack "ese_logical_port_e8555ee6-529c-42d9-8bb1-bfbe217133b1" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:09,460 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - CREATED ese_logical_port_e8555ee6-529c-42d9-8bb1-bfbe217133b1 (heat.py - 280)
2018-04-09 04:50:09,853 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Job create finished with results {'heat_outputs': [{u'output_value': u'bdc2f00e-073d-49d6-ac27-43782568b081', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'46b0cd68-d0fb-4d72-9def-830164f9e215', u'description': u'A unique id for the logical interface', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/bdc2f00e-073d-49d6-ac27-43782568b081', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}, {u'output_value': u'xe-0/0/38.0', u'description': u'The name of the logical interface.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:09,904 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Job create:heat_worker:ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824:1:2u7dw finished. (job_queue.py - 266)
2018-04-09 04:50:09,906 [1;37mINFO[0m heat_worker - ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 - Trying to delete internal process state for resource ese_logical_port:be66c7e0-b222-4e76-bf81-af75e8cf1824 (resources.py - 701)
2018-04-09 04:50:10,093 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Job create finished with results {'heat_outputs': [{u'output_value': u'7f066c44-1dc2-44b2-95f7-d59d70bd77fb', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'46b0cd68-d0fb-4d72-9def-830164f9e215', u'description': u'A unique id for the logical interface', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/7f066c44-1dc2-44b2-95f7-d59d70bd77fb', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}, {u'output_value': u'xe-0/0/38.0', u'description': u'The name of the logical interface.', u'output_key': u'name'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:10,142 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Job create:heat_worker:ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1:1:euyfe finished. (job_queue.py - 266)
2018-04-09 04:50:10,143 [1;37mINFO[0m heat_worker - ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 - Trying to delete internal process state for resource ese_logical_port:e8555ee6-529c-42d9-8bb1-bfbe217133b1 (resources.py - 701)
2018-04-09 04:50:10,862 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:12,036 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:13,171 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:14,313 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:15,478 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:16,617 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:17,756 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:18,928 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:20,072 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:21,217 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:22,382 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Stack "common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e" in status "CREATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:22,382 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - CREATED common_function_gateway_f649736d-1920-41eb-96af-d4e4fe192d0e (heat.py - 280)
2018-04-09 04:50:22,794 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Job create finished with results {'heat_outputs': [{u'output_value': u'cfb54c6f-43cf-4e35-aff8-e2c2ec8adc7e', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/cfb54c6f-43cf-4e35-aff8-e2c2ec8adc7e', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'CREATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:22,844 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Job create:heat_worker:common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e:1:2n65z finished. (job_queue.py - 266)
2018-04-09 04:50:22,844 [1;37mINFO[0m heat_worker - common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e - Trying to delete internal process state for resource common_function_gateway:f649736d-1920-41eb-96af-d4e4fe192d0e (resources.py - 701)
2018-04-09 04:50:22,895 [1;37mINFO[0m heat_worker - Reserved job: modify:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:2:biikl using id: 57753094-00af-4cc0-b690-c4119e0b0ee2 (job_queue.py - 245)
2018-04-09 04:50:22,901 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:50:22,901 [1;34mDEBUG[0m heat_worker - 7 job slots available (etcd_worker.py - 213)
2018-04-09 04:50:22,910 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Starting work on new ready job modify:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:2:biikl (etcd_worker.py - 108)
2018-04-09 04:50:22,910 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Checking job status for port:343b0257-512e-40e3-b063-8cc13a4b61f4 (heat_stacks_worker.py - 44)
2018-04-09 04:50:22,928 [1;37mINFO[0m heat_worker - Reserved job: modify:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:2:fxjly using id: cbef2db1-918a-45b6-8c03-2e8079e6411a (job_queue.py - 245)
2018-04-09 04:50:22,930 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:50:22,930 [1;34mDEBUG[0m heat_worker - 6 job slots available (etcd_worker.py - 213)
2018-04-09 04:50:22,947 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Starting work on new ready job modify:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:2:fxjly (etcd_worker.py - 108)
2018-04-09 04:50:22,948 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Checking job status for port:f84496b5-dc56-4727-87b1-aa06e2471737 (heat_stacks_worker.py - 44)
2018-04-09 04:50:23,531 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Found stack with status CREATE_COMPLETE for port:343b0257-512e-40e3-b063-8cc13a4b61f4 (heat_stacks_worker.py - 55)
2018-04-09 04:50:23,533 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - MODIFY STARTED (heat_messenger.py - 123)
2018-04-09 04:50:23,610 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Found stack with status CREATE_COMPLETE for port:f84496b5-dc56-4727-87b1-aa06e2471737 (heat_stacks_worker.py - 55)
2018-04-09 04:50:23,610 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - MODIFY STARTED (heat_messenger.py - 123)
2018-04-09 04:50:24,695 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Template id port resolved from mapping: {u'else_mapping': {u'constant': u'port'}, u'if_mapping': {u'regexp': [{u'field': u'device_owner'}, {u'constant': u'network:dhcp|network:empty'}]}, u'then_mapping': {u'constant': None}} (resources.py - 835)
2018-04-09 04:50:24,707 [1;34mDEBUG[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.4
      ip_address: 169.254.0.4
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]



  vmi_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: virtual_machine_interface
      resource_type: ports
      resource_id: { get_param: uuid }
      field_name: vmi
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      properties:
        fq_name: { get_attr: [virtual_machine_interface, fq_name] }
      syncer_properties:
        etcd:
          status:
            key: vmi
        tsdb:
          traffic.in:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: in
          traffic.out:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: out
    depends_on: virtual_machine_interface


outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vmi_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vmi_monitor, link] }

 with parameters:
{"virtual_machine": "f649736d-1920-41eb-96af-d4e4fe192d0e", "name": "343b0257-512e-40e3-b063-8cc13a4b61f4", "admin_state_up": true, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_owner": "network:common_function_gateway", "virtual_machine_interface_allowed_address_pairs": [], "virtual_machine_interface_mac_address": "fa:16:3e:38:35:6a", "version": 2, "virtual_network": "fc8814a7-eb1e-4f59-8422-7de500e72782", "security_groups": [], "uuid": "343b0257-512e-40e3-b063-8cc13a4b61f4"}, 
 and heat timeout = 13, rollback = False, 
using this jinja parameters: 
{u'jinja_attached': True, u'jinja_force_dependency_gw_interface': None, u'jinja_fixed_ips': [{u'subnet_id': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'ip_address': u'169.254.0.4'}], u'jinja_force_dependency_cfg': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'jinja_device_owner': u'network:common_function_gateway', u'jinja_subnets': [u'8f52422a-7115-4304-99cf-fc021562c352']} (heat.py - 145)
2018-04-09 04:50:24,707 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Updating a stack port_343b0257-512e-40e3-b063-8cc13a4b61f4 with parameters: {u'virtual_machine': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'name': u'343b0257-512e-40e3-b063-8cc13a4b61f4', u'admin_state_up': True, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_owner': u'network:common_function_gateway', u'virtual_machine_interface_allowed_address_pairs': [], u'virtual_machine_interface_mac_address': u'fa:16:3e:38:35:6a', u'version': 2, u'virtual_network': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'security_groups': [], u'uuid': u'343b0257-512e-40e3-b063-8cc13a4b61f4'}, timeout_mins: 13, and template: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.4
      ip_address: 169.254.0.4
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]



  vmi_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: virtual_machine_interface
      resource_type: ports
      resource_id: { get_param: uuid }
      field_name: vmi
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      properties:
        fq_name: { get_attr: [virtual_machine_interface, fq_name] }
      syncer_properties:
        etcd:
          status:
            key: vmi
        tsdb:
          traffic.in:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: in
          traffic.out:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: out
    depends_on: virtual_machine_interface


outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vmi_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vmi_monitor, link] }
 (heat.py - 186)
2018-04-09 04:50:24,889 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Template id port resolved from mapping: {u'else_mapping': {u'constant': u'port'}, u'if_mapping': {u'regexp': [{u'field': u'device_owner'}, {u'constant': u'network:dhcp|network:empty'}]}, u'then_mapping': {u'constant': None}} (resources.py - 835)
2018-04-09 04:50:24,906 [1;34mDEBUG[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Heat template prepared: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.3
      ip_address: 169.254.0.3
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]



  vmi_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: virtual_machine_interface
      resource_type: ports
      resource_id: { get_param: uuid }
      field_name: vmi
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      properties:
        fq_name: { get_attr: [virtual_machine_interface, fq_name] }
      syncer_properties:
        etcd:
          status:
            key: vmi
        tsdb:
          traffic.in:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: in
          traffic.out:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: out
    depends_on: virtual_machine_interface


outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vmi_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vmi_monitor, link] }

 with parameters:
{"virtual_machine": "f649736d-1920-41eb-96af-d4e4fe192d0e", "name": "f84496b5-dc56-4727-87b1-aa06e2471737", "admin_state_up": true, "tenant_id": "c583ce78843344adbe5fd20f13620274", "device_owner": "network:common_function_gateway", "virtual_machine_interface_allowed_address_pairs": [], "virtual_machine_interface_mac_address": "fa:16:3e:82:e7:8b", "version": 2, "virtual_network": "fc8814a7-eb1e-4f59-8422-7de500e72782", "security_groups": [], "uuid": "f84496b5-dc56-4727-87b1-aa06e2471737"}, 
 and heat timeout = 13, rollback = False, 
using this jinja parameters: 
{u'jinja_attached': True, u'jinja_force_dependency_gw_interface': None, u'jinja_fixed_ips': [{u'subnet_id': u'cf9356ae-b4e1-4a91-8193-089fdc12173d', u'ip_address': u'169.254.0.3'}], u'jinja_force_dependency_cfg': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'jinja_device_owner': u'network:common_function_gateway', u'jinja_subnets': [u'8f52422a-7115-4304-99cf-fc021562c352']} (heat.py - 145)
2018-04-09 04:50:24,907 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Updating a stack port_f84496b5-dc56-4727-87b1-aa06e2471737 with parameters: {u'virtual_machine': u'f649736d-1920-41eb-96af-d4e4fe192d0e', u'name': u'f84496b5-dc56-4727-87b1-aa06e2471737', u'admin_state_up': True, u'tenant_id': u'c583ce78843344adbe5fd20f13620274', u'device_owner': u'network:common_function_gateway', u'virtual_machine_interface_allowed_address_pairs': [], u'virtual_machine_interface_mac_address': u'fa:16:3e:82:e7:8b', u'version': 2, u'virtual_network': u'fc8814a7-eb1e-4f59-8422-7de500e72782', u'security_groups': [], u'uuid': u'f84496b5-dc56-4727-87b1-aa06e2471737'}, timeout_mins: 13, and template: 
heat_template_version: 2013-05-23

description: >
  Virtual Machine Interface Template

parameters:
  uuid:
    type: string
    label: Backend Virtual Machine Interface UUID
    description: A unique id for the Virtual Machine Interface.
  name:
    type: string
    label: Physical Interface ID
    description: A unique id for the Physical Interface.
  security_groups:
    type: json
    default: []
    label: Security Groups List
    description: The IDs of security groups applied to the port.
  virtual_machine_interface_allowed_address_pairs:
    type: json
    label: Virtual machine interface allowed address pairs.
  virtual_machine_interface_mac_address:
    type: string
    default: "fe:ff:ff:ff:ff:ff"
    label: Virtual machine interface mac address.
  virtual_network:
    type: string
    label: Virtual Network.
  virtual_machine:
    type: string
    label: Virtual Machine.
    default: ""
  device_owner:
    type: string
    label: Device Owner
    default: ""
  admin_state_up:
    type: boolean
    label: Admin state up
    default: true
  tenant_id:
    type: string
    label: Tenant ID
  version:
    type: number
    label: Config version

resources:
  virtual_machine_interface:
    type: OS::Contrail::VirtualMachineInterface
    properties:
      uuid: { get_param: uuid }
      name: { get_param: name }
      virtual_machine_interface_allowed_address_pairs: { get_param: virtual_machine_interface_allowed_address_pairs }
      virtual_machine_interface_mac_addresses: [ { get_param: virtual_machine_interface_mac_address } ]
      virtual_networks: [ { get_param: virtual_network } ]
      virtual_machine: { get_param: virtual_machine }
      device_owner: { get_param: device_owner }
      admin_state_up: { get_param: admin_state_up }
      security_groups: { get_param: security_groups }



  instance_ip_0:
    type: OS::Contrail::InstanceIp
    properties:
      name:
        str_replace:
          template: '%name%_%zone%_%ip%'
          params:
            "%name%": { get_param: name }
            "%zone%": cf9356ae-b4e1-4a91-8193-089fdc12173d
            "%ip%": 169.254.0.3
      ip_address: 169.254.0.3
      subnet_id: 8f52422a-7115-4304-99cf-fc021562c352
      network_id: { get_param: virtual_network }
      virtual_machine_interfaces: [ { get_resource: virtual_machine_interface } ]



  vmi_monitor:
    type: ESI::Monitoring::MonitoringTarget
    properties:
      type: virtual_machine_interface
      resource_type: ports
      resource_id: { get_param: uuid }
      field_name: vmi
      tenant_id: { get_param: tenant_id }
      version: { get_param: version }
      properties:
        fq_name: { get_attr: [virtual_machine_interface, fq_name] }
      syncer_properties:
        etcd:
          status:
            key: vmi
        tsdb:
          traffic.in:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: in
          traffic.out:
            metric: traffic.contrail_bytes
            tags:
              resource_id: { get_param: uuid }
              direction: out
    depends_on: virtual_machine_interface


outputs:
  id:
    description: A unique id for the virtual machine interface.
    value: { get_resource: virtual_machine_interface }
  mac_address:
    description: Virtual machine interface mac address.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses] }
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value: { get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs] }
  virtual_network:
    description: Virtual network.
    value: { get_attr: [virtual_machine_interface, virtual_networks] }
  fq_name:
    description: Fully Qualified Name of the VMI
    value: { get_attr: [virtual_machine_interface, fq_name] }

  monitoring_target_id:
    description: Monitoring Target ID
    value: { get_resource: vmi_monitor }
  monitoring_link:
    description: Monitoring Process Link
    value: { get_attr: [vmi_monitor, link] }
 (heat.py - 186)
2018-04-09 04:50:25,313 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:25,389 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:26,491 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:26,581 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:27,671 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:27,764 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:28,911 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:28,989 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:30,215 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:30,234 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:31,485 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:31,507 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:32,701 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:32,724 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_IN_PROGRESS" (heat.py - 221)
2018-04-09 04:50:34,108 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Stack "port_343b0257-512e-40e3-b063-8cc13a4b61f4" in status "UPDATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:34,109 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - MODIFIED port_343b0257-512e-40e3-b063-8cc13a4b61f4 (heat.py - 329)
2018-04-09 04:50:34,237 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Stack "port_f84496b5-dc56-4727-87b1-aa06e2471737" in status "UPDATE_COMPLETE" (heat.py - 221)
2018-04-09 04:50:34,238 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - MODIFIED port_f84496b5-dc56-4727-87b1-aa06e2471737 (heat.py - 329)
2018-04-09 04:50:34,831 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Job modify finished with results {'heat_outputs': [{u'output_value': u'default-domain:admin:f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'Fully Qualified Name of the VMI', u'output_key': u'fq_name'}, {u'output_value': {u'allowed_address_pair': []}, u'description': u'Virtual machine allowed address pairs.', u'output_key': u'allowed_address_pairs'}, {u'output_value': u'9ba38fcf-3f2e-41e5-af92-cb4603c33e62', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': [u'fa:16:3e:f7:60:7f'], u'description': u'Virtual machine interface mac address.', u'output_key': u'mac_address'}, {u'output_value': [[u'default-domain', u'admin', u'b62eefe0-0872-478d-adfe-1a606320f0e7']], u'description': u'Virtual network.', u'output_key': u'virtual_network'}, {u'output_value': u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'A unique id for the virtual machine interface.', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/9ba38fcf-3f2e-41e5-af92-cb4603c33e62', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'UPDATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:34,843 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Job modify finished with results {'heat_outputs': [{u'output_value': u'default-domain:admin:f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'Fully Qualified Name of the VMI', u'output_key': u'fq_name'}, {u'output_value': {u'allowed_address_pair': []}, u'description': u'Virtual machine allowed address pairs.', u'output_key': u'allowed_address_pairs'}, {u'output_value': u'5b5ef6a3-7444-4443-8c6d-4c66aee1df27', u'description': u'Monitoring Target ID', u'output_key': u'monitoring_target_id'}, {u'output_value': [u'fa:16:3e:f7:60:7f'], u'description': u'Virtual machine interface mac address.', u'output_key': u'mac_address'}, {u'output_value': [[u'default-domain', u'admin', u'b62eefe0-0872-478d-adfe-1a606320f0e7']], u'description': u'Virtual network.', u'output_key': u'virtual_network'}, {u'output_value': u'f68d0924-ef20-4c1b-ac45-0e6b879af5e7', u'description': u'A unique id for the virtual machine interface.', u'output_key': u'id'}, {u'output_value': u'http://collector-agents-se.monitoringrefactordocker_default:7070/targets/5b5ef6a3-7444-4443-8c6d-4c66aee1df27', u'description': u'Monitoring Process Link', u'output_key': u'monitoring_link'}], 'orchestration_state': u'UPDATE_COMPLETE', 'error': None} (heat_stacks_worker.py - 103)
2018-04-09 04:50:34,883 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Job modify:heat_worker:port:343b0257-512e-40e3-b063-8cc13a4b61f4:2:biikl finished. (job_queue.py - 266)
2018-04-09 04:50:34,884 [1;37mINFO[0m heat_worker - port:343b0257-512e-40e3-b063-8cc13a4b61f4 - Trying to delete internal process state for resource port:343b0257-512e-40e3-b063-8cc13a4b61f4 (resources.py - 701)
2018-04-09 04:50:34,892 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Job modify:heat_worker:port:f84496b5-dc56-4727-87b1-aa06e2471737:2:fxjly finished. (job_queue.py - 266)
2018-04-09 04:50:34,893 [1;37mINFO[0m heat_worker - port:f84496b5-dc56-4727-87b1-aa06e2471737 - Trying to delete internal process state for resource port:f84496b5-dc56-4727-87b1-aa06e2471737 (resources.py - 701)
2018-04-09 04:50:52,936 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:50:52,937 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:50:52,937 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:51:22,951 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:51:22,952 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:51:22,953 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:51:52,966 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:51:52,966 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:51:52,967 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:52:22,985 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:52:22,986 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:52:22,986 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:52:53,001 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:52:53,002 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:52:53,003 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:53:23,010 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:53:23,010 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:53:23,011 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:53:53,024 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:53:53,025 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:53:53,025 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:54:23,030 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:54:23,032 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:54:23,032 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:54:53,045 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:54:53,046 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:54:53,047 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:55:23,058 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:55:23,059 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:55:23,059 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:55:53,073 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:55:53,074 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:55:53,074 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:56:23,085 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:56:23,086 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:56:23,086 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:56:53,098 [1;34mDEBUG[0m heat_worker - GetJob timeout. (etcd_worker.py - 227)
2018-04-09 04:56:53,098 [1;34mDEBUG[0m heat_worker - Waiting for a job. (etcd_worker.py - 218)
2018-04-09 04:56:53,099 [1;34mDEBUG[0m heat_worker - 8 job slots available (etcd_worker.py - 213)
2018-04-09 04:56:56,979 [1;31mERROR[0m heat_worker - Request to server http://etcd-server.monitoringrefactordocker_default:2379 failed: ProtocolError('Connection broken: IncompleteRead(0 bytes read)', IncompleteRead(0 bytes read)) (esi_etcd.py - 163)
2018-04-09 04:56:56,985 [1;37mINFO[0m heat_worker - Reconnection allowed, looking for another server. (esi_etcd.py - 165)
2018-04-09 04:56:56,986 [1;37mINFO[0m heat_worker - Selected new etcd server http://etcd-server:2379 (client.py - 718)
2018-04-09 04:56:57,030 [1;33mWARNING[0m heat_worker - Retrying (Retry(total=2, connect=None, read=None, redirect=0)) after connection broken by 'ProtocolError('Connection aborted.', error(111, 'ECONNREFUSED'))': /v2/keys/jobs/ready?waitIndex=1003&recursive=true&wait=true (connectionpool.py - 591)
2018-04-09 04:56:57,045 [1;33mWARNING[0m heat_worker - Retrying (Retry(total=1, connect=None, read=None, redirect=0)) after connection broken by 'ProtocolError('Connection aborted.', error(111, 'ECONNREFUSED'))': /v2/keys/jobs/ready?waitIndex=1003&recursive=true&wait=true (connectionpool.py - 591)
2018-04-09 04:56:57,077 [1;33mWARNING[0m heat_worker - Retrying (Retry(total=0, connect=None, read=None, redirect=0)) after connection broken by 'ProtocolError('Connection aborted.', error(111, 'ECONNREFUSED'))': /v2/keys/jobs/ready?waitIndex=1003&recursive=true&wait=true (connectionpool.py - 591)
2018-04-09 04:56:57,089 [1;31mERROR[0m heat_worker - Request to server http://etcd-server:2379 failed: MaxRetryError(u"HTTPConnectionPool(host=u'etcd-server', port=2379): Max retries exceeded with url: /v2/keys/jobs/ready?waitIndex=1003&recursive=true&wait=true (Caused by ProtocolError('Connection aborted.', error(111, 'ECONNREFUSED')))",) (esi_etcd.py - 163)
2018-04-09 04:56:57,093 [1;37mINFO[0m heat_worker - Reconnection allowed, looking for another server. (esi_etcd.py - 165)
2018-04-09 04:56:57,094 [1;31mERROR[0m heat_worker - Machines cache is empty, no machines to try. (client.py - 714)
2018-04-09 04:56:57,097 [1;33mWARNING[0m heat_worker - Recreating machine cache from local copy. (esi_etcd.py - 72)
2018-04-09 04:56:57,098 [1;37mINFO[0m heat_worker - Selected new etcd server http://etcd-server.monitoringrefactordocker_default:2379 (client.py - 718)
2018-04-09 04:56:57,099 [1;33mWARNING[0m heat_worker - Etcd connection problem: HTTPConnectionPool(host=u'etcd-server', port=2379): Max retries exceeded with url: /v2/keys/jobs/ready?waitIndex=1003&recursive=true&wait=true (Caused by ProtocolError('Connection aborted.', error(111, 'ECONNREFUSED'))).  (esi_etcd.py - 182)
2018-04-09 04:56:57,100 [1;37mINFO[0m heat_worker - Retrying in: 2.  (esi_etcd.py - 196)
