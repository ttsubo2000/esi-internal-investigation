root@client:/tools/rest-api-for-esi# python gohan-api-vpn-gateways.py 
### Create Ese Device ###
name:[QFX-NW02], id:[5314fffc-6c86-4410-a64b-5386286ac629]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:18.557808  04:59:18.779650  0.221842        POST     201    PENDING_CREATE
04:59:18.781082  04:59:18.941225  0.160143         GET     200    PENDING_CREATE
04:59:19.943132  04:59:20.065168  0.122036         GET     200    PENDING_CREATE
04:59:21.066205  04:59:21.191849  0.125644         GET     200    PENDING_CREATE
04:59:22.193107  04:59:22.306846  0.113739         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 3.749038

[localhost] local: gohan client ese_device show --output-format json 5314fffc-6c86-4410-a64b-5386286ac629
{
    "ese_device": {
        "description": "",
        "existing": "existing",
        "flavor": null,
        "hostname": "QFX-NW02",
        "id": "5314fffc-6c86-4410-a64b-5386286ac629",
        "location": null,
        "management_ip_address": "10.161.0.34",
        "name": "QFX-NW02",
        "password": "password",
        "public_ip_address": "10.161.0.34",
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "tor_agent_names": null,
        "tsn_names": null,
        "type": "tor",
        "username": "esi"
    }
}

##########################################
### checking heat-stack (ese_devices) ####
##########################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ese_devices/5314fffc-6c86-4410-a64b-5386286ac629
[localhost] local: heat stack-show ese_device_5314fffc-6c86-4410-a64b-5386286ac629
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                       |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                          |
| creation_time         | 2017-05-11T04:59:20Z                                                                                                                                        |
| description           | ESE Device (existing) template                                                                                                                              |
| disable_rollback      | True                                                                                                                                                        |
| id                    | 7bfcd176-a55d-4456-8883-4bccfcda5af4                                                                                                                        |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/ese_device_5314fffc-6c86-4410-a64b-5386286ac629/7bfcd176-a55d-4456-8883-4bccfcda5af4 (self) |
| notification_topics   | []                                                                                                                                                          |
| outputs               | [                                                                                                                                                           |
|                       |   {                                                                                                                                                         |
|                       |     "output_value": [                                                                                                                                       |
|                       |       "default-global-system-config",                                                                                                                       |
|                       |       "QFX-NW02"                                                                                                                                            |
|                       |     ],                                                                                                                                                      |
|                       |     "description": "The FQ name of the physical router.",                                                                                                   |
|                       |     "output_key": "fq_name"                                                                                                                                 |
|                       |   },                                                                                                                                                        |
|                       |   {                                                                                                                                                         |
|                       |     "output_value": "physical_router",                                                                                                                      |
|                       |     "description": "A unique id for the physical router.",                                                                                                  |
|                       |     "output_key": "id"                                                                                                                                      |
|                       |   },                                                                                                                                                        |
|                       |   {                                                                                                                                                         |
|                       |     "output_value": "dummy",                                                                                                                                |
|                       |     "description": "The name of the physical router.",                                                                                                      |
|                       |     "output_key": "name"                                                                                                                                    |
|                       |   }                                                                                                                                                         |
|                       | ]                                                                                                                                                           |
| parameters            | {                                                                                                                                                           |
|                       |   "hostname": "QFX-NW02",                                                                                                                                   |
|                       |   "OS::stack_id": "7bfcd176-a55d-4456-8883-4bccfcda5af4",                                                                                                   |
|                       |   "OS::stack_name": "ese_device_5314fffc-6c86-4410-a64b-5386286ac629",                                                                                      |
|                       |   "name": "QFX-NW02"                                                                                                                                        |
|                       | }                                                                                                                                                           |
| parent                | None                                                                                                                                                        |
| stack_name            | ese_device_5314fffc-6c86-4410-a64b-5386286ac629                                                                                                             |
| stack_owner           | admin                                                                                                                                                       |
| stack_status          | CREATE_COMPLETE                                                                                                                                             |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                         |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                            |
| template_description  | ESE Device (existing) template                                                                                                                              |
| timeout_mins          | 10                                                                                                                                                          |
| updated_time          | None                                                                                                                                                        |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show ese_device_5314fffc-6c86-4410-a64b-5386286ac629
description: 'ESE Device (existing) template

  '
heat_template_version: '2013-05-23'
outputs:
  fq_name:
    description: The FQ name of the physical router.
    value:
      get_attr: [physical_router, fq_name]
  id:
    description: A unique id for the physical router.
    value: {get_resource: physical_router}
  name:
    description: The name of the physical router.
    value:
      get_attr: [physical_router, name]
parameters:
  hostname: {description: Name of host (vrouter) to create router on, label: Hostname,
    type: string}
  name: {description: Name of the physical router that will be created., label: Physical
      Router Name, type: string}
resources:
  physical_router:
    properties:
      fq_name:
      - default-global-system-config
      - {get_param: hostname}
      resource_type: physical_router
    type: OS::Contrail::ExistingResource

### Create Ese Physical Port ###
name:[xe-0/0/3], id:[eec156b0-7317-48dd-b76c-019c0758e99d]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:25.353418  04:59:25.632974  0.279556        POST     201    PENDING_CREATE
04:59:25.633412  04:59:25.748220  0.114808         GET     200    PENDING_CREATE
04:59:26.748643  04:59:26.857696  0.109053         GET     200    PENDING_CREATE
04:59:27.858944  04:59:27.986705  0.127761         GET     200    PENDING_CREATE
04:59:28.987231  04:59:29.091758  0.104527         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 3.73834

[localhost] local: gohan client ese_physical_port show --output-format json eec156b0-7317-48dd-b76c-019c0758e99d
{
    "ese_physical_port": {
        "connected_port_id": "",
        "connected_port_owner": "mx_downlink",
        "description": "",
        "ese_device_id": "5314fffc-6c86-4410-a64b-5386286ac629",
        "existing": "new",
        "id": "eec156b0-7317-48dd-b76c-019c0758e99d",
        "name": "xe-0/0/3",
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

#################################################
### checking heat-stack (ese_physical_ports) ####
#################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ese_physical_ports/eec156b0-7317-48dd-b76c-019c0758e99d
[localhost] local: heat stack-show ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                              |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                                 |
| creation_time         | 2017-05-11T04:59:26Z                                                                                                                                               |
| description           | Physical port template                                                                                                                                             |
| disable_rollback      | True                                                                                                                                                               |
| id                    | 4443a1c7-2cb6-424e-ae08-d952b092ef2b                                                                                                                               |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d/4443a1c7-2cb6-424e-ae08-d952b092ef2b (self) |
| notification_topics   | []                                                                                                                                                                 |
| outputs               | [                                                                                                                                                                  |
|                       |   {                                                                                                                                                                |
|                       |     "output_value": "dddddddd-dddd-dddd-dddd-dddddddddddd",                                                                                                        |
|                       |     "description": "A unique id for the physical interface",                                                                                                       |
|                       |     "output_key": "id"                                                                                                                                             |
|                       |   },                                                                                                                                                               |
|                       |   {                                                                                                                                                                |
|                       |     "output_value": null,                                                                                                                                          |
|                       |     "output_error": "'ContrailPhysicalInterface' object has no attribute 'pi_uuid'",                                                                               |
|                       |     "description": "The name of the physical interface.",                                                                                                          |
|                       |     "output_key": "name"                                                                                                                                           |
|                       |   }                                                                                                                                                                |
|                       | ]                                                                                                                                                                  |
| parameters            | {                                                                                                                                                                  |
|                       |   "physical_port_name": "xe-0/0/3",                                                                                                                                |
|                       |   "OS::stack_id": "4443a1c7-2cb6-424e-ae08-d952b092ef2b",                                                                                                          |
|                       |   "OS::stack_name": "ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d",                                                                                      |
|                       |   "physical_device": "physical_router"                                                                                                                             |
|                       | }                                                                                                                                                                  |
| parent                | None                                                                                                                                                               |
| stack_name            | ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d                                                                                                             |
| stack_owner           | admin                                                                                                                                                              |
| stack_status          | CREATE_COMPLETE                                                                                                                                                    |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                                |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                                   |
| template_description  | Physical port template                                                                                                                                             |
| timeout_mins          | 10                                                                                                                                                                 |
| updated_time          | None                                                                                                                                                               |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d
description: 'Physical port template

  '
heat_template_version: '2013-05-23'
outputs:
  id:
    description: A unique id for the physical interface
    value: {get_resource: physical_interface}
  name:
    description: The name of the physical interface.
    value:
      get_attr: [physical_interface, name]
parameters:
  physical_device: {description: Id of the physical device on which physical port
      will be created., label: Physical Device Id, type: string}
  physical_port_name: {description: Name of the physical port., label: Physical Interface
      Name, type: string}
resources:
  physical_interface:
    properties:
      name: {get_param: physical_port_name}
      physical_router: {get_param: physical_device}
    type: OS::Contrail::PhysicalInterface

### Create Ese Physical Port ###
name:[xe-0/0/4], id:[176ec475-e9e8-4605-8b41-802fbc6220c1]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:31.561184  04:59:31.745016  0.183832        POST     201    PENDING_CREATE
04:59:31.746313  04:59:31.875645  0.129332         GET     200    PENDING_CREATE
04:59:32.877070  04:59:32.968956  0.091886         GET     200    PENDING_CREATE
04:59:33.970394  04:59:34.089531  0.119137         GET     200    PENDING_CREATE
04:59:35.090745  04:59:35.180489  0.089744         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 3.619305

[localhost] local: gohan client ese_physical_port show --output-format json 176ec475-e9e8-4605-8b41-802fbc6220c1
{
    "ese_physical_port": {
        "connected_port_id": "",
        "connected_port_owner": "mx_downlink",
        "description": "",
        "ese_device_id": "5314fffc-6c86-4410-a64b-5386286ac629",
        "existing": "new",
        "id": "176ec475-e9e8-4605-8b41-802fbc6220c1",
        "name": "xe-0/0/4",
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

#################################################
### checking heat-stack (ese_physical_ports) ####
#################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ese_physical_ports/176ec475-e9e8-4605-8b41-802fbc6220c1
[localhost] local: heat stack-show ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                              |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                                 |
| creation_time         | 2017-05-11T04:59:32Z                                                                                                                                               |
| description           | Physical port template                                                                                                                                             |
| disable_rollback      | True                                                                                                                                                               |
| id                    | 724e3e47-e401-4f3d-9fe1-a6f174c34e5d                                                                                                                               |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1/724e3e47-e401-4f3d-9fe1-a6f174c34e5d (self) |
| notification_topics   | []                                                                                                                                                                 |
| outputs               | [                                                                                                                                                                  |
|                       |   {                                                                                                                                                                |
|                       |     "output_value": "dddddddd-dddd-dddd-dddd-dddddddddddd",                                                                                                        |
|                       |     "description": "A unique id for the physical interface",                                                                                                       |
|                       |     "output_key": "id"                                                                                                                                             |
|                       |   },                                                                                                                                                               |
|                       |   {                                                                                                                                                                |
|                       |     "output_value": null,                                                                                                                                          |
|                       |     "output_error": "'ContrailPhysicalInterface' object has no attribute 'pi_uuid'",                                                                               |
|                       |     "description": "The name of the physical interface.",                                                                                                          |
|                       |     "output_key": "name"                                                                                                                                           |
|                       |   }                                                                                                                                                                |
|                       | ]                                                                                                                                                                  |
| parameters            | {                                                                                                                                                                  |
|                       |   "physical_port_name": "xe-0/0/4",                                                                                                                                |
|                       |   "OS::stack_id": "724e3e47-e401-4f3d-9fe1-a6f174c34e5d",                                                                                                          |
|                       |   "OS::stack_name": "ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1",                                                                                      |
|                       |   "physical_device": "physical_router"                                                                                                                             |
|                       | }                                                                                                                                                                  |
| parent                | None                                                                                                                                                               |
| stack_name            | ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1                                                                                                             |
| stack_owner           | admin                                                                                                                                                              |
| stack_status          | CREATE_COMPLETE                                                                                                                                                    |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                                |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                                   |
| template_description  | Physical port template                                                                                                                                             |
| timeout_mins          | 10                                                                                                                                                                 |
| updated_time          | None                                                                                                                                                               |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1
description: 'Physical port template

  '
heat_template_version: '2013-05-23'
outputs:
  id:
    description: A unique id for the physical interface
    value: {get_resource: physical_interface}
  name:
    description: The name of the physical interface.
    value:
      get_attr: [physical_interface, name]
parameters:
  physical_device: {description: Id of the physical device on which physical port
      will be created., label: Physical Device Id, type: string}
  physical_port_name: {description: Name of the physical port., label: Physical Interface
      Name, type: string}
resources:
  physical_interface:
    properties:
      name: {get_param: physical_port_name}
      physical_router: {get_param: physical_device}
    type: OS::Contrail::PhysicalInterface

### Create Edge Router ###
name:[vMX-router-02], id:[792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:37.844898  04:59:37.946380  0.101482        POST     201    PENDING_CREATE
04:59:37.947023  04:59:38.953323  1.006300         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.108425

[localhost] local: gohan client edge_router show --output-format json 792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198
{
    "edge_router": {
        "autonomous_system": "65101",
        "description": "MX80 #2",
        "id": "792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198",
        "ip": "10.79.5.185",
        "login": "esi",
        "name": "vMX-router-02",
        "password": "esiesi0000",
        "ssh_port": 830,
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Edge Router ###
name:[vMX-router-01], id:[3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:39.451567  04:59:39.547329  0.095762        POST     201    PENDING_CREATE
04:59:39.547990  04:59:39.659389  0.111399         GET     200    PENDING_CREATE
04:59:40.660619  04:59:40.755233  0.094614         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.303666

[localhost] local: gohan client edge_router show --output-format json 3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e
{
    "edge_router": {
        "autonomous_system": "65101",
        "description": "MX80 #1",
        "id": "3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e",
        "ip": "10.79.5.184",
        "login": "esi",
        "name": "vMX-router-01",
        "password": "esiesi0000",
        "ssh_port": 830,
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Ha Router ###
name:[sample-ha-router], id:[f01ed0a6-7094-4e54-b14b-94657fff1efb]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:41.230029  04:59:41.415667  0.185638        POST     201    PENDING_CREATE
04:59:41.416051  04:59:41.514939  0.098888         GET     200    PENDING_CREATE
04:59:42.516168  04:59:42.613300  0.097132         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.383271

[localhost] local: gohan client ha_router show --output-format json f01ed0a6-7094-4e54-b14b-94657fff1efb
{
    "ha_router": {
        "available_gateways": 500,
        "description": "sample_ha_router",
        "id": "f01ed0a6-7094-4e54-b14b-94657fff1efb",
        "maximum_gateways": 500,
        "name": "sample-ha-router",
        "primary_router_id": "792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198",
        "secondary_router_id": "3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Er Physical Interface ###
name:[ge-0/0/1], id:[6e8f473f-47ec-4b54-8f0f-d459d440393b]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:43.218944  04:59:43.403728  0.184784        POST     201    PENDING_CREATE
04:59:43.404099  04:59:43.549748  0.145649         GET     200    PENDING_CREATE
04:59:44.552547  04:59:44.668387  0.115840         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.449443

[localhost] local: gohan client er_physical_interface show --output-format json 6e8f473f-47ec-4b54-8f0f-d459d440393b
{
    "er_physical_interface": {
        "connected_ese_port_id": null,
        "description": "",
        "device_id": "792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198",
        "id": "6e8f473f-47ec-4b54-8f0f-d459d440393b",
        "name": "ge-0/0/1",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Er Physical Interface ###
name:[ae0], id:[8ff57ce4-55f9-40d4-82ed-1f00c9051678]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:45.251159  04:59:45.529073  0.277914        POST     201    PENDING_CREATE
04:59:45.533715  04:59:45.668678  0.134963         GET     200    PENDING_CREATE
04:59:46.669909  04:59:46.769709  0.099800         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.51855

[localhost] local: gohan client er_physical_interface show --output-format json 8ff57ce4-55f9-40d4-82ed-1f00c9051678
{
    "er_physical_interface": {
        "connected_ese_port_id": "eec156b0-7317-48dd-b76c-019c0758e99d",
        "description": "",
        "device_id": "792c7a6d-19b5-4d6f-b9f6-1e5b1eb45198",
        "id": "8ff57ce4-55f9-40d4-82ed-1f00c9051678",
        "name": "ae0",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Er Physical Interface ###
name:[ae0], id:[6b160a8d-fdad-4fe7-aaed-3ff5f729d6c8]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:47.306521  04:59:47.510303  0.203782        POST     201    PENDING_CREATE
04:59:47.511155  04:59:47.618727  0.107572         GET     200    PENDING_CREATE
04:59:48.620043  04:59:48.697041  0.076998         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.39052

[localhost] local: gohan client er_physical_interface show --output-format json 6b160a8d-fdad-4fe7-aaed-3ff5f729d6c8
{
    "er_physical_interface": {
        "connected_ese_port_id": "176ec475-e9e8-4605-8b41-802fbc6220c1",
        "description": "",
        "device_id": "3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e",
        "id": "6b160a8d-fdad-4fe7-aaed-3ff5f729d6c8",
        "name": "ae0",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Er Physical Interface ###
name:[ge-0/0/1], id:[f87c6efe-f590-4c29-8fc9-2f914e1eb362]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:49.202552  04:59:49.343278  0.140726        POST     201    PENDING_CREATE
04:59:49.343579  04:59:49.446591  0.103012         GET     200    PENDING_CREATE
04:59:50.447699  04:59:50.542634  0.094935         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.340082

[localhost] local: gohan client er_physical_interface show --output-format json f87c6efe-f590-4c29-8fc9-2f914e1eb362
{
    "er_physical_interface": {
        "connected_ese_port_id": null,
        "description": "",
        "device_id": "3ca3a59a-4f92-4a8a-9ec1-1c55a97c794e",
        "id": "f87c6efe-f590-4c29-8fc9-2f914e1eb362",
        "name": "ge-0/0/1",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

### Create Ha Interface ###
name:[sample-ha-router-uplink], id:[5e552b8f-cd5a-454c-a224-33f7da0afa24]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:51.143017  04:59:51.461403  0.318386        POST     201    PENDING_CREATE
04:59:51.461923  04:59:51.601383  0.139460         GET     200    PENDING_CREATE
04:59:52.602692  04:59:52.715288  0.112596         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.572271

[localhost] local: gohan client ha_interface show --output-format json 5e552b8f-cd5a-454c-a224-33f7da0afa24
{
    "ha_interface": {
        "admin_state_up": true,
        "available_be_bandwidth": 0,
        "available_ga_bandwidth": 0,
        "description": "",
        "gateway_instances_count": 0,
        "ha_router_id": "f01ed0a6-7094-4e54-b14b-94657fff1efb",
        "id": "5e552b8f-cd5a-454c-a224-33f7da0afa24",
        "link_type": "uplink",
        "maximum_be_bandwidth": 0,
        "maximum_ga_bandwidth": 0,
        "name": "sample-ha-router-uplink",
        "primary_interface_id": "6e8f473f-47ec-4b54-8f0f-d459d440393b",
        "restricted_vlans": "",
        "secondary_interface_id": "f87c6efe-f590-4c29-8fc9-2f914e1eb362",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vlan_ids_available": 4093,
        "vlan_pool_state": "gAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE="
    }
}

### Create Ha Interface ###
name:[sample-ha-router-downlink], id:[a3a62a37-5657-4822-98e0-991ab63f0e96]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:53.594975  04:59:54.388508  0.793533        POST     201    PENDING_CREATE
04:59:54.388931  04:59:54.525844  0.136913         GET     200    PENDING_CREATE
04:59:55.527059  04:59:55.623701  0.096642         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 2.028726

[localhost] local: gohan client ha_interface show --output-format json a3a62a37-5657-4822-98e0-991ab63f0e96
{
    "ha_interface": {
        "admin_state_up": true,
        "available_be_bandwidth": 500,
        "available_ga_bandwidth": 500,
        "description": "",
        "gateway_instances_count": 0,
        "ha_router_id": "f01ed0a6-7094-4e54-b14b-94657fff1efb",
        "id": "a3a62a37-5657-4822-98e0-991ab63f0e96",
        "link_type": "downlink",
        "maximum_be_bandwidth": 500,
        "maximum_ga_bandwidth": 500,
        "name": "sample-ha-router-downlink",
        "primary_interface_id": "8ff57ce4-55f9-40d4-82ed-1f00c9051678",
        "restricted_vlans": "0-1024,4094",
        "secondary_interface_id": "6b160a8d-fdad-4fe7-aaed-3ff5f729d6c8",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vlan_ids_available": 3069,
        "vlan_pool_state": "//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAM="
    }
}

### Create Vpn Service ###
name:[sample-vpn-service], id:[72b05fe5-88c6-4888-a6fb-feb793fffae8]
-----------------------------------------------------------------
http_request     http_response    response_time   method   code
-----------------------------------------------------------------
04:59:56.234487  04:59:56.365124  0.130637        POST     201
04:59:56.365677  04:59:56.497773  0.132096         GET     200
-----------------------------------------------------------------
Turn Around Time : 0.263286

[localhost] local: gohan client vpn_service show --output-format json 72b05fe5-88c6-4888-a6fb-feb793fffae8
{
    "vpn_service": {
        "be_forwarding_class": "FC-VPN-BE",
        "default_static_routes_per_gateway": 32,
        "description": "",
        "downlink_interfaces": [
            "a3a62a37-5657-4822-98e0-991ab63f0e96"
        ],
        "ga_forwarding_class": "FC-VPN-GA",
        "id": "72b05fe5-88c6-4888-a6fb-feb793fffae8",
        "name": "sample-vpn-service",
        "neighbour_prefix": "BGP-VIRTUAL-ROUTER-PEERS",
        "primary_downlink_vrrp_config_group": "VPNGW1-VRRP",
        "primary_ebgp_config_group": "VPNGW1-RI-EBGP",
        "primary_ibgp_config_group": "VPNGW1-RI-IBGP",
        "secondary_downlink_vrrp_config_group": "VPNGW2-VRRP",
        "secondary_ebgp_config_group": "VPNGW2-RI-EBGP",
        "secondary_ibgp_config_group": "VPNGW2-RI-IBGP",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "uplink_interfaces": [
            "5e552b8f-cd5a-454c-a224-33f7da0afa24"
        ],
        "vrf_config": null,
        "zone": "jp1-zone1"
    }
}

### Create Vpn Qos Option ###
name:[10Mbps-Guaranteed], id:[4f59680b-52b6-41da-b15a-09946c155efd]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
04:59:57.108431  04:59:57.301113  0.192682        POST     201    PENDING_CREATE
04:59:57.301616  04:59:57.424147  0.122531         GET     200    PENDING_CREATE
04:59:58.425393  04:59:58.522978  0.097585         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 1.414547

[localhost] local: gohan client qos_option show --output-format json 4f59680b-52b6-41da-b15a-09946c155efd
{
    "qos_option": {
        "aws_service_id": null,
        "bandwidth": "10",
        "charge_type": null,
        "description": "",
        "ha_router_id": "f01ed0a6-7094-4e54-b14b-94657fff1efb",
        "id": "4f59680b-52b6-41da-b15a-09946c155efd",
        "incoming_policer_config": "action { loss-priority high then discard; } single-rate { color-blind; committed-information-rate 10m; committed-burst-size 187500000; excess-burst-size 187500000; }",
        "incoming_policer_name": "10M-GA-UP-VPN",
        "interdc_service_id": null,
        "internet_service_id": null,
        "name": "10Mbps-Guaranteed",
        "outgoing_policer_config": "if-exceeding { bandwidth-limit 10m; burst-size-limit 187500000; } then discard;",
        "outgoing_policer_name": "10M-GA-DOWN-VPN",
        "qos_type": "guarantee",
        "service_type": "vpn",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vpn_service_id": "72b05fe5-88c6-4888-a6fb-feb793fffae8"
    }
}

### Create Vpn Gateway ###
name:[sample-vpn-gateway], id:[4fab887d-8f73-40e6-b2d8-2426255231bf]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:00:09.102318  05:00:09.400160  0.297842        POST     201    PENDING_CREATE
05:00:09.400491  05:00:09.522281  0.121790         GET     200    PENDING_CREATE
05:00:10.523426  05:00:10.633369  0.109943         GET     200    PENDING_CREATE
05:00:11.634420  05:00:11.767369  0.132949         GET     200    PENDING_CREATE
05:00:12.768647  05:00:12.863298  0.094651         GET     200    PENDING_CREATE
05:00:13.864536  05:00:13.952313  0.087777         GET     200    PENDING_CREATE
05:00:14.953568  05:00:15.053609  0.100041         GET     200    PENDING_CREATE
05:00:16.054899  05:00:16.152881  0.097982         GET     200    PENDING_CREATE
05:00:17.154177  05:00:17.252300  0.098123         GET     200    PENDING_CREATE
05:00:18.252646  05:00:18.341991  0.089345         GET     200    PENDING_CREATE
05:00:19.343244  05:00:19.443573  0.100329         GET     200    PENDING_CREATE
05:00:20.445101  05:00:20.522641  0.077540         GET     200    PENDING_CREATE
05:00:21.523318  05:00:21.601180  0.077862         GET     200    PENDING_CREATE
05:00:22.602534  05:00:22.678135  0.075601         GET     200    PENDING_CREATE
05:00:23.679487  05:00:23.758826  0.079339         GET     200    PENDING_CREATE
05:00:24.760084  05:00:24.872090  0.112006         GET     200    PENDING_CREATE
05:00:25.872677  05:00:25.964063  0.091386         GET     200    PENDING_CREATE
05:00:26.964606  05:00:27.048711  0.084105         GET     200    PENDING_CREATE
05:00:28.049903  05:00:28.124925  0.075022         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 19.022607

[localhost] local: gohan client vpn_gateway show --output-format json 4fab887d-8f73-40e6-b2d8-2426255231bf
{
    "vpn_gateway": {
        "connected_vpn_interface": "",
        "description": "this resource is vpn-gateway",
        "downlink_interface_id": "a3a62a37-5657-4822-98e0-991ab63f0e96",
        "downlink_vlan_id": "1025",
        "id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
        "local_as_number": "65101",
        "maximum_static_routes": 32,
        "name": "sample-vpn-gateway",
        "primary_logical_downlink_interface_name": "ae0.1025",
        "primary_logical_uplink_interface_name": "ge-0/0/1.122",
        "qos_option_id": "4f59680b-52b6-41da-b15a-09946c155efd",
        "secondary_logical_downlink_interface_name": "ae0.1025",
        "secondary_logical_uplink_interface_name": "ge-0/0/1.122",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "uplink_interface_id": "5e552b8f-cd5a-454c-a224-33f7da0afa24",
        "uplink_vlan_id": "122",
        "vpn_service_id": "72b05fe5-88c6-4888-a6fb-feb793fffae8",
        "vrf_name": "vrf_gw_sample-ha-router-downlink_1025"
    }
}

[localhost] local: gohan client resource_mapping list --output-format json
{
    "resource_mappings": [
        {
            "created": 1.494478827e+09,
            "deleted": null,
            "id": "7806e79c-7403-462f-abd4-57d4f4f20f54",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        }
    ]
}

###########################################
### checking heat-stack (vpn_gateways) ####
###########################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/vpn_gateways/4fab887d-8f73-40e6-b2d8-2426255231bf
[localhost] local: heat stack-show vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                        |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                           |
| creation_time         | 2017-05-11T05:00:10Z                                                                                                                                         |
| description           | VPN Gateway                                                                                                                                                  |
| disable_rollback      | True                                                                                                                                                         |
| id                    | 8b8fd087-b322-41fb-8751-63042be0c8f7                                                                                                                         |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf/8b8fd087-b322-41fb-8751-63042be0c8f7 (self) |
| notification_topics   | []                                                                                                                                                           |
| outputs               | []                                                                                                                                                           |
| parameters            | {                                                                                                                                                            |
|                       |   "primary_device_logical_uplink_interface": "ge-0/0/1.122",                                                                                                 |
|                       |   "primary_device_logical_downlink_interface": "ae0.1025",                                                                                                   |
|                       |   "primary_device_password": "esiesi0000",                                                                                                                   |
|                       |   "output_filter_name": "FILTER_10M-GA-DOWN-VPN",                                                                                                            |
|                       |   "primary_device_ip": "10.79.5.185",                                                                                                                        |
|                       |   "secondary_device_physical_downlink_interface": "ae0",                                                                                                     |
|                       |   "secondary_device_username": "esi",                                                                                                                        |
|                       |   "primary_device_physical_uplink_interface": "ge-0/0/1",                                                                                                    |
|                       |   "secondary_device_logical_uplink_interface": "ge-0/0/1.122",                                                                                               |
|                       |   "downlink_vlan": "1025",                                                                                                                                   |
|                       |   "OS::stack_name": "vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf",                                                                                      |
|                       |   "secondary_device_logical_downlink_interface": "ae0.1025",                                                                                                 |
|                       |   "input_filter_name": "FILTER_10M-GA-UP-VPN",                                                                                                               |
|                       |   "uplink_vlan": "122",                                                                                                                                      |
|                       |   "OS::stack_id": "8b8fd087-b322-41fb-8751-63042be0c8f7",                                                                                                    |
|                       |   "secondary_device_port": "830",                                                                                                                            |
|                       |   "primary_downlink_vrrp_config_group": "VPNGW1-VRRP",                                                                                                       |
|                       |   "secondary_device_password": "esiesi0000",                                                                                                                 |
|                       |   "vrf_name": "vrf_gw_sample-ha-router-downlink_1025",                                                                                                       |
|                       |   "primary_device_username": "esi",                                                                                                                          |
|                       |   "primary_device_physical_downlink_interface": "ae0",                                                                                                       |
|                       |   "secondary_downlink_vrrp_config_group": "VPNGW2-VRRP",                                                                                                     |
|                       |   "primary_device_port": "830",                                                                                                                              |
|                       |   "secondary_device_physical_uplink_interface": "ge-0/0/1",                                                                                                  |
|                       |   "secondary_device_ip": "10.79.5.184"                                                                                                                       |
|                       | }                                                                                                                                                            |
| parent                | None                                                                                                                                                         |
| stack_name            | vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf                                                                                                             |
| stack_owner           | admin                                                                                                                                                        |
| stack_status          | CREATE_COMPLETE                                                                                                                                              |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                          |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                             |
| template_description  | VPN Gateway                                                                                                                                                  |
| timeout_mins          | 60                                                                                                                                                           |
| updated_time          | None                                                                                                                                                         |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf
description: 'VPN Gateway

  '
heat_template_version: '2013-05-23'
parameters:
  downlink_vlan: {description: vlan tag used by logical downlink interface, label: VLAN
      ID, type: string}
  input_filter_name: {description: Name for policer used for input, label: Input filter
      name, type: string}
  output_filter_name: {description: Name for policer used for output, label: Output
      filter name, type: string}
  primary_device_ip: {description: Ip address that will be used to establish ssh connection
      to the Primary Device., label: Ip address of the device., type: string}
  primary_device_logical_downlink_interface: {description: Name of the created logical
      downlink interface on the Primary device, label: Logical Interface name, type: string}
  primary_device_logical_uplink_interface: {description: Name of the created logical
      uplink interface on the Primary device, label: Logical Interface name, type: string}
  primary_device_password: {description: Password of the user which will be used to
      log onto the Primary Device., label: Users password., type: string}
  primary_device_physical_downlink_interface: {description: Physical port on the Primary
      device on which the logical downlink port will be configured, label: Underlying
      physical interface, type: string}
  primary_device_physical_uplink_interface: {description: Physical port on the Primary
      device on which the logical uplink port will be configured, label: Underlying
      physical interface, type: string}
  primary_device_port: {description: Port that will be used to establish ssh connection
      to the Primary Device., label: Port of the ssh connection., type: number}
  primary_device_username: {description: Name of the user which will be used to log
      onto the Primary Device., label: User name to log on to device., type: string}
  primary_downlink_vrrp_config_group: {description: Name for apply group to use for
      downlink interface for VRRP, label: Apply group name, type: string}
  secondary_device_ip: {description: Ip address that will be used to establish ssh
      connection to the Secondary Device., label: Ip address of the device., type: string}
  secondary_device_logical_downlink_interface: {description: Name of the created logical
      downlink interface on the Secondary device, label: Logical Interface name, type: string}
  secondary_device_logical_uplink_interface: {description: Name of the created logical
      uplink interface on the Secondary device, label: Logical Interface name, type: string}
  secondary_device_password: {description: Password of the user which will be used
      to log onto the Secondary Device., label: Users password., type: string}
  secondary_device_physical_downlink_interface: {description: Physical port on the
      Secondary device on which the logical downlink port will be configured, label: Underlying
      physical interface, type: string}
  secondary_device_physical_uplink_interface: {description: Physical port on the Secondary
      device on which the logical uplink port will be configured, label: Underlying
      physical interface, type: string}
  secondary_device_port: {description: Port that will be used to establish ssh connection
      to the Secondary Device., label: Port of the ssh connection., type: number}
  secondary_device_username: {description: Name of the user which will be used to
      log onto the Secondary Device., label: User name to log on to device., type: string}
  secondary_downlink_vrrp_config_group: {description: Name for apply group to use
      for downlink interface for VRRP, label: Apply group name, type: string}
  uplink_vlan: {description: vlan tag used by logical uplink interface, label: VLAN
      ID, type: string}
  vrf_name: {description: Name for VRF used by logical interfaces, label: VRF name,
    type: string}
resources:
  netconf_configure_primary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: primary_downlink_vrrp_config_group}
              $INPUT_FILTER: {get_param: input_filter_name}
              $OUTPUT_FILTER: {get_param: output_filter_name}
              $VLAN: {get_param: downlink_vlan}
            template: "apply-groups $APPLY_GROUP\nvlan-id $VLAN;\ndescription vpn_gw;\n\
              family inet {\n    filter {\n        input $INPUT_FILTER;\n        output\
              \ $OUTPUT_FILTER;\n    }\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_downlink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan}
          tag: unit
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LIFD: {get_param: primary_device_logical_downlink_interface}
              $LIFU: {get_param: primary_device_logical_uplink_interface}
            template: 'instance-type virtual-router;

              interface $LIFD;

              interface $LIFU;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $VLAN: {get_param: uplink_vlan}
            template: 'vlan-id $VLAN;

              description CloudGW_vpn;

              '
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_uplink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
      device_ip: {get_param: primary_device_ip}
      lock_timeout: 3000
      on_update: merge
      password: {get_param: primary_device_password}
      port: {get_param: primary_device_port}
      username: {get_param: primary_device_username}
    type: OS::Contrail::NetconfNamedConfigs
  netconf_configure_secondary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: secondary_downlink_vrrp_config_group}
              $INPUT_FILTER: {get_param: input_filter_name}
              $OUTPUT_FILTER: {get_param: output_filter_name}
              $VLAN: {get_param: downlink_vlan}
            template: "apply-groups $APPLY_GROUP\nvlan-id $VLAN;\ndescription vpn_gw;\n\
              family inet {\n    filter {\n        input $INPUT_FILTER;\n        output\
              \ $OUTPUT_FILTER;\n    }\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_downlink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan}
          tag: unit
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LIFD: {get_param: secondary_device_logical_downlink_interface}
              $LIFU: {get_param: secondary_device_logical_uplink_interface}
            template: 'instance-type virtual-router;

              interface $LIFD;

              interface $LIFU;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $VLAN: {get_param: uplink_vlan}
            template: 'vlan-id $VLAN;

              description CloudGW_vpn;

              '
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_uplink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
      device_ip: {get_param: secondary_device_ip}
      lock_timeout: 3000
      on_update: merge
      password: {get_param: secondary_device_password}
      port: {get_param: secondary_device_port}
      username: {get_param: secondary_device_username}
    type: OS::Contrail::NetconfNamedConfigs

### Create Vpn Interface ###
name:[sample-vpn-interface], id:[0bea303d-b6eb-4edc-83ef-e32f915d3047]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:00:41.059223  05:00:41.249318  0.190095        POST     201    PENDING_CREATE
05:00:41.249649  05:00:41.392255  0.142606         GET     200    PENDING_CREATE
05:00:42.392819  05:00:42.523421  0.130602         GET     200    PENDING_CREATE
05:00:43.524634  05:00:43.639416  0.114782         GET     200    PENDING_CREATE
05:00:44.640620  05:00:44.736233  0.095613         GET     200    PENDING_CREATE
05:00:45.736646  05:00:45.872074  0.135428         GET     200    PENDING_CREATE
05:00:46.881010  05:00:46.969413  0.088403         GET     200    PENDING_CREATE
05:00:47.970638  05:00:48.052063  0.081425         GET     200    PENDING_CREATE
05:00:49.052604  05:00:49.138198  0.085594         GET     200    PENDING_CREATE
05:00:50.139454  05:00:50.244934  0.105480         GET     200    PENDING_CREATE
05:00:51.245964  05:00:51.336998  0.091034         GET     200    PENDING_CREATE
05:00:52.337452  05:00:52.450686  0.113234         GET     200    PENDING_CREATE
05:00:53.452282  05:00:53.535127  0.082845         GET     200    PENDING_CREATE
05:00:54.536290  05:00:54.643529  0.107239         GET     200    PENDING_CREATE
05:00:55.644615  05:00:55.751903  0.107288         GET     200    PENDING_CREATE
05:00:56.752632  05:00:56.859855  0.107223         GET     200    PENDING_CREATE
05:00:57.861062  05:00:57.982885  0.121823         GET     200    PENDING_CREATE
05:00:58.984090  05:00:59.064434  0.080344         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 18.005211

[localhost] local: gohan client vpn_interface show --output-format json 0bea303d-b6eb-4edc-83ef-e32f915d3047
{
    "vpn_interface": {
        "bgp_md5": "test",
        "bgp_remote_as": "9598",
        "description": "Sample Vpn-interface",
        "id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
        "name": "sample-vpn-interface",
        "primary": {
            "bgp_peer_ip": "192.168.8.1",
            "bgp_router_id": "192.168.8.2",
            "ip_address": "192.168.8.2/30"
        },
        "secondary": {
            "bgp_peer_ip": "192.168.8.5",
            "bgp_router_id": "192.168.8.6",
            "ip_address": "192.168.8.6/30"
        },
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vpn_gw_id": "4fab887d-8f73-40e6-b2d8-2426255231bf"
    }
}

[localhost] local: gohan client vpn_gateway show --output-format json 4fab887d-8f73-40e6-b2d8-2426255231bf
{
    "vpn_gateway": {
        "connected_vpn_interface": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
        "description": "this resource is vpn-gateway",
        "downlink_interface_id": "a3a62a37-5657-4822-98e0-991ab63f0e96",
        "downlink_vlan_id": "1025",
        "id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
        "local_as_number": "65101",
        "maximum_static_routes": 32,
        "name": "sample-vpn-gateway",
        "primary_logical_downlink_interface_name": "ae0.1025",
        "primary_logical_uplink_interface_name": "ge-0/0/1.122",
        "qos_option_id": "4f59680b-52b6-41da-b15a-09946c155efd",
        "secondary_logical_downlink_interface_name": "ae0.1025",
        "secondary_logical_uplink_interface_name": "ge-0/0/1.122",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "uplink_interface_id": "5e552b8f-cd5a-454c-a224-33f7da0afa24",
        "uplink_vlan_id": "122",
        "vpn_service_id": "72b05fe5-88c6-4888-a6fb-feb793fffae8",
        "vrf_name": "vrf_gw_sample-ha-router-downlink_1025"
    }
}

[localhost] local: gohan client resource_mapping list --output-format json
{
    "resource_mappings": [
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "1d5dcf8f-40f5-4780-8023-63bc1dd771ac",
            "mapped_id": "10.79.5.185-ge-0/0/1.122",
            "relation": "primary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478864e+09,
            "deleted": null,
            "id": "2f46f2b3-81f2-45d7-9f66-e64d131bb20b",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "4f69c6a1-e11b-4fae-bd0b-babe7df48380",
            "mapped_id": "10.79.5.184-ge-0/0/1.122",
            "relation": "secondary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478827e+09,
            "deleted": 1.494478858e+09,
            "id": "7806e79c-7403-462f-abd4-57d4f4f20f54",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        }
    ]
}

#############################################
### checking heat-stack (vpn_interfaces) ####
#############################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/vpn_interfaces/0bea303d-b6eb-4edc-83ef-e32f915d3047
[localhost] local: heat stack-show vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                          |
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                             |
| creation_time         | 2017-05-11T05:00:42Z                                                                                                                                           |
| description           | Inet Address                                                                                                                                                   |
| disable_rollback      | True                                                                                                                                                           |
| id                    | 8d6c9985-ee1d-4fe5-9b4f-963a5758a76a                                                                                                                           |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047/8d6c9985-ee1d-4fe5-9b4f-963a5758a76a (self) |
| notification_topics   | []                                                                                                                                                             |
| outputs               | []                                                                                                                                                             |
| parameters            | {                                                                                                                                                              |
|                       |   "secondary_router_id": "192.168.8.6",                                                                                                                        |
|                       |   "secondary_device_physical_interface": "ge-0/0/1",                                                                                                           |
|                       |   "primary_peer_ip": "192.168.8.1",                                                                                                                            |
|                       |   "primary_device_password": "esiesi0000",                                                                                                                     |
|                       |   "bgp_group_name": "CloudGW1",                                                                                                                                |
|                       |   "remote_as": "9598",                                                                                                                                         |
|                       |   "primary_device_ip": "10.79.5.185",                                                                                                                          |
|                       |   "secondary_ebgp_config_group": "VPNGW2-RI-EBGP",                                                                                                             |
|                       |   "secondary_device_username": "esi",                                                                                                                          |
|                       |   "OS::stack_name": "vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047",                                                                                      |
|                       |   "local_as": "65101",                                                                                                                                         |
|                       |   "primary_device_physical_interface": "ge-0/0/1",                                                                                                             |
|                       |   "uplink_vlan": "122",                                                                                                                                        |
|                       |   "md5": "test",                                                                                                                                               |
|                       |   "secondary_peer_ip": "192.168.8.5",                                                                                                                          |
|                       |   "primary_router_id": "192.168.8.2",                                                                                                                          |
|                       |   "OS::stack_id": "8d6c9985-ee1d-4fe5-9b4f-963a5758a76a",                                                                                                      |
|                       |   "primary_ebgp_config_group": "VPNGW1-RI-EBGP",                                                                                                               |
|                       |   "secondary_device_port": "830",                                                                                                                              |
|                       |   "secondary_device_password": "esiesi0000",                                                                                                                   |
|                       |   "vrf_name": "vrf_gw_sample-ha-router-downlink_1025",                                                                                                         |
|                       |   "primary_device_username": "esi",                                                                                                                            |
|                       |   "primary_device_port": "830",                                                                                                                                |
|                       |   "secondary_device_ip": "10.79.5.184"                                                                                                                         |
|                       | }                                                                                                                                                              |
| parent                | None                                                                                                                                                           |
| stack_name            | vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047                                                                                                             |
| stack_owner           | admin                                                                                                                                                          |
| stack_status          | CREATE_COMPLETE                                                                                                                                                |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                            |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                               |
| template_description  | Inet Address                                                                                                                                                   |
| timeout_mins          | 60                                                                                                                                                             |
| updated_time          | None                                                                                                                                                           |
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047
description: 'Inet Address

  '
heat_template_version: '2013-05-23'
parameters:
  bgp_group_name: {description: Name of eBGP group, label: eBGP group name, type: string}
  local_as: {label: Local AS Number, type: number}
  md5: {description: eBGP authentication key, label: eBGP authentication key, type: string}
  primary_device_ip: {description: Ip address that will be used to establish ssh connection
      to the Primary Device., label: Ip address of the device., type: string}
  primary_device_password: {description: Password of the user which will be used to
      log onto the Primary Device., label: Users password., type: string}
  primary_device_physical_interface: {description: MX physical port on which logical
      interface will be created, label: Underlying physical interface, type: string}
  primary_device_port: {description: Port that will be used to establish ssh connection
      to the Primary Device., label: Port of the ssh connection., type: number}
  primary_device_username: {description: Name of the user which will be used to log
      onto the Primary Device., label: User name to log on to device., type: string}
  primary_ebgp_config_group: {description: Name of MX config group for eBGP config,
    label: eBGP config group, type: string}
  primary_peer_ip: {description: IP address of primary router eBGP neighbour, label: Primary
      device BGP peer, type: string}
  primary_router_id: {description: Primary router VRF router id, label: Primary router
      id, type: string}
  remote_as: {description: eBGP remote autonomous system, label: Remote AS, type: string}
  secondary_device_ip: {description: Ip address that will be used to establish ssh
      connection to the Secondary Device., label: Ip address of the device., type: string}
  secondary_device_password: {description: Password of the user which will be used
      to log onto the Secondary Device., label: Users password., type: string}
  secondary_device_physical_interface: {description: MX physical port on which logical
      interface will be created, label: Underlying physical interface, type: string}
  secondary_device_port: {description: Port that will be used to establish ssh connection
      to the Secondary Device., label: Port of the ssh connection., type: number}
  secondary_device_username: {description: Name of the user which will be used to
      log onto the Secondary Device., label: User name to log on to device., type: string}
  secondary_ebgp_config_group: {description: Name of MX config group for eBGP config,
    label: eBGP config group, type: string}
  secondary_peer_ip: {description: IP address of secondary router eBGP neighbour,
    label: Secondary device BGP peer, type: string}
  secondary_router_id: {description: Secondary router VRF router id, label: Secondary
      router id, type: string}
  uplink_vlan: {description: VLAN ID used on uplink interfaces (same for both primary
      and secondary device), label: Uplink VLAN ID, type: string}
  vrf_name: {description: Name of VRF (routing-instance) in MX config, label: VRF
      Name, type: string}
resources:
  netconf_configure_primary:
    properties:
      configs:
      - config: ''
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
        - {config_type: tag, tag: family, xml_type: tag}
        - {config_type: tag, tag: inet, xml_type: tag}
        - {config_type: named_tag, name: 192.168.8.2/30, tag: address, xml_type: named_tag}
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: primary_ebgp_config_group}
              $KEY: {get_param: md5}
              $NEIGHBOR_IP: {get_param: primary_peer_ip}
              $REMOTE_AS: {get_param: remote_as}
            template: 'apply-groups $APPLY_GROUP;

              local-address  192.168.8.2 ;

              peer-as $REMOTE_AS;

              neighbor $NEIGHBOR_IP authentication-key $KEY;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: protocols, xml_type: tag}
        - {config_type: tag, tag: bgp, xml_type: tag}
        - config_type: named_tag
          name: {get_param: bgp_group_name}
          tag: group
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LOCAL_AS: {get_param: local_as}
              $ROUTER_ID: {get_param: primary_router_id}
            template: 'router-id $ROUTER_ID;

              autonomous-system $LOCAL_AS;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: routing-options, xml_type: tag}
      device_ip: {get_param: primary_device_ip}
      lock_timeout: 3000
      password: {get_param: primary_device_password}
      port: {get_param: primary_device_port}
      username: {get_param: primary_device_username}
    type: OS::Contrail::NetconfNamedConfigs
  netconf_configure_secondary:
    properties:
      configs:
      - config: ''
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
        - {config_type: tag, tag: family, xml_type: tag}
        - {config_type: tag, tag: inet, xml_type: tag}
        - {config_type: named_tag, name: 192.168.8.6/30, tag: address, xml_type: named_tag}
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: secondary_ebgp_config_group}
              $KEY: {get_param: md5}
              $NEIGHBOR_IP: {get_param: secondary_peer_ip}
              $REMOTE_AS: {get_param: remote_as}
            template: 'apply-groups $APPLY_GROUP;

              local-address  192.168.8.6 ;

              peer-as $REMOTE_AS;

              neighbor $NEIGHBOR_IP authentication-key $KEY;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: protocols, xml_type: tag}
        - {config_type: tag, tag: bgp, xml_type: tag}
        - config_type: named_tag
          name: {get_param: bgp_group_name}
          tag: group
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LOCAL_AS: {get_param: local_as}
              $ROUTER_ID: {get_param: secondary_router_id}
            template: 'router-id $ROUTER_ID;

              autonomous-system $LOCAL_AS;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: routing-options, xml_type: tag}
      device_ip: {get_param: secondary_device_ip}
      lock_timeout: 3000
      password: {get_param: secondary_device_password}
      port: {get_param: secondary_device_port}
      username: {get_param: secondary_device_username}
    type: OS::Contrail::NetconfNamedConfigs

###############################################################
### checking heat-stack (vpn_gateways) for UPDATE_COMPLETE ####
###############################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/vpn_gateways/4fab887d-8f73-40e6-b2d8-2426255231bf
[localhost] local: heat stack-show vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                        |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                           |
| creation_time         | 2017-05-11T05:00:10Z                                                                                                                                         |
| description           | VPN Gateway                                                                                                                                                  |
| disable_rollback      | True                                                                                                                                                         |
| id                    | 8b8fd087-b322-41fb-8751-63042be0c8f7                                                                                                                         |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf/8b8fd087-b322-41fb-8751-63042be0c8f7 (self) |
| notification_topics   | []                                                                                                                                                           |
| outputs               | []                                                                                                                                                           |
| parameters            | {                                                                                                                                                            |
|                       |   "primary_device_logical_uplink_interface": "ge-0/0/1.122",                                                                                                 |
|                       |   "primary_device_logical_downlink_interface": "ae0.1025",                                                                                                   |
|                       |   "primary_device_password": "esiesi0000",                                                                                                                   |
|                       |   "output_filter_name": "FILTER_10M-GA-DOWN-VPN",                                                                                                            |
|                       |   "primary_device_ip": "10.79.5.185",                                                                                                                        |
|                       |   "secondary_device_physical_downlink_interface": "ae0",                                                                                                     |
|                       |   "secondary_device_username": "esi",                                                                                                                        |
|                       |   "primary_device_physical_uplink_interface": "ge-0/0/1",                                                                                                    |
|                       |   "secondary_device_logical_uplink_interface": "ge-0/0/1.122",                                                                                               |
|                       |   "downlink_vlan": "1025",                                                                                                                                   |
|                       |   "OS::stack_name": "vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf",                                                                                      |
|                       |   "secondary_device_logical_downlink_interface": "ae0.1025",                                                                                                 |
|                       |   "input_filter_name": "FILTER_10M-GA-UP-VPN",                                                                                                               |
|                       |   "uplink_vlan": "122",                                                                                                                                      |
|                       |   "OS::stack_id": "8b8fd087-b322-41fb-8751-63042be0c8f7",                                                                                                    |
|                       |   "secondary_device_port": "830",                                                                                                                            |
|                       |   "primary_downlink_vrrp_config_group": "VPNGW1-VRRP",                                                                                                       |
|                       |   "secondary_device_password": "esiesi0000",                                                                                                                 |
|                       |   "vrf_name": "vrf_gw_sample-ha-router-downlink_1025",                                                                                                       |
|                       |   "primary_device_username": "esi",                                                                                                                          |
|                       |   "primary_device_physical_downlink_interface": "ae0",                                                                                                       |
|                       |   "secondary_downlink_vrrp_config_group": "VPNGW2-VRRP",                                                                                                     |
|                       |   "primary_device_port": "830",                                                                                                                              |
|                       |   "secondary_device_physical_uplink_interface": "ge-0/0/1",                                                                                                  |
|                       |   "secondary_device_ip": "10.79.5.184"                                                                                                                       |
|                       | }                                                                                                                                                            |
| parent                | None                                                                                                                                                         |
| stack_name            | vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf                                                                                                             |
| stack_owner           | admin                                                                                                                                                        |
| stack_status          | UPDATE_COMPLETE                                                                                                                                              |
| stack_status_reason   | Stack successfully updated                                                                                                                                   |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                             |
| template_description  | VPN Gateway                                                                                                                                                  |
| timeout_mins          | 60                                                                                                                                                           |
| updated_time          | 2017-05-11T05:00:59Z                                                                                                                                         |
+-----------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf
description: 'VPN Gateway

  '
heat_template_version: '2013-05-23'
parameters:
  downlink_vlan: {description: vlan tag used by logical downlink interface, label: VLAN
      ID, type: string}
  input_filter_name: {description: Name for policer used for input, label: Input filter
      name, type: string}
  output_filter_name: {description: Name for policer used for output, label: Output
      filter name, type: string}
  primary_device_ip: {description: Ip address that will be used to establish ssh connection
      to the Primary Device., label: Ip address of the device., type: string}
  primary_device_logical_downlink_interface: {description: Name of the created logical
      downlink interface on the Primary device, label: Logical Interface name, type: string}
  primary_device_logical_uplink_interface: {description: Name of the created logical
      uplink interface on the Primary device, label: Logical Interface name, type: string}
  primary_device_password: {description: Password of the user which will be used to
      log onto the Primary Device., label: Users password., type: string}
  primary_device_physical_downlink_interface: {description: Physical port on the Primary
      device on which the logical downlink port will be configured, label: Underlying
      physical interface, type: string}
  primary_device_physical_uplink_interface: {description: Physical port on the Primary
      device on which the logical uplink port will be configured, label: Underlying
      physical interface, type: string}
  primary_device_port: {description: Port that will be used to establish ssh connection
      to the Primary Device., label: Port of the ssh connection., type: number}
  primary_device_username: {description: Name of the user which will be used to log
      onto the Primary Device., label: User name to log on to device., type: string}
  primary_downlink_vrrp_config_group: {description: Name for apply group to use for
      downlink interface for VRRP, label: Apply group name, type: string}
  secondary_device_ip: {description: Ip address that will be used to establish ssh
      connection to the Secondary Device., label: Ip address of the device., type: string}
  secondary_device_logical_downlink_interface: {description: Name of the created logical
      downlink interface on the Secondary device, label: Logical Interface name, type: string}
  secondary_device_logical_uplink_interface: {description: Name of the created logical
      uplink interface on the Secondary device, label: Logical Interface name, type: string}
  secondary_device_password: {description: Password of the user which will be used
      to log onto the Secondary Device., label: Users password., type: string}
  secondary_device_physical_downlink_interface: {description: Physical port on the
      Secondary device on which the logical downlink port will be configured, label: Underlying
      physical interface, type: string}
  secondary_device_physical_uplink_interface: {description: Physical port on the Secondary
      device on which the logical uplink port will be configured, label: Underlying
      physical interface, type: string}
  secondary_device_port: {description: Port that will be used to establish ssh connection
      to the Secondary Device., label: Port of the ssh connection., type: number}
  secondary_device_username: {description: Name of the user which will be used to
      log onto the Secondary Device., label: User name to log on to device., type: string}
  secondary_downlink_vrrp_config_group: {description: Name for apply group to use
      for downlink interface for VRRP, label: Apply group name, type: string}
  uplink_vlan: {description: vlan tag used by logical uplink interface, label: VLAN
      ID, type: string}
  vrf_name: {description: Name for VRF used by logical interfaces, label: VRF name,
    type: string}
resources:
  netconf_configure_primary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: primary_downlink_vrrp_config_group}
              $INPUT_FILTER: {get_param: input_filter_name}
              $OUTPUT_FILTER: {get_param: output_filter_name}
              $VLAN: {get_param: downlink_vlan}
            template: "apply-groups $APPLY_GROUP\nvlan-id $VLAN;\ndescription vpn_gw;\n\
              family inet {\n    filter {\n        input $INPUT_FILTER;\n        output\
              \ $OUTPUT_FILTER;\n    }\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_downlink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan}
          tag: unit
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LIFD: {get_param: primary_device_logical_downlink_interface}
              $LIFU: {get_param: primary_device_logical_uplink_interface}
            template: 'instance-type virtual-router;

              interface $LIFD;

              interface $LIFU;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $VLAN: {get_param: uplink_vlan}
            template: 'vlan-id $VLAN;

              description CloudGW_vpn;

              '
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_uplink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
      device_ip: {get_param: primary_device_ip}
      lock_timeout: 3000
      on_update: merge
      password: {get_param: primary_device_password}
      port: {get_param: primary_device_port}
      username: {get_param: primary_device_username}
    type: OS::Contrail::NetconfNamedConfigs
  netconf_configure_secondary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: secondary_downlink_vrrp_config_group}
              $INPUT_FILTER: {get_param: input_filter_name}
              $OUTPUT_FILTER: {get_param: output_filter_name}
              $VLAN: {get_param: downlink_vlan}
            template: "apply-groups $APPLY_GROUP\nvlan-id $VLAN;\ndescription vpn_gw;\n\
              family inet {\n    filter {\n        input $INPUT_FILTER;\n        output\
              \ $OUTPUT_FILTER;\n    }\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_downlink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan}
          tag: unit
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $LIFD: {get_param: secondary_device_logical_downlink_interface}
              $LIFU: {get_param: secondary_device_logical_uplink_interface}
            template: 'instance-type virtual-router;

              interface $LIFD;

              interface $LIFU;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $VLAN: {get_param: uplink_vlan}
            template: 'vlan-id $VLAN;

              description CloudGW_vpn;

              '
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_uplink_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: uplink_vlan}
          tag: unit
          xml_type: named_tag
      device_ip: {get_param: secondary_device_ip}
      lock_timeout: 3000
      on_update: merge
      password: {get_param: secondary_device_password}
      port: {get_param: secondary_device_port}
      username: {get_param: secondary_device_username}
    type: OS::Contrail::NetconfNamedConfigs

### Create Network ###
name:[sample-network], id:[bb69041d-c654-4e9f-a763-afd4333275bc]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:01:44.940775  05:01:45.074262  0.133487        POST     201    PENDING_CREATE
05:01:45.074659  05:01:45.291089  0.216430         GET     200    PENDING_CREATE
05:01:46.291800  05:01:46.465322  0.173522         GET     200    PENDING_CREATE
05:01:47.466567  05:01:47.633134  0.166567         GET     200    PENDING_CREATE
05:01:48.634341  05:01:48.781467  0.147126         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 3.840692

[localhost] local: gohan client network show --output-format json bb69041d-c654-4e9f-a763-afd4333275bc
{
    "network": {
        "admin_state_up": true,
        "description": "Sample Network",
        "id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "name": "sample-network",
        "plane": "data",
        "shared": false,
        "status": "ACTIVE",
        "subnets": [],
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

[localhost] local: gohan client resource_mapping list --output-format json
{
    "resource_mappings": [
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "1d5dcf8f-40f5-4780-8023-63bc1dd771ac",
            "mapped_id": "10.79.5.185-ge-0/0/1.122",
            "relation": "primary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478864e+09,
            "deleted": null,
            "id": "2f46f2b3-81f2-45d7-9f66-e64d131bb20b",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "4f69c6a1-e11b-4fae-bd0b-babe7df48380",
            "mapped_id": "10.79.5.184-ge-0/0/1.122",
            "relation": "secondary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478827e+09,
            "deleted": 1.494478858e+09,
            "id": "7806e79c-7403-462f-abd4-57d4f4f20f54",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478907e+09,
            "deleted": null,
            "id": "883c3271-8090-4515-abaa-56ef34692cd3",
            "mapped_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "relation": "instance",
            "resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "resource_type": "network",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        }
    ]
}

[localhost] local: gohan client billing_resource list --output-format json
{
    "billing_resources": [
        {
            "config_version": 1,
            "ended": null,
            "id": "0a8861ae-fab5-4a20-814d-6934bbb3e3d4",
            "info": {},
            "parent_billing_id": null,
            "resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "resource_type": "network",
            "started": 1.494478907e+09,
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
            "unique_resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc"
        }
    ]
}

#######################################
### checking heat-stack (networks) ####
#######################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/networks/bb69041d-c654-4e9f-a763-afd4333275bc
[localhost] local: heat stack-show network_bb69041d-c654-4e9f-a763-afd4333275bc
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                    |
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                       |
| creation_time         | 2017-05-11T05:01:45Z                                                                                                                                     |
| description           | Network template                                                                                                                                         |
| disable_rollback      | True                                                                                                                                                     |
| id                    | f73bedd0-b5d5-4abb-ac41-0804910e848c                                                                                                                     |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/network_bb69041d-c654-4e9f-a763-afd4333275bc/f73bedd0-b5d5-4abb-ac41-0804910e848c (self) |
| notification_topics   | []                                                                                                                                                       |
| outputs               | [                                                                                                                                                        |
|                       |   {                                                                                                                                                      |
|                       |     "output_value": "[]",                                                                                                                                |
|                       |     "description": "The name of the virtual network.",                                                                                                   |
|                       |     "output_key": "route_targets"                                                                                                                        |
|                       |   },                                                                                                                                                     |
|                       |   {                                                                                                                                                      |
|                       |     "output_value": "default-domain:admin:bb69041d-c654-4e9f-a763-afd4333275bc",                                                                         |
|                       |     "description": "The FQ name of the virtual network.",                                                                                                |
|                       |     "output_key": "fq_name"                                                                                                                              |
|                       |   },                                                                                                                                                     |
|                       |   {                                                                                                                                                      |
|                       |     "output_value": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                              |
|                       |     "description": "A unique id for the virtual network.",                                                                                               |
|                       |     "output_key": "id"                                                                                                                                   |
|                       |   },                                                                                                                                                     |
|                       |   {                                                                                                                                                      |
|                       |     "output_value": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                              |
|                       |     "description": "The name of the virtual network.",                                                                                                   |
|                       |     "output_key": "name"                                                                                                                                 |
|                       |   }                                                                                                                                                      |
|                       | ]                                                                                                                                                        |
| parameters            | {                                                                                                                                                        |
|                       |   "forwarding_mode": "l2_l3",                                                                                                                            |
|                       |   "allow_transit": "False",                                                                                                                              |
|                       |   "name": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                                        |
|                       |   "OS::stack_name": "network_bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                      |
|                       |   "admin_state_up": "True",                                                                                                                              |
|                       |   "OS::stack_id": "f73bedd0-b5d5-4abb-ac41-0804910e848c",                                                                                                |
|                       |   "external": "True",                                                                                                                                    |
|                       |   "shared": "False",                                                                                                                                     |
|                       |   "route_targets": "",                                                                                                                                   |
|                       |   "uuid": "bb69041d-c654-4e9f-a763-afd4333275bc"                                                                                                         |
|                       | }                                                                                                                                                        |
| parent                | None                                                                                                                                                     |
| stack_name            | network_bb69041d-c654-4e9f-a763-afd4333275bc                                                                                                             |
| stack_owner           | admin                                                                                                                                                    |
| stack_status          | CREATE_COMPLETE                                                                                                                                          |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                      |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                         |
| template_description  | Network template                                                                                                                                         |
| timeout_mins          | 10                                                                                                                                                       |
| updated_time          | None                                                                                                                                                     |
+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show network_bb69041d-c654-4e9f-a763-afd4333275bc
description: 'Network template

  '
heat_template_version: '2013-05-23'
outputs:
  fq_name:
    description: The FQ name of the virtual network.
    value:
      get_attr: [network, fq_name]
  id:
    description: A unique id for the virtual network.
    value: {get_resource: network}
  name:
    description: The name of the virtual network.
    value:
      get_attr: [network, name]
  route_targets:
    description: The name of the virtual network.
    value:
      get_attr: [network, route_targets]
parameters:
  admin_state_up: {default: true, label: Admin state up, type: boolean}
  allow_transit: {default: false, label: Allow Transit, type: boolean}
  external: {default: true, label: External Network, type: boolean}
  forwarding_mode: {default: l2_l3, description: Forwarding Mode., label: Forwarding
      Mode, type: string}
  name: {description: Name of the virtual network that will be created., label: Virtual
      Network Name, type: string}
  route_targets:
    default: []
    label: Route Targets list
    type: comma_delimited_list
  shared: {default: false, label: Shared Network, type: boolean}
  uuid: {default: '', description: UUID of the virtual network that will be created.,
    label: Virtual Network UUID, type: string}
resources:
  network:
    properties:
      admin_state_up: {get_param: admin_state_up}
      forwarding_mode: {get_param: forwarding_mode}
      name: {get_param: name}
      route_targets: {get_param: route_targets}
      shared: {get_param: shared}
      uuid: {get_param: uuid}
    type: OS::Contrail::VirtualNetwork

### Create Subnet ###
name:[sample-subnet], id:[b4f0c956-2fe0-4634-b7c8-22bfd8095aaf]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:02:02.410146  05:02:02.689987  0.279841        POST     201    PENDING_CREATE
05:02:02.690473  05:02:02.823608  0.133135         GET     200    PENDING_CREATE
05:02:03.824139  05:02:03.925785  0.101646         GET     200    PENDING_CREATE
05:02:04.926555  05:02:05.043841  0.117286         GET     200    PENDING_CREATE
05:02:06.045105  05:02:06.126268  0.081163         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 3.716122

[localhost] local: gohan client subnet show --output-format json b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
{
    "subnet": {
        "allocation_pools": [
            {
                "end": "172.16.101.254",
                "start": "172.16.101.2"
            }
        ],
        "cidr": "172.16.101.0/24",
        "description": "Sample Subnet",
        "dhcp_server_address": "172.16.101.2",
        "dns_nameservers": [],
        "enable_dhcp": true,
        "gateway_ip": "172.16.101.1",
        "host_routes": [],
        "id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf",
        "ip_version": 4,
        "ipv6_address_mode": null,
        "ipv6_ra_mode": null,
        "name": "sample-subnet",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "ntp_servers": [],
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

[localhost] local: gohan client port list --output-format json
[localhost] local: gohan client port show --output-format json 3388400c-5e25-4b97-8210-2a796927f2e7
{
    "port": {
        "admin_state_up": true,
        "allowed_address_pairs": [],
        "attached": false,
        "binding:vif_type": "vrouter",
        "description": "DHCP Server Port",
        "device_id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf",
        "device_owner": "network:dhcp",
        "ese_logical_port_id": null,
        "fake_delete": false,
        "fixed_ips": [
            {
                "ip_address": "172.16.101.2",
                "subnet_id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf"
            }
        ],
        "id": "3388400c-5e25-4b97-8210-2a796927f2e7",
        "mac_address": "00:00:5e:00:01:00",
        "managed_by_service": false,
        "name": "dhcp-server-port",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "segmentation_id": null,
        "segmentation_type": null,
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

######################################
### checking heat-stack (subnets) ####
######################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/subnets/b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
[localhost] local: heat stack-show subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                   |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                      |
| creation_time         | 2017-05-11T05:02:03Z                                                                                                                                    |
| description           | Subnet template                                                                                                                                         |
| disable_rollback      | True                                                                                                                                                    |
| id                    | ae4327f2-0f4c-460e-a370-2965a731cf8d                                                                                                                    |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf/ae4327f2-0f4c-460e-a370-2965a731cf8d (self) |
| notification_topics   | []                                                                                                                                                      |
| outputs               | [                                                                                                                                                       |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "172.16.101.0/24",                                                                                                                  |
|                       |     "description": "IP prefix of local subnet.",                                                                                                        |
|                       |     "output_key": "ip_prefix"                                                                                                                           |
|                       |   },                                                                                                                                                    |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf",                                                                                             |
|                       |     "description": "The name of the local subnet.",                                                                                                     |
|                       |     "output_key": "name"                                                                                                                                |
|                       |   },                                                                                                                                                    |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "172.16.101.1",                                                                                                                     |
|                       |     "description": "Default gateway of local subnet.",                                                                                                  |
|                       |     "output_key": "default_gateway"                                                                                                                     |
|                       |   },                                                                                                                                                    |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                             |
|                       |     "description": "A unique id for the network.",                                                                                                      |
|                       |     "output_key": "network_id"                                                                                                                          |
|                       |   },                                                                                                                                                    |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",                                                                                             |
|                       |     "description": "IPAM this local subnet uses.",                                                                                                      |
|                       |     "output_key": "ipam"                                                                                                                                |
|                       |   },                                                                                                                                                    |
|                       |   {                                                                                                                                                     |
|                       |     "output_value": "8f9e2ede-c3b4-438e-888d-55e326ec29a9",                                                                                             |
|                       |     "description": "A unique id for the local subnet.",                                                                                                 |
|                       |     "output_key": "id"                                                                                                                                  |
|                       |   }                                                                                                                                                     |
|                       | ]                                                                                                                                                       |
| parameters            | {                                                                                                                                                       |
|                       |   "OS::stack_name": "subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf",                                                                                      |
|                       |   "enable_dhcp": "True",                                                                                                                                |
|                       |   "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                                 |
|                       |   "ipam": "default-domain:default-project:default-network-ipam",                                                                                        |
|                       |   "dns_nameservers": "",                                                                                                                                |
|                       |   "dhcp_server_address": "172.16.101.2",                                                                                                                |
|                       |   "OS::stack_id": "ae4327f2-0f4c-460e-a370-2965a731cf8d",                                                                                               |
|                       |   "ntp_servers": "",                                                                                                                                    |
|                       |   "allocation_pools": "[{u'start': u'172.16.101.2', u'end': u'172.16.101.254'}]",                                                                       |
|                       |   "gateway_ip": "172.16.101.1",                                                                                                                         |
|                       |   "host_routes": "[]",                                                                                                                                  |
|                       |   "cidr": "172.16.101.0/24",                                                                                                                            |
|                       |   "name": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf"                                                                                                        |
|                       | }                                                                                                                                                       |
| parent                | None                                                                                                                                                    |
| stack_name            | subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf                                                                                                             |
| stack_owner           | admin                                                                                                                                                   |
| stack_status          | CREATE_COMPLETE                                                                                                                                         |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                     |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                        |
| template_description  | Subnet template                                                                                                                                         |
| timeout_mins          | 10                                                                                                                                                      |
| updated_time          | None                                                                                                                                                    |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
description: 'Subnet template

  '
heat_template_version: '2013-05-23'
outputs:
  default_gateway:
    description: Default gateway of local subnet.
    value:
      get_attr: [subnet, default_gateway]
  id:
    description: A unique id for the local subnet.
    value: {get_resource: subnet}
  ip_prefix:
    description: IP prefix of local subnet.
    value:
      get_attr: [subnet, ip_prefix]
  ipam:
    description: IPAM this local subnet uses.
    value:
      get_attr: [subnet, ipam]
  name:
    description: The name of the local subnet.
    value:
      get_attr: [subnet, name]
  network_id:
    description: A unique id for the network.
    value:
      get_attr: [subnet, network_id]
parameters:
  allocation_pools:
    default: []
    description: Allocation Pools
    label: Allocation Pools
    type: string
  cidr: {description: IP prefix of the local subnet that will be created., label: Local
      Subnet IP prefix, type: string}
  dhcp_server_address: {default: 0.0.0.0, description: DHCP Server address, label: DHCP
      Server address, type: string}
  dns_nameservers:
    default: []
    description: DNS Nameservers List
    label: DNS Nameservers List
    type: comma_delimited_list
  enable_dhcp: {default: true, description: Enable DHCP, label: Enable DHCP, type: boolean}
  gateway_ip: {default: 0.0.0.0, description: Default gateway for the local subnet
      that will be created., label: Default Gateway, type: string}
  host_routes:
    default: []
    description: Host Routes
    label: Host Routes
    type: json
  ipam: {default: '', description: IPAM for the local subnet that will be created.,
    label: IP Address Management, type: string}
  name: {description: Name of the local subnet that will be created., label: Local
      Subnet Name, type: string}
  network_id: {description: ID of the network for which subnet will be created., label: Network
      ID, type: string}
  ntp_servers:
    default: []
    description: NTP Nameservers List
    label: NTP Nameservers List
    type: comma_delimited_list
resources:
  subnet:
    properties:
      allocation_pools: {get_param: allocation_pools}
      default_gateway: {get_param: gateway_ip}
      dns_nameservers: {get_param: dns_nameservers}
      dns_server_address: {get_param: dhcp_server_address}
      enable_dhcp: {get_param: enable_dhcp}
      gateway_is_vrouter: false
      host_routes: {get_param: host_routes}
      ip_prefix: {get_param: cidr}
      ipam: {get_param: ipam}
      name: {get_param: name}
      network_id: {get_param: network_id}
      ntp_servers: {get_param: ntp_servers}
    type: OS::Contrail::VnSubnet

### Create Gw Interface ###
name:[sample-gw-interface], id:[fbd7d07e-9e84-4ad7-ab85-36d46adb9435]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:02:19.375401  05:02:20.851549  1.476148        POST     201    PENDING_CREATE
[localhost] local: gohan client port list --output-format json
########################################################
### checking heat-stack (ports) for CREATE_COMPLETE ####
########################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ports/33907bcb-8689-425d-a700-fe8acfd94aed
[localhost] local: heat stack-show port_33907bcb-8689-425d-a700-fe8acfd94aed
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                 |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                    |
| creation_time         | 2017-05-11T05:02:39Z                                                                                                                                  |
| description           | Virtual Machine Interface Template                                                                                                                    |
| disable_rollback      | True                                                                                                                                                  |
| id                    | 5bf72e78-0650-4f7f-a7c8-d668e838ac93                                                                                                                  |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/port_33907bcb-8689-425d-a700-fe8acfd94aed/5bf72e78-0650-4f7f-a7c8-d668e838ac93 (self) |
| notification_topics   | []                                                                                                                                                    |
| parameters            | {                                                                                                                                                     |
|                       |   "virtual_machine": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",                                                                                          |
|                       |   "name": "33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                                     |
|                       |   "OS::stack_name": "port_33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                      |
|                       |   "admin_state_up": "True",                                                                                                                           |
|                       |   "virtual_machine_interface_allowed_address_pairs": "null",                                                                                          |
|                       |   "virtual_machine_interface_mac_address": "fa:16:3e:ef:15:a2",                                                                                       |
|                       |   "OS::stack_id": "5bf72e78-0650-4f7f-a7c8-d668e838ac93",                                                                                             |
|                       |   "device_owner": "network:gw_interface",                                                                                                             |
|                       |   "virtual_network": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                          |
|                       |   "uuid": "33907bcb-8689-425d-a700-fe8acfd94aed"                                                                                                      |
|                       | }                                                                                                                                                     |
| parent                | None                                                                                                                                                  |
| stack_name            | port_33907bcb-8689-425d-a700-fe8acfd94aed                                                                                                             |
| stack_owner           | admin                                                                                                                                                 |
| stack_status          | UPDATE_IN_PROGRESS                                                                                                                                    |
| stack_status_reason   | Stack UPDATE started                                                                                                                                  |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                      |
| template_description  | Virtual Machine Interface Template                                                                                                                    |
| timeout_mins          | 10                                                                                                                                                    |
| updated_time          | None                                                                                                                                                  |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show port_33907bcb-8689-425d-a700-fe8acfd94aed
description: 'Virtual Machine Interface Template

  '
heat_template_version: '2013-05-23'
outputs:
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs]
  fq_name:
    description: Fully Qualified Name of the VMI
    value:
      get_attr: [virtual_machine_interface, fq_name]
  id:
    description: A unique id for the virtual machine interface.
    value: {get_resource: virtual_machine_interface}
  mac_address:
    description: Virtual machine interface mac address.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses]
  virtual_network:
    description: Virtual network.
    value:
      get_attr: [virtual_machine_interface, virtual_networks]
parameters:
  admin_state_up: {default: true, label: Admin state up, type: boolean}
  device_owner: {default: '', label: Device Owner, type: string}
  name: {description: A unique id for the Physical Interface., label: Physical Interface
      ID, type: string}
  uuid: {description: A unique id for the Virtual Machine Interface., label: Backend
      Virtual Machine Interface UUID, type: string}
  virtual_machine: {default: '', label: Virtual Machine., type: string}
  virtual_machine_interface_allowed_address_pairs: {label: Virtual machine interface
      allowed address pairs., type: json}
  virtual_machine_interface_mac_address: {default: 'fe:ff:ff:ff:ff:ff', label: Virtual
      machine interface mac address., type: string}
  virtual_network: {label: Virtual Network., type: string}
resources:
  instance_ip_0:
    properties:
      ip_address: 172.16.101.151
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.151
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  instance_ip_1:
    properties:
      ip_address: 172.16.101.152
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.152
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  virtual_machine_interface:
    properties:
      admin_state_up: {get_param: admin_state_up}
      device_owner: {get_param: device_owner}
      name: {get_param: name}
      uuid: {get_param: uuid}
      virtual_machine: {get_param: virtual_machine}
      virtual_machine_interface_allowed_address_pairs: {get_param: virtual_machine_interface_allowed_address_pairs}
      virtual_machine_interface_mac_addresses:
      - {get_param: virtual_machine_interface_mac_address}
      virtual_networks:
      - {get_param: virtual_network}
    type: OS::Contrail::VirtualMachineInterface

########################################################
### checking heat-stack (ports) for CREATE_COMPLETE ####
########################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ports/67d9f139-b5be-4082-a090-3a1a9cbf1df8
[localhost] local: heat stack-show port_67d9f139-b5be-4082-a090-3a1a9cbf1df8
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                 |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                    |
| creation_time         | 2017-05-11T05:02:39Z                                                                                                                                  |
| description           | Virtual Machine Interface Template                                                                                                                    |
| disable_rollback      | True                                                                                                                                                  |
| id                    | 1bb1200e-ba86-4e1a-97fb-80cb2408e713                                                                                                                  |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/port_67d9f139-b5be-4082-a090-3a1a9cbf1df8/1bb1200e-ba86-4e1a-97fb-80cb2408e713 (self) |
| notification_topics   | []                                                                                                                                                    |
| parameters            | {                                                                                                                                                     |
|                       |   "virtual_machine": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",                                                                                          |
|                       |   "name": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                                     |
|                       |   "OS::stack_name": "port_67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                      |
|                       |   "admin_state_up": "True",                                                                                                                           |
|                       |   "virtual_machine_interface_allowed_address_pairs": "null",                                                                                          |
|                       |   "virtual_machine_interface_mac_address": "fa:16:3e:62:dd:f5",                                                                                       |
|                       |   "OS::stack_id": "1bb1200e-ba86-4e1a-97fb-80cb2408e713",                                                                                             |
|                       |   "device_owner": "network:gw_interface",                                                                                                             |
|                       |   "virtual_network": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                          |
|                       |   "uuid": "67d9f139-b5be-4082-a090-3a1a9cbf1df8"                                                                                                      |
|                       | }                                                                                                                                                     |
| parent                | None                                                                                                                                                  |
| stack_name            | port_67d9f139-b5be-4082-a090-3a1a9cbf1df8                                                                                                             |
| stack_owner           | admin                                                                                                                                                 |
| stack_status          | UPDATE_IN_PROGRESS                                                                                                                                    |
| stack_status_reason   | Stack UPDATE started                                                                                                                                  |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                      |
| template_description  | Virtual Machine Interface Template                                                                                                                    |
| timeout_mins          | 10                                                                                                                                                    |
| updated_time          | None                                                                                                                                                  |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show port_67d9f139-b5be-4082-a090-3a1a9cbf1df8
description: 'Virtual Machine Interface Template

  '
heat_template_version: '2013-05-23'
outputs:
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs]
  fq_name:
    description: Fully Qualified Name of the VMI
    value:
      get_attr: [virtual_machine_interface, fq_name]
  id:
    description: A unique id for the virtual machine interface.
    value: {get_resource: virtual_machine_interface}
  mac_address:
    description: Virtual machine interface mac address.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses]
  virtual_network:
    description: Virtual network.
    value:
      get_attr: [virtual_machine_interface, virtual_networks]
parameters:
  admin_state_up: {default: true, label: Admin state up, type: boolean}
  device_owner: {default: '', label: Device Owner, type: string}
  name: {description: A unique id for the Physical Interface., label: Physical Interface
      ID, type: string}
  uuid: {description: A unique id for the Virtual Machine Interface., label: Backend
      Virtual Machine Interface UUID, type: string}
  virtual_machine: {default: '', label: Virtual Machine., type: string}
  virtual_machine_interface_allowed_address_pairs: {label: Virtual machine interface
      allowed address pairs., type: json}
  virtual_machine_interface_mac_address: {default: 'fe:ff:ff:ff:ff:ff', label: Virtual
      machine interface mac address., type: string}
  virtual_network: {label: Virtual Network., type: string}
resources:
  instance_ip_0:
    properties:
      ip_address: 172.16.101.153
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.153
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  virtual_machine_interface:
    properties:
      admin_state_up: {get_param: admin_state_up}
      device_owner: {get_param: device_owner}
      name: {get_param: name}
      uuid: {get_param: uuid}
      virtual_machine: {get_param: virtual_machine}
      virtual_machine_interface_allowed_address_pairs: {get_param: virtual_machine_interface_allowed_address_pairs}
      virtual_machine_interface_mac_addresses:
      - {get_param: virtual_machine_interface_mac_address}
      virtual_networks:
      - {get_param: virtual_network}
    type: OS::Contrail::VirtualMachineInterface

05:02:51.532413  05:02:51.616447  0.084034         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 32.241046

[localhost] local: gohan client gw_interface show --output-format json fbd7d07e-9e84-4ad7-ab85-36d46adb9435
{
    "gw_interface": {
        "aws_gw_id": null,
        "description": "Sample Gw-interface",
        "gw_vipv4": "172.16.101.151",
        "gw_vipv6": null,
        "id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
        "interdc_gw_id": null,
        "internet_gw_id": null,
        "name": "sample-gw-interface",
        "netmask": 24,
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "primary_ipv4": "172.16.101.152",
        "primary_ipv6": null,
        "public_ip_id": null,
        "secondary_ipv4": "172.16.101.153",
        "secondary_ipv6": null,
        "service_type": "vpn",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vpn_gw_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
        "vrid": 20
    }
}

############################################
### checking heat-stack (gw_interfaces) ####
############################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/gw_interfaces/fbd7d07e-9e84-4ad7-ab85-36d46adb9435
[localhost] local: heat stack-show gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                         |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                            |
| creation_time         | 2017-05-11T05:02:21Z                                                                                                                                          |
| description           | Inet Address                                                                                                                                                  |
| disable_rollback      | True                                                                                                                                                          |
| id                    | 6241b027-f0f1-418b-aa7a-ef6199be695b                                                                                                                          |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435/6241b027-f0f1-418b-aa7a-ef6199be695b (self) |
| notification_topics   | []                                                                                                                                                            |
| outputs               | []                                                                                                                                                            |
| parameters            | {                                                                                                                                                             |
|                       |   "secondary_device_physical_interface": "ae0",                                                                                                               |
|                       |   "secondary_ibgp_config_group": "VPNGW2-RI-IBGP",                                                                                                            |
|                       |   "primary_device_password": "esiesi0000",                                                                                                                    |
|                       |   "secondary_device_gw_ip": "172.16.101.153",                                                                                                                 |
|                       |   "bgp_group_name": "inet-gw-group",                                                                                                                          |
|                       |   "gw_vip": "172.16.101.151",                                                                                                                                 |
|                       |   "primary_device_ip": "10.79.5.185",                                                                                                                         |
|                       |   "secondary_device_username": "esi",                                                                                                                         |
|                       |   "downlink_vlan_id": "1025",                                                                                                                                 |
|                       |   "OS::stack_name": "gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435",                                                                                      |
|                       |   "local_as": "65101",                                                                                                                                        |
|                       |   "vrrp_group": "20",                                                                                                                                         |
|                       |   "netmask": "24",                                                                                                                                            |
|                       |   "primary_device_physical_interface": "ae0",                                                                                                                 |
|                       |   "primary_device_priority": "105",                                                                                                                           |
|                       |   "OS::stack_id": "6241b027-f0f1-418b-aa7a-ef6199be695b",                                                                                                     |
|                       |   "primary_device_gw_ip": "172.16.101.152",                                                                                                                   |
|                       |   "secondary_device_port": "830",                                                                                                                             |
|                       |   "secondary_device_password": "esiesi0000",                                                                                                                  |
|                       |   "vrf_name": "vrf_gw_sample-ha-router-downlink_1025",                                                                                                        |
|                       |   "primary_device_username": "esi",                                                                                                                           |
|                       |   "secondary_device_priority": "100",                                                                                                                         |
|                       |   "primary_ibgp_config_group": "VPNGW1-RI-IBGP",                                                                                                              |
|                       |   "primary_device_port": "830",                                                                                                                               |
|                       |   "secondary_device_ip": "10.79.5.184"                                                                                                                        |
|                       | }                                                                                                                                                             |
| parent                | None                                                                                                                                                          |
| stack_name            | gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435                                                                                                             |
| stack_owner           | admin                                                                                                                                                         |
| stack_status          | CREATE_COMPLETE                                                                                                                                               |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                           |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                              |
| template_description  | Inet Address                                                                                                                                                  |
| timeout_mins          | 60                                                                                                                                                            |
| updated_time          | None                                                                                                                                                          |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435
description: 'Inet Address

  '
heat_template_version: '2013-05-23'
parameters:
  bgp_group_name: {label: Name of BGP Group on VRF, type: string}
  downlink_vlan_id: {description: Vlan tag for mx logical downlink interface, label: Vlan
      Tag, type: string}
  gw_vip: {description: Virtual IP configured on VRRP, label: Inet Address CIDR, type: string}
  local_as: {label: Local AS Number, type: string}
  netmask: {description: Netmask for gw_ip, label: Netmask, type: number}
  primary_device_gw_ip: {description: IP on primary device, label: Inet Address CIDR,
    type: string}
  primary_device_ip: {description: Ip address that will be used to establish ssh connection
      to the Primary Device., label: Ip address of the device., type: string}
  primary_device_password: {description: Password of the user which will be used to
      log onto the Primary Device., label: Users password., type: string}
  primary_device_physical_interface: {description: MX physical port on which logical
      interface will be created, label: Underlying physical interface, type: string}
  primary_device_port: {description: Port that will be used to establish ssh connection
      to the Primary Device., label: Port of the ssh connection., type: number}
  primary_device_priority: {label: Primary device priority, type: string}
  primary_device_username: {description: Name of the user which will be used to log
      onto the Primary Device., label: User name to log on to device., type: string}
  primary_ibgp_config_group: {description: Name for apply group to use for downlink
      interface, label: Apply group name, type: string}
  secondary_device_gw_ip: {description: IP on secondary device, label: Inet Address
      CIDR, type: string}
  secondary_device_ip: {description: Ip address that will be used to establish ssh
      connection to the Secondary Device., label: Ip address of the device., type: string}
  secondary_device_password: {description: Password of the user which will be used
      to log onto the Secondary Device., label: Users password., type: string}
  secondary_device_physical_interface: {description: MX physical port on which logical
      interface will be created, label: Underlying physical interface, type: string}
  secondary_device_port: {description: Port that will be used to establish ssh connection
      to the Secondary Device., label: Port of the ssh connection., type: number}
  secondary_device_priority: {label: Secondary device priority, type: string}
  secondary_device_username: {description: Name of the user which will be used to
      log onto the Secondary Device., label: User name to log on to device., type: string}
  secondary_ibgp_config_group: {description: Name for apply group to use for downlink
      interface, label: Apply group name, type: string}
  vrf_name: {label: VRF, type: string}
  vrrp_group: {label: VRRP Group, type: string}
resources:
  netconf_configure_primary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $PRIORITY: {get_param: primary_device_priority}
              $VIP: {get_param: gw_vip}
              $VRRP_GROUP: {get_param: vrrp_group}
            template: "vrrp-group $VRRP_GROUP {\n    virtual-address $VIP;\n    priority\
              \ $PRIORITY;\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: primary_device_physical_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan_id}
          tag: unit
          xml_type: named_tag
        - {config_type: tag, tag: family, xml_type: tag}
        - {config_type: tag, tag: inet, xml_type: tag}
        - config_type: named_tag
          name:
            str_replace:
              params:
                $DEVICE_IP: {get_param: primary_device_gw_ip}
                $NETMASK: {get_param: netmask}
              template: '$DEVICE_IP/$NETMASK

                '
          tag: address
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: primary_ibgp_config_group}
              $DEVICE_GW_IP: {get_param: primary_device_gw_ip}
              $LOCAL_AS: {get_param: local_as}
              $NEIGHBOR_GW_IP: {get_param: secondary_device_gw_ip}
            template: 'apply-groups $APPLY_GROUP;

              local-address $DEVICE_GW_IP;

              peer-as $LOCAL_AS;

              neighbor $NEIGHBOR_GW_IP;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: protocols, xml_type: tag}
        - {config_type: tag, tag: bgp, xml_type: tag}
        - config_type: named_tag
          name: {get_param: bgp_group_name}
          tag: group
          xml_type: named_tag
      device_ip: {get_param: primary_device_ip}
      lock_timeout: 3000
      password: {get_param: primary_device_password}
      port: {get_param: primary_device_port}
      username: {get_param: primary_device_username}
    type: OS::Contrail::NetconfNamedConfigs
  netconf_configure_secondary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $PRIORITY: {get_param: secondary_device_priority}
              $VIP: {get_param: gw_vip}
              $VRRP_GROUP: {get_param: vrrp_group}
            template: "vrrp-group $VRRP_GROUP {\n    virtual-address $VIP;\n    priority\
              \ $PRIORITY;\n}\n"
        path:
        - {config_type: tag, tag: interfaces, xml_type: tag}
        - config_type: name
          name: {get_param: secondary_device_physical_interface}
          tag: interface
          xml_type: named_tag
        - config_type: named_tag
          name: {get_param: downlink_vlan_id}
          tag: unit
          xml_type: named_tag
        - {config_type: tag, tag: family, xml_type: tag}
        - {config_type: tag, tag: inet, xml_type: tag}
        - config_type: named_tag
          name:
            str_replace:
              params:
                $DEVICE_IP: {get_param: secondary_device_gw_ip}
                $NETMASK: {get_param: netmask}
              template: '$DEVICE_IP/$NETMASK

                '
          tag: address
          xml_type: named_tag
      - config:
          str_replace:
            params:
              $APPLY_GROUP: {get_param: secondary_ibgp_config_group}
              $DEVICE_GW_IP: {get_param: secondary_device_gw_ip}
              $LOCAL_AS: {get_param: local_as}
              $NEIGHBOR_GW_IP: {get_param: primary_device_gw_ip}
            template: 'apply-groups $APPLY_GROUP;

              local-address $DEVICE_GW_IP;

              peer-as $LOCAL_AS;

              neighbor $NEIGHBOR_GW_IP;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: protocols, xml_type: tag}
        - {config_type: tag, tag: bgp, xml_type: tag}
        - config_type: named_tag
          name: {get_param: bgp_group_name}
          tag: group
          xml_type: named_tag
      device_ip: {get_param: secondary_device_ip}
      lock_timeout: 3000
      password: {get_param: secondary_device_password}
      port: {get_param: secondary_device_port}
      username: {get_param: secondary_device_username}
    type: OS::Contrail::NetconfNamedConfigs

[localhost] local: gohan client ese_logical_port list --output-format json
[localhost] local: gohan client ese_logical_port show --output-format json ecb4c4ac-3ebc-4045-a27c-52fecc93bac5
{
    "ese_logical_port": {
        "common_function_gateway_id": null,
        "connected_resource": "gw_interface",
        "description": "ESE Logical port for Port 67d9f139-b5be-4082-a090-3a1a9cbf1df8",
        "ese_physical_port_id": "176ec475-e9e8-4605-8b41-802fbc6220c1",
        "gw_interface_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
        "id": "ecb4c4ac-3ebc-4045-a27c-52fecc93bac5",
        "name": "xe-0/0/4.1025",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "port_ids": [
            "67d9f139-b5be-4082-a090-3a1a9cbf1df8"
        ],
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "type": "L2",
        "vlan_id": 1025
    }
}

################################################
### checking heat-stack (ese_logical_ports) ####
################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ese_logical_ports/ecb4c4ac-3ebc-4045-a27c-52fecc93bac5
[localhost] local: heat stack-show ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                             |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                                |
| creation_time         | 2017-05-11T05:02:43Z                                                                                                                                              |
| description           | Logical port template                                                                                                                                             |
| disable_rollback      | True                                                                                                                                                              |
| id                    | 356486d9-72dd-4d6e-80c8-e252926c957d                                                                                                                              |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5/356486d9-72dd-4d6e-80c8-e252926c957d (self) |
| notification_topics   | []                                                                                                                                                                |
| outputs               | [                                                                                                                                                                 |
|                       |   {                                                                                                                                                               |
|                       |     "output_value": "cccccccc-cccc-cccc-cccc-cccccccccccc",                                                                                                       |
|                       |     "description": "A unique id for the logical interface",                                                                                                       |
|                       |     "output_key": "id"                                                                                                                                            |
|                       |   },                                                                                                                                                              |
|                       |   {                                                                                                                                                               |
|                       |     "output_value": null,                                                                                                                                         |
|                       |     "output_error": "'ContrailLogicalInterface' object has no attribute 'li_uuid'",                                                                               |
|                       |     "description": "The name of the logical interface.",                                                                                                          |
|                       |     "output_key": "name"                                                                                                                                          |
|                       |   }                                                                                                                                                               |
|                       | ]                                                                                                                                                                 |
| parameters            | {                                                                                                                                                                 |
|                       |   "logical_port_type": "L2",                                                                                                                                      |
|                       |   "physical_port_id": "dddddddd-dddd-dddd-dddd-dddddddddddd",                                                                                                     |
|                       |   "OS::stack_id": "356486d9-72dd-4d6e-80c8-e252926c957d",                                                                                                         |
|                       |   "OS::stack_name": "ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5",                                                                                      |
|                       |   "virtual_machine_interface_ids": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                        |
|                       |   "logical_port_name": "xe-0/0/4.1025",                                                                                                                           |
|                       |   "logical_port_vlan_id": "1025"                                                                                                                                  |
|                       | }                                                                                                                                                                 |
| parent                | None                                                                                                                                                              |
| stack_name            | ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5                                                                                                             |
| stack_owner           | admin                                                                                                                                                             |
| stack_status          | CREATE_COMPLETE                                                                                                                                                   |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                               |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                                  |
| template_description  | Logical port template                                                                                                                                             |
| timeout_mins          | 10                                                                                                                                                                |
| updated_time          | None                                                                                                                                                              |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5
description: 'Logical port template

  '
heat_template_version: '2013-05-23'
outputs:
  id:
    description: A unique id for the logical interface
    value: {get_resource: logical_interface}
  name:
    description: The name of the logical interface.
    value:
      get_attr: [logical_interface, name]
parameters:
  logical_port_name: {description: Name of the logical port., label: Logical Port
      Name, type: string}
  logical_port_type: {description: Type of the logical port., label: Logical Port
      Type, type: string}
  logical_port_vlan_id: {default: 0, description: VLAN id to use for logical port
      creation., label: VLAN id for Logical Port, type: number}
  physical_port_id: {description: A unique id for the Physical Interface., label: Physical
      Interface ID, type: string}
  virtual_machine_interface_ids: {description: Virtual Machine Interface ID., label: Virtual
      Machine Interface ID, type: comma_delimited_list}
resources:
  logical_interface:
    properties:
      name: {get_param: logical_port_name}
      physical_interface: {get_param: physical_port_id}
      type: {get_param: logical_port_type}
      virtual_machine_interfaces: {get_param: virtual_machine_interface_ids}
      vlan: {get_param: logical_port_vlan_id}
    type: OS::Contrail::LogicalInterface

[localhost] local: gohan client port show --output-format json 67d9f139-b5be-4082-a090-3a1a9cbf1df8
{
    "port": {
        "admin_state_up": true,
        "allowed_address_pairs": [],
        "attached": true,
        "binding:vif_type": "vrouter",
        "description": "",
        "device_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
        "device_owner": "network:gw_interface",
        "ese_logical_port_id": "ecb4c4ac-3ebc-4045-a27c-52fecc93bac5",
        "fake_delete": false,
        "fixed_ips": [
            {
                "ip_address": "172.16.101.153",
                "subnet_id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf"
            }
        ],
        "id": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",
        "mac_address": "fa:16:3e:62:dd:f5",
        "managed_by_service": true,
        "name": "Port for : 176ec475-e9e8-4605-8b41-802fbc6220c1",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "segmentation_id": 1025,
        "segmentation_type": "vlan",
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

########################################################
### checking heat-stack (ports) for UPDATE_COMPLETE ####
########################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ports/67d9f139-b5be-4082-a090-3a1a9cbf1df8
[localhost] local: heat stack-show port_67d9f139-b5be-4082-a090-3a1a9cbf1df8
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                 |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                    |
| creation_time         | 2017-05-11T05:02:39Z                                                                                                                                  |
| description           | Virtual Machine Interface Template                                                                                                                    |
| disable_rollback      | True                                                                                                                                                  |
| id                    | 1bb1200e-ba86-4e1a-97fb-80cb2408e713                                                                                                                  |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/port_67d9f139-b5be-4082-a090-3a1a9cbf1df8/1bb1200e-ba86-4e1a-97fb-80cb2408e713 (self) |
| notification_topics   | []                                                                                                                                                    |
| outputs               | [                                                                                                                                                     |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb",                                                                                           |
|                       |     "description": "Virtual network.",                                                                                                                |
|                       |     "output_key": "virtual_network"                                                                                                                   |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "default-domain:admin:67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                      |
|                       |     "description": "Fully Qualified Name of the VMI",                                                                                                 |
|                       |     "output_key": "fq_name"                                                                                                                           |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                           |
|                       |     "description": "A unique id for the virtual machine interface.",                                                                                  |
|                       |     "output_key": "id"                                                                                                                                |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "null",                                                                                                                           |
|                       |     "description": "Virtual machine allowed address pairs.",                                                                                          |
|                       |     "output_key": "allowed_address_pairs"                                                                                                             |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "xx:xx:xx:xx:xx:xx",                                                                                                              |
|                       |     "description": "Virtual machine interface mac address.",                                                                                          |
|                       |     "output_key": "mac_address"                                                                                                                       |
|                       |   }                                                                                                                                                   |
|                       | ]                                                                                                                                                     |
| parameters            | {                                                                                                                                                     |
|                       |   "virtual_machine": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",                                                                                          |
|                       |   "name": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                                     |
|                       |   "OS::stack_name": "port_67d9f139-b5be-4082-a090-3a1a9cbf1df8",                                                                                      |
|                       |   "admin_state_up": "True",                                                                                                                           |
|                       |   "virtual_machine_interface_allowed_address_pairs": "null",                                                                                          |
|                       |   "virtual_machine_interface_mac_address": "fa:16:3e:62:dd:f5",                                                                                       |
|                       |   "OS::stack_id": "1bb1200e-ba86-4e1a-97fb-80cb2408e713",                                                                                             |
|                       |   "device_owner": "network:gw_interface",                                                                                                             |
|                       |   "virtual_network": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                          |
|                       |   "uuid": "67d9f139-b5be-4082-a090-3a1a9cbf1df8"                                                                                                      |
|                       | }                                                                                                                                                     |
| parent                | None                                                                                                                                                  |
| stack_name            | port_67d9f139-b5be-4082-a090-3a1a9cbf1df8                                                                                                             |
| stack_owner           | admin                                                                                                                                                 |
| stack_status          | UPDATE_COMPLETE                                                                                                                                       |
| stack_status_reason   | Stack successfully updated                                                                                                                            |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                      |
| template_description  | Virtual Machine Interface Template                                                                                                                    |
| timeout_mins          | 10                                                                                                                                                    |
| updated_time          | 2017-05-11T05:02:46Z                                                                                                                                  |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show port_67d9f139-b5be-4082-a090-3a1a9cbf1df8
description: 'Virtual Machine Interface Template

  '
heat_template_version: '2013-05-23'
outputs:
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs]
  fq_name:
    description: Fully Qualified Name of the VMI
    value:
      get_attr: [virtual_machine_interface, fq_name]
  id:
    description: A unique id for the virtual machine interface.
    value: {get_resource: virtual_machine_interface}
  mac_address:
    description: Virtual machine interface mac address.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses]
  virtual_network:
    description: Virtual network.
    value:
      get_attr: [virtual_machine_interface, virtual_networks]
parameters:
  admin_state_up: {default: true, label: Admin state up, type: boolean}
  device_owner: {default: '', label: Device Owner, type: string}
  name: {description: A unique id for the Physical Interface., label: Physical Interface
      ID, type: string}
  uuid: {description: A unique id for the Virtual Machine Interface., label: Backend
      Virtual Machine Interface UUID, type: string}
  virtual_machine: {default: '', label: Virtual Machine., type: string}
  virtual_machine_interface_allowed_address_pairs: {label: Virtual machine interface
      allowed address pairs., type: json}
  virtual_machine_interface_mac_address: {default: 'fe:ff:ff:ff:ff:ff', label: Virtual
      machine interface mac address., type: string}
  virtual_network: {label: Virtual Network., type: string}
resources:
  instance_ip_0:
    properties:
      ip_address: 172.16.101.153
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.153
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  virtual_machine_interface:
    properties:
      admin_state_up: {get_param: admin_state_up}
      device_owner: {get_param: device_owner}
      name: {get_param: name}
      uuid: {get_param: uuid}
      virtual_machine: {get_param: virtual_machine}
      virtual_machine_interface_allowed_address_pairs: {get_param: virtual_machine_interface_allowed_address_pairs}
      virtual_machine_interface_mac_addresses:
      - {get_param: virtual_machine_interface_mac_address}
      virtual_networks:
      - {get_param: virtual_network}
    type: OS::Contrail::VirtualMachineInterface

[localhost] local: gohan client ese_logical_port show --output-format json ef450536-01c9-4380-a34d-a1ae56e0447e
{
    "ese_logical_port": {
        "common_function_gateway_id": null,
        "connected_resource": "gw_interface",
        "description": "ESE Logical port for Port 33907bcb-8689-425d-a700-fe8acfd94aed",
        "ese_physical_port_id": "eec156b0-7317-48dd-b76c-019c0758e99d",
        "gw_interface_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
        "id": "ef450536-01c9-4380-a34d-a1ae56e0447e",
        "name": "xe-0/0/3.1025",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "port_ids": [
            "33907bcb-8689-425d-a700-fe8acfd94aed"
        ],
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "type": "L2",
        "vlan_id": 1025
    }
}

################################################
### checking heat-stack (ese_logical_ports) ####
################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ese_logical_ports/ef450536-01c9-4380-a34d-a1ae56e0447e
[localhost] local: heat stack-show ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                             |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                                |
| creation_time         | 2017-05-11T05:02:43Z                                                                                                                                              |
| description           | Logical port template                                                                                                                                             |
| disable_rollback      | True                                                                                                                                                              |
| id                    | eb817ba0-0eee-4ed1-b851-e4dcc2e639ed                                                                                                                              |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e/eb817ba0-0eee-4ed1-b851-e4dcc2e639ed (self) |
| notification_topics   | []                                                                                                                                                                |
| outputs               | [                                                                                                                                                                 |
|                       |   {                                                                                                                                                               |
|                       |     "output_value": "cccccccc-cccc-cccc-cccc-cccccccccccc",                                                                                                       |
|                       |     "description": "A unique id for the logical interface",                                                                                                       |
|                       |     "output_key": "id"                                                                                                                                            |
|                       |   },                                                                                                                                                              |
|                       |   {                                                                                                                                                               |
|                       |     "output_value": null,                                                                                                                                         |
|                       |     "output_error": "'ContrailLogicalInterface' object has no attribute 'li_uuid'",                                                                               |
|                       |     "description": "The name of the logical interface.",                                                                                                          |
|                       |     "output_key": "name"                                                                                                                                          |
|                       |   }                                                                                                                                                               |
|                       | ]                                                                                                                                                                 |
| parameters            | {                                                                                                                                                                 |
|                       |   "logical_port_type": "L2",                                                                                                                                      |
|                       |   "physical_port_id": "dddddddd-dddd-dddd-dddd-dddddddddddd",                                                                                                     |
|                       |   "OS::stack_id": "eb817ba0-0eee-4ed1-b851-e4dcc2e639ed",                                                                                                         |
|                       |   "OS::stack_name": "ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e",                                                                                      |
|                       |   "virtual_machine_interface_ids": "33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                        |
|                       |   "logical_port_name": "xe-0/0/3.1025",                                                                                                                           |
|                       |   "logical_port_vlan_id": "1025"                                                                                                                                  |
|                       | }                                                                                                                                                                 |
| parent                | None                                                                                                                                                              |
| stack_name            | ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e                                                                                                             |
| stack_owner           | admin                                                                                                                                                             |
| stack_status          | CREATE_COMPLETE                                                                                                                                                   |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                               |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                                  |
| template_description  | Logical port template                                                                                                                                             |
| timeout_mins          | 10                                                                                                                                                                |
| updated_time          | None                                                                                                                                                              |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e
description: 'Logical port template

  '
heat_template_version: '2013-05-23'
outputs:
  id:
    description: A unique id for the logical interface
    value: {get_resource: logical_interface}
  name:
    description: The name of the logical interface.
    value:
      get_attr: [logical_interface, name]
parameters:
  logical_port_name: {description: Name of the logical port., label: Logical Port
      Name, type: string}
  logical_port_type: {description: Type of the logical port., label: Logical Port
      Type, type: string}
  logical_port_vlan_id: {default: 0, description: VLAN id to use for logical port
      creation., label: VLAN id for Logical Port, type: number}
  physical_port_id: {description: A unique id for the Physical Interface., label: Physical
      Interface ID, type: string}
  virtual_machine_interface_ids: {description: Virtual Machine Interface ID., label: Virtual
      Machine Interface ID, type: comma_delimited_list}
resources:
  logical_interface:
    properties:
      name: {get_param: logical_port_name}
      physical_interface: {get_param: physical_port_id}
      type: {get_param: logical_port_type}
      virtual_machine_interfaces: {get_param: virtual_machine_interface_ids}
      vlan: {get_param: logical_port_vlan_id}
    type: OS::Contrail::LogicalInterface

[localhost] local: gohan client port show --output-format json 33907bcb-8689-425d-a700-fe8acfd94aed
{
    "port": {
        "admin_state_up": true,
        "allowed_address_pairs": [],
        "attached": true,
        "binding:vif_type": "vrouter",
        "description": "",
        "device_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
        "device_owner": "network:gw_interface",
        "ese_logical_port_id": "ef450536-01c9-4380-a34d-a1ae56e0447e",
        "fake_delete": false,
        "fixed_ips": [
            {
                "ip_address": "172.16.101.151",
                "subnet_id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf"
            },
            {
                "ip_address": "172.16.101.152",
                "subnet_id": "b4f0c956-2fe0-4634-b7c8-22bfd8095aaf"
            }
        ],
        "id": "33907bcb-8689-425d-a700-fe8acfd94aed",
        "mac_address": "fa:16:3e:ef:15:a2",
        "managed_by_service": true,
        "name": "Port for : eec156b0-7317-48dd-b76c-019c0758e99d",
        "network_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
        "segmentation_id": 1025,
        "segmentation_type": "vlan",
        "status": "ACTIVE",
        "tags": {},
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
    }
}

########################################################
### checking heat-stack (ports) for UPDATE_COMPLETE ####
########################################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/ports/33907bcb-8689-425d-a700-fe8acfd94aed
[localhost] local: heat stack-show port_33907bcb-8689-425d-a700-fe8acfd94aed
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                 |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                    |
| creation_time         | 2017-05-11T05:02:39Z                                                                                                                                  |
| description           | Virtual Machine Interface Template                                                                                                                    |
| disable_rollback      | True                                                                                                                                                  |
| id                    | 5bf72e78-0650-4f7f-a7c8-d668e838ac93                                                                                                                  |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/port_33907bcb-8689-425d-a700-fe8acfd94aed/5bf72e78-0650-4f7f-a7c8-d668e838ac93 (self) |
| notification_topics   | []                                                                                                                                                    |
| outputs               | [                                                                                                                                                     |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb",                                                                                           |
|                       |     "description": "Virtual network.",                                                                                                                |
|                       |     "output_key": "virtual_network"                                                                                                                   |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "default-domain:admin:33907bcb-8689-425d-a700-fe8acfd94aed",                                                                      |
|                       |     "description": "Fully Qualified Name of the VMI",                                                                                                 |
|                       |     "output_key": "fq_name"                                                                                                                           |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                           |
|                       |     "description": "A unique id for the virtual machine interface.",                                                                                  |
|                       |     "output_key": "id"                                                                                                                                |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "null",                                                                                                                           |
|                       |     "description": "Virtual machine allowed address pairs.",                                                                                          |
|                       |     "output_key": "allowed_address_pairs"                                                                                                             |
|                       |   },                                                                                                                                                  |
|                       |   {                                                                                                                                                   |
|                       |     "output_value": "xx:xx:xx:xx:xx:xx",                                                                                                              |
|                       |     "description": "Virtual machine interface mac address.",                                                                                          |
|                       |     "output_key": "mac_address"                                                                                                                       |
|                       |   }                                                                                                                                                   |
|                       | ]                                                                                                                                                     |
| parameters            | {                                                                                                                                                     |
|                       |   "virtual_machine": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",                                                                                          |
|                       |   "name": "33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                                     |
|                       |   "OS::stack_name": "port_33907bcb-8689-425d-a700-fe8acfd94aed",                                                                                      |
|                       |   "admin_state_up": "True",                                                                                                                           |
|                       |   "virtual_machine_interface_allowed_address_pairs": "null",                                                                                          |
|                       |   "virtual_machine_interface_mac_address": "fa:16:3e:ef:15:a2",                                                                                       |
|                       |   "OS::stack_id": "5bf72e78-0650-4f7f-a7c8-d668e838ac93",                                                                                             |
|                       |   "device_owner": "network:gw_interface",                                                                                                             |
|                       |   "virtual_network": "bb69041d-c654-4e9f-a763-afd4333275bc",                                                                                          |
|                       |   "uuid": "33907bcb-8689-425d-a700-fe8acfd94aed"                                                                                                      |
|                       | }                                                                                                                                                     |
| parent                | None                                                                                                                                                  |
| stack_name            | port_33907bcb-8689-425d-a700-fe8acfd94aed                                                                                                             |
| stack_owner           | admin                                                                                                                                                 |
| stack_status          | UPDATE_COMPLETE                                                                                                                                       |
| stack_status_reason   | Stack successfully updated                                                                                                                            |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                      |
| template_description  | Virtual Machine Interface Template                                                                                                                    |
| timeout_mins          | 10                                                                                                                                                    |
| updated_time          | 2017-05-11T05:02:47Z                                                                                                                                  |
+-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show port_33907bcb-8689-425d-a700-fe8acfd94aed
description: 'Virtual Machine Interface Template

  '
heat_template_version: '2013-05-23'
outputs:
  allowed_address_pairs:
    description: Virtual machine allowed address pairs.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_allowed_address_pairs]
  fq_name:
    description: Fully Qualified Name of the VMI
    value:
      get_attr: [virtual_machine_interface, fq_name]
  id:
    description: A unique id for the virtual machine interface.
    value: {get_resource: virtual_machine_interface}
  mac_address:
    description: Virtual machine interface mac address.
    value:
      get_attr: [virtual_machine_interface, virtual_machine_interface_mac_addresses]
  virtual_network:
    description: Virtual network.
    value:
      get_attr: [virtual_machine_interface, virtual_networks]
parameters:
  admin_state_up: {default: true, label: Admin state up, type: boolean}
  device_owner: {default: '', label: Device Owner, type: string}
  name: {description: A unique id for the Physical Interface., label: Physical Interface
      ID, type: string}
  uuid: {description: A unique id for the Virtual Machine Interface., label: Backend
      Virtual Machine Interface UUID, type: string}
  virtual_machine: {default: '', label: Virtual Machine., type: string}
  virtual_machine_interface_allowed_address_pairs: {label: Virtual machine interface
      allowed address pairs., type: json}
  virtual_machine_interface_mac_address: {default: 'fe:ff:ff:ff:ff:ff', label: Virtual
      machine interface mac address., type: string}
  virtual_network: {label: Virtual Network., type: string}
resources:
  instance_ip_0:
    properties:
      ip_address: 172.16.101.151
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.151
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  instance_ip_1:
    properties:
      ip_address: 172.16.101.152
      name:
        str_replace:
          params:
            '%ip%': 172.16.101.152
            '%name%': {get_param: name}
            '%zone%': b4f0c956-2fe0-4634-b7c8-22bfd8095aaf
          template: '%name%_%zone%_%ip%'
      network_id: {get_param: virtual_network}
      subnet_id: 8f9e2ede-c3b4-438e-888d-55e326ec29a9
      virtual_machine_interfaces:
      - {get_resource: virtual_machine_interface}
    type: OS::Contrail::InstanceIp
  virtual_machine_interface:
    properties:
      admin_state_up: {get_param: admin_state_up}
      device_owner: {get_param: device_owner}
      name: {get_param: name}
      uuid: {get_param: uuid}
      virtual_machine: {get_param: virtual_machine}
      virtual_machine_interface_allowed_address_pairs: {get_param: virtual_machine_interface_allowed_address_pairs}
      virtual_machine_interface_mac_addresses:
      - {get_param: virtual_machine_interface_mac_address}
      virtual_networks:
      - {get_param: virtual_network}
    type: OS::Contrail::VirtualMachineInterface

[localhost] local: gohan client resource_mapping list --output-format json
{
    "resource_mappings": [
        {
            "created": 1.494478959e+09,
            "deleted": null,
            "id": "050aa995-9d28-4108-b02b-6003c1de5880",
            "mapped_id": "10.79.5.185-ae0.1025",
            "relation": "vpn_primary",
            "resource_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
            "resource_type": "gw_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "1d5dcf8f-40f5-4780-8023-63bc1dd771ac",
            "mapped_id": "10.79.5.185-ge-0/0/1.122",
            "relation": "primary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478864e+09,
            "deleted": null,
            "id": "2f46f2b3-81f2-45d7-9f66-e64d131bb20b",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478965e+09,
            "deleted": null,
            "id": "35f2e482-0cc8-4371-aee5-0a0cf0ee276e",
            "mapped_id": "10.161.0.34-xe-0/0/4.1025",
            "relation": "baremetal",
            "resource_id": "67d9f139-b5be-4082-a090-3a1a9cbf1df8",
            "resource_type": "port",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478959e+09,
            "deleted": null,
            "id": "3cc6cb24-ad8d-481d-a3f6-c60c62071697",
            "mapped_id": "10.79.5.184-ae0.1025",
            "relation": "vpn_secondary",
            "resource_id": "fbd7d07e-9e84-4ad7-ab85-36d46adb9435",
            "resource_type": "gw_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478858e+09,
            "deleted": null,
            "id": "4f69c6a1-e11b-4fae-bd0b-babe7df48380",
            "mapped_id": "10.79.5.184-ge-0/0/1.122",
            "relation": "secondary",
            "resource_id": "0bea303d-b6eb-4edc-83ef-e32f915d3047",
            "resource_type": "vpn_interface",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478965e+09,
            "deleted": null,
            "id": "620b2247-8ba2-4e1b-86fe-4de6260608bc",
            "mapped_id": "10.161.0.34-xe-0/0/3.1025",
            "relation": "baremetal",
            "resource_id": "33907bcb-8689-425d-a700-fe8acfd94aed",
            "resource_type": "port",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478827e+09,
            "deleted": 1.494478858e+09,
            "id": "7806e79c-7403-462f-abd4-57d4f4f20f54",
            "mapped_id": "10.79.5.185-a3a62a37-5657-4822-98e0-991ab63f0e96",
            "relation": "instance",
            "resource_id": "4fab887d-8f73-40e6-b2d8-2426255231bf",
            "resource_type": "vpn_gateway",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        },
        {
            "created": 1.494478907e+09,
            "deleted": null,
            "id": "883c3271-8090-4515-abaa-56ef34692cd3",
            "mapped_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "relation": "instance",
            "resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "resource_type": "network",
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f"
        }
    ]
}

[localhost] local: gohan client billing_resource list --output-format json
{
    "billing_resources": [
        {
            "config_version": 1,
            "ended": null,
            "id": "0a8861ae-fab5-4a20-814d-6934bbb3e3d4",
            "info": {},
            "parent_billing_id": null,
            "resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc",
            "resource_type": "network",
            "started": 1.494478907e+09,
            "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
            "unique_resource_id": "bb69041d-c654-4e9f-a763-afd4333275bc"
        }
    ]
}

### Create Static Route ###
name:[sample-static-route], id:[1db45c0a-46cd-40af-a87e-718092df68b3]
--------------------------------------------------------------------------------
http_request     http_response    response_time   method   code   status
--------------------------------------------------------------------------------
05:03:35.088125  05:03:35.275461  0.187336        POST     201    PENDING_CREATE
05:03:35.275983  05:03:35.419535  0.143552         GET     200    PENDING_CREATE
05:03:36.420778  05:03:36.518258  0.097480         GET     200    PENDING_CREATE
05:03:37.519542  05:03:37.626389  0.106847         GET     200    PENDING_CREATE
05:03:38.627695  05:03:38.731400  0.103705         GET     200    PENDING_CREATE
05:03:39.732660  05:03:39.837840  0.105180         GET     200    PENDING_CREATE
05:03:40.839123  05:03:40.946304  0.107181         GET     200    PENDING_CREATE
05:03:41.947806  05:03:42.044003  0.096197         GET     200    PENDING_CREATE
05:03:43.045324  05:03:43.150030  0.104706         GET     200    PENDING_CREATE
05:03:44.151152  05:03:44.254310  0.103158         GET     200    PENDING_CREATE
05:03:45.255559  05:03:45.354913  0.099354         GET     200    PENDING_CREATE
05:03:46.356226  05:03:46.448067  0.091841         GET     200    PENDING_CREATE
05:03:47.448657  05:03:47.544864  0.096207         GET     200    PENDING_CREATE
05:03:48.546174  05:03:48.656296  0.110122         GET     200    PENDING_CREATE
05:03:49.657641  05:03:49.775078  0.117437         GET     200    PENDING_CREATE
05:03:50.776382  05:03:50.862101  0.085719         GET     200    PENDING_CREATE
05:03:51.863363  05:03:51.957029  0.093666         GET     200    PENDING_CREATE
05:03:52.958247  05:03:53.050761  0.092514         GET     200    PENDING_CREATE
05:03:54.052053  05:03:54.164389  0.112336         GET     200    ACTIVE
--------------------------------------------------------------------------------
Turn Around Time : 19.076264

[localhost] local: gohan client static_route show --output-format json 1db45c0a-46cd-40af-a87e-718092df68b3
{
    "static_route": {
        "aws_gw_id": null,
        "description": "Sample Static-route",
        "destination": "192.168.0.0/24",
        "id": "1db45c0a-46cd-40af-a87e-718092df68b3",
        "interdc_gw_id": null,
        "internet_gw_id": null,
        "name": "sample-static-route",
        "nexthop": "172.16.101.1",
        "public_ip_id": null,
        "service_type": "vpn",
        "status": "ACTIVE",
        "tenant_id": "0b576f6f4cbf414f829cd12f008bf08f",
        "vpn_gw_id": "4fab887d-8f73-40e6-b2d8-2426255231bf"
    }
}

############################################
### checking heat-stack (static_routes) ####
############################################
[localhost] local: etcdctl -o "json" --peers "http://etcd-server:2379" get /esi-worker/heat_stacks/v2.0/static_routes/1db45c0a-46cd-40af-a87e-718092df68b3
[localhost] local: heat stack-show static_route_1db45c0a-46cd-40af-a87e-718092df68b3
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Property              | Value                                                                                                                                                         |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+
| capabilities          | []                                                                                                                                                            |
| creation_time         | 2017-05-11T05:03:36Z                                                                                                                                          |
| description           | VPN Gateway Static Route                                                                                                                                      |
| disable_rollback      | True                                                                                                                                                          |
| id                    | f735c368-3ddc-418d-a964-9bb58d2f1bfc                                                                                                                          |
| links                 | http://heat-api:8004/v1/0b576f6f4cbf414f829cd12f008bf08f/stacks/static_route_1db45c0a-46cd-40af-a87e-718092df68b3/f735c368-3ddc-418d-a964-9bb58d2f1bfc (self) |
| notification_topics   | []                                                                                                                                                            |
| outputs               | []                                                                                                                                                            |
| parameters            | {                                                                                                                                                             |
|                       |   "primary_device_ip": "10.79.5.185",                                                                                                                         |
|                       |   "OS::stack_id": "f735c368-3ddc-418d-a964-9bb58d2f1bfc",                                                                                                     |
|                       |   "OS::stack_name": "static_route_1db45c0a-46cd-40af-a87e-718092df68b3",                                                                                      |
|                       |   "route": "192.168.0.0/24",                                                                                                                                  |
|                       |   "secondary_device_port": "830",                                                                                                                             |
|                       |   "secondary_device_password": "esiesi0000",                                                                                                                  |
|                       |   "primary_device_password": "esiesi0000",                                                                                                                    |
|                       |   "next_hop": "172.16.101.1",                                                                                                                                 |
|                       |   "vrf_name": "vrf_gw_sample-ha-router-downlink_1025",                                                                                                        |
|                       |   "primary_device_username": "esi",                                                                                                                           |
|                       |   "primary_device_port": "830",                                                                                                                               |
|                       |   "secondary_device_ip": "10.79.5.184",                                                                                                                       |
|                       |   "secondary_device_username": "esi"                                                                                                                          |
|                       | }                                                                                                                                                             |
| parent                | None                                                                                                                                                          |
| stack_name            | static_route_1db45c0a-46cd-40af-a87e-718092df68b3                                                                                                             |
| stack_owner           | admin                                                                                                                                                         |
| stack_status          | CREATE_COMPLETE                                                                                                                                               |
| stack_status_reason   | Stack CREATE completed successfully                                                                                                                           |
| stack_user_project_id | 0b576f6f4cbf414f829cd12f008bf08f                                                                                                                              |
| template_description  | VPN Gateway Static Route                                                                                                                                      |
| timeout_mins          | 60                                                                                                                                                            |
| updated_time          | None                                                                                                                                                          |
+-----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------+

[localhost] local: heat template-show static_route_1db45c0a-46cd-40af-a87e-718092df68b3
description: 'VPN Gateway Static Route

  '
heat_template_version: '2013-05-23'
parameters:
  next_hop: {description: Next hop for the static route, label: Next hop, type: string}
  primary_device_ip: {description: Ip address that will be used to establish ssh connection
      to the Primary Device., label: Ip address of the device., type: string}
  primary_device_password: {description: Password of the user which will be used to
      log onto the Primary Device., label: Users password., type: string}
  primary_device_port: {description: Port that will be used to establish ssh connection
      to the Primary Device., label: Port of the ssh connection., type: number}
  primary_device_username: {description: Name of the user which will be used to log
      onto the Primary Device., label: User name to log on to device., type: string}
  route: {description: Static Route definition, label: Route, type: string}
  secondary_device_ip: {description: Ip address that will be used to establish ssh
      connection to the Secondary Device., label: Ip address of the device., type: string}
  secondary_device_password: {description: Password of the user which will be used
      to log onto the Secondary Device., label: Users password., type: string}
  secondary_device_port: {description: Port that will be used to establish ssh connection
      to the Secondary Device., label: Port of the ssh connection., type: number}
  secondary_device_username: {description: Name of the user which will be used to
      log onto the Secondary Device., label: User name to log on to device., type: string}
  vrf_name: {description: Name of VRF to add this static route, label: VRF, type: string}
resources:
  netconf_configure_primary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $NEXT_HOP: {get_param: next_hop}
            template: 'next-hop $NEXT_HOP;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: routing-options, xml_type: tag}
        - {config_type: tag, tag: static, xml_type: tag}
        - config_type: named_tag
          name: {get_param: route}
          tag: route
          xml_type: named_tag
      device_ip: {get_param: primary_device_ip}
      lock_timeout: 3000
      password: {get_param: primary_device_password}
      port: {get_param: primary_device_port}
      username: {get_param: primary_device_username}
    type: OS::Contrail::NetconfNamedConfigs
  netconf_configure_secondary:
    properties:
      configs:
      - config:
          str_replace:
            params:
              $NEXT_HOP: {get_param: next_hop}
            template: 'next-hop $NEXT_HOP;

              '
        path:
        - {config_type: tag, tag: routing-instances, xml_type: tag}
        - config_type: name
          name: {get_param: vrf_name}
          tag: instance
          xml_type: named_tag
        - {config_type: tag, tag: routing-options, xml_type: tag}
        - {config_type: tag, tag: static, xml_type: tag}
        - config_type: named_tag
          name: {get_param: route}
          tag: route
          xml_type: named_tag
      device_ip: {get_param: secondary_device_ip}
      lock_timeout: 3000
      password: {get_param: secondary_device_password}
      port: {get_param: secondary_device_port}
      username: {get_param: secondary_device_username}
    type: OS::Contrail::NetconfNamedConfigs

root@client:/tools/rest-api-for-esi#      
root@client:/tools/rest-api-for-esi# heat stack-list
+--------------------------------------+--------------------------------------------------------+-----------------+----------------------+
| id                                   | stack_name                                             | stack_status    | creation_time        |
+--------------------------------------+--------------------------------------------------------+-----------------+----------------------+
| 7bfcd176-a55d-4456-8883-4bccfcda5af4 | ese_device_5314fffc-6c86-4410-a64b-5386286ac629        | CREATE_COMPLETE | 2017-05-11T04:59:20Z |
| 4443a1c7-2cb6-424e-ae08-d952b092ef2b | ese_physical_port_eec156b0-7317-48dd-b76c-019c0758e99d | CREATE_COMPLETE | 2017-05-11T04:59:26Z |
| 724e3e47-e401-4f3d-9fe1-a6f174c34e5d | ese_physical_port_176ec475-e9e8-4605-8b41-802fbc6220c1 | CREATE_COMPLETE | 2017-05-11T04:59:32Z |
| 8b8fd087-b322-41fb-8751-63042be0c8f7 | vpn_gateway_4fab887d-8f73-40e6-b2d8-2426255231bf       | UPDATE_COMPLETE | 2017-05-11T05:00:10Z |
| 8d6c9985-ee1d-4fe5-9b4f-963a5758a76a | vpn_interface_0bea303d-b6eb-4edc-83ef-e32f915d3047     | CREATE_COMPLETE | 2017-05-11T05:00:42Z |
| f73bedd0-b5d5-4abb-ac41-0804910e848c | network_bb69041d-c654-4e9f-a763-afd4333275bc           | CREATE_COMPLETE | 2017-05-11T05:01:45Z |
| ae4327f2-0f4c-460e-a370-2965a731cf8d | subnet_b4f0c956-2fe0-4634-b7c8-22bfd8095aaf            | CREATE_COMPLETE | 2017-05-11T05:02:03Z |
| 6241b027-f0f1-418b-aa7a-ef6199be695b | gw_interface_fbd7d07e-9e84-4ad7-ab85-36d46adb9435      | CREATE_COMPLETE | 2017-05-11T05:02:21Z |
| 1bb1200e-ba86-4e1a-97fb-80cb2408e713 | port_67d9f139-b5be-4082-a090-3a1a9cbf1df8              | UPDATE_COMPLETE | 2017-05-11T05:02:39Z |
| 5bf72e78-0650-4f7f-a7c8-d668e838ac93 | port_33907bcb-8689-425d-a700-fe8acfd94aed              | UPDATE_COMPLETE | 2017-05-11T05:02:39Z |
| 356486d9-72dd-4d6e-80c8-e252926c957d | ese_logical_port_ecb4c4ac-3ebc-4045-a27c-52fecc93bac5  | CREATE_COMPLETE | 2017-05-11T05:02:43Z |
| eb817ba0-0eee-4ed1-b851-e4dcc2e639ed | ese_logical_port_ef450536-01c9-4380-a34d-a1ae56e0447e  | CREATE_COMPLETE | 2017-05-11T05:02:43Z |
| f735c368-3ddc-418d-a964-9bb58d2f1bfc | static_route_1db45c0a-46cd-40af-a87e-718092df68b3      | CREATE_COMPLETE | 2017-05-11T05:03:36Z |
+--------------------------------------+--------------------------------------------------------+-----------------+----------------------+
